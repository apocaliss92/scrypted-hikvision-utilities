/*! For license information please see main.nodejs.js.LICENSE.txt */
(()=>{var t={2(t,e,i){var r=i(2199),n=i(4664),o=i(5950);t.exports=function(t){return r(t,o,n)}},79(t,e,i){var r=i(3702),n=i(80),o=i(4739),s=i(8655),a=i(1175);function u(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=n,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,t.exports=u},80(t,e,i){var r=i(6025),n=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=r(e,t);return!(i<0)&&(i==e.length-1?e.pop():n.call(e,i,1),--this.size,!0)}},104(t,e,i){var r=i(3661);function n(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var i=function(){var r=arguments,n=e?e.apply(this,r):r[0],o=i.cache;if(o.has(n))return o.get(n);var s=t.apply(this,r);return i.cache=o.set(n,s)||o,s};return i.cache=new(n.Cache||r),i}n.Cache=r,t.exports=n},270(t,e,i){var r=i(7068),n=i(346);t.exports=function t(e,i,o,s,a){return e===i||(null==e||null==i||!n(e)&&!n(i)?e!=e&&i!=i:r(e,i,o,s,t,a))}},289(t,e,i){var r=i(2651);t.exports=function(t){return r(this,t).get(t)}},294(t){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},317(t){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach((function(t,r){i[++e]=[r,t]})),i}},346(t){t.exports=function(t){return null!=t&&"object"==typeof t}},361(t){var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,i){var r=typeof t;return!!(i=null==i?9007199254740991:i)&&("number"==r||"symbol"!=r&&e.test(t))&&t>-1&&t%1==0&&t<i}},382(t,e,i){(function(){var e,r={}.hasOwnProperty;e=i(6286),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t)}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.prototype.document=function(t,e){var i,r,n,o,s;for(e=this.filterOptions(e),o="",r=0,n=(s=t.children).length;r<n;r++)i=s[r],o+=this.writeChildNode(i,e,0);return e.pretty&&o.slice(-e.newline.length)===e.newline&&(o=o.slice(0,-e.newline.length)),o},e}(e)}).call(this)},392(t){t.exports=function(t,e){return null==t?void 0:t[e]}},400(t,e,i){(function(){var e,r,n,o,s,a,u,p,c,l,h,d,m,g,f,y,v,b,S,T,w,C,O,x={}.hasOwnProperty;O=i(9241),w=O.isObject,T=O.isFunction,C=O.isPlainObject,S=O.getValue,e=i(1737),d=i(1933),m=i(3906),o=i(2691),s=i(2679),f=i(1268),b=i(2535),g=i(5915),l=i(4130),h=i(6376),a=i(4111),p=i(5529),u=i(7696),c=i(8012),n=i(4238),v=i(3976),y=i(382),r=i(8753),t.exports=function(){function t(t,i,r){var n;this.name="?xml",this.type=e.Document,t||(t={}),n={},t.writer?C(t.writer)&&(n=t.writer,t.writer=new y):t.writer=new y,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(n),this.stringify=new v(t),this.onDataCallback=i||function(){},this.onEndCallback=r||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return t.prototype.createChildNode=function(t){var i,r,n,o,s,a,u,p;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(r in n={},u=t.attribs)x.call(u,r)&&(i=u[r],n[r]=i.value);this.node(t.name,n);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(s=0,a=(p=t.children).length;s<a;s++)o=p[s],this.createChildNode(o),o.type===e.Element&&this.up();return this},t.prototype.dummy=function(){return this},t.prototype.node=function(t,e,i){var r;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=S(t),null==e&&(e={}),e=S(e),w(e)||(i=(r=[e,i])[0],e=r[1]),this.currentNode=new m(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=i&&this.text(i),this},t.prototype.element=function(t,i,r){var n,o,s,a,u,p;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(t)||w(t)||T(t))for(a=this.options.noValidation,this.options.noValidation=!0,(p=new d(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=a,o=0,s=(u=p.children).length;o<s;o++)n=u[o],this.createChildNode(n),n.type===e.Element&&this.up();else this.node(t,i,r);return this},t.prototype.attribute=function(t,e){var i,r;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=S(t)),w(t))for(i in t)x.call(t,i)&&(r=t[i],this.attribute(i,r));else T(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new n(this,t,""):null!=e&&(this.currentNode.attribs[t]=new n(this,t,e));return this},t.prototype.text=function(t){var e;return this.openCurrent(),e=new b(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.cdata=function(t){var e;return this.openCurrent(),e=new o(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.comment=function(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.raw=function(t){var e;return this.openCurrent(),e=new f(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.instruction=function(t,e){var i,r,n,o,s;if(this.openCurrent(),null!=t&&(t=S(t)),null!=e&&(e=S(e)),Array.isArray(t))for(i=0,o=t.length;i<o;i++)r=t[i],this.instruction(r);else if(w(t))for(r in t)x.call(t,r)&&(n=t[r],this.instruction(r,n));else T(e)&&(e=e.apply()),s=new g(this,t,e),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},t.prototype.declaration=function(t,e,i){var r;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return r=new l(this,t,e,i),this.onData(this.writer.declaration(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.doctype=function(t,e,i){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new h(this,e,i),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},t.prototype.dtdElement=function(t,e){var i;return this.openCurrent(),i=new u(this,t,e),this.onData(this.writer.dtdElement(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.attList=function(t,e,i,r,n){var o;return this.openCurrent(),o=new a(this,t,e,i,r,n),this.onData(this.writer.dtdAttList(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.entity=function(t,e){var i;return this.openCurrent(),i=new p(this,!1,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.pEntity=function(t,e){var i;return this.openCurrent(),i=new p(this,!0,t,e),this.onData(this.writer.dtdEntity(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.notation=function(t,e){var i;return this.openCurrent(),i=new c(this,t,e),this.onData(this.writer.dtdNotation(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},t.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},t.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},t.prototype.openNode=function(t){var i,n,o,s;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),n="",t.type===e.Element){for(o in this.writerOptions.state=r.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,s=t.attribs)x.call(s,o)&&(i=s[o],n+=this.writer.attribute(i,this.writerOptions,this.currentLevel));n+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.InsideTag}else this.writerOptions.state=r.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.children?(n+=" [",this.writerOptions.state=r.InsideTag):(this.writerOptions.state=r.CloseTag,n+=">"),n+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(n,this.currentLevel),t.isOpen=!0}},t.prototype.closeNode=function(t){var i;if(!t.isClosed)return i="",this.writerOptions.state=r.CloseTag,i=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.None,this.onData(i,this.currentLevel),t.isClosed=!0},t.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},t.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},t.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},t.prototype.ele=function(){return this.element.apply(this,arguments)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.dtd=function(t,e,i){return this.doctype(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.att=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.a=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.ent=function(t,e){return this.entity(t,e)},t.prototype.pent=function(t,e){return this.pEntity(t,e)},t.prototype.not=function(t,e){return this.notation(t,e)},t}()}).call(this)},468(t,e,i){(function(){var e,r,n,o,s,a,u,p,c,l,h,d,m,g,f,y,v,b={}.hasOwnProperty;v=i(9241),y=v.isObject,f=v.isFunction,g=v.isEmpty,m=v.getValue,p=null,n=null,o=null,s=null,a=null,h=null,d=null,l=null,u=null,r=null,c=null,e=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,p||(p=i(3906),n=i(2691),o=i(2679),s=i(4130),a=i(6376),h=i(1268),d=i(2535),l=i(5915),u=i(1218),r=i(1737),c=i(6684),i(4797),e=i(4923))}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new c(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,i,n,o;if(this.nodeType===r.Element||this.nodeType===r.DocumentFragment){for(o="",e=0,i=(n=this.children).length;e<i;e++)(t=n[e]).textContent&&(o+=t.textContent);return o}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t.prototype.setParent=function(t){var e,i,r,n,o;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),o=[],i=0,r=(n=this.children).length;i<r;i++)e=n[i],o.push(e.setParent(this));return o},t.prototype.element=function(t,e,i){var r,n,o,s,a,u,p,c,l,h,d;if(u=null,null===e&&null==i&&(e=(l=[{},null])[0],i=l[1]),null==e&&(e={}),e=m(e),y(e)||(i=(h=[e,i])[0],e=h[1]),null!=t&&(t=m(t)),Array.isArray(t))for(o=0,p=t.length;o<p;o++)n=t[o],u=this.element(n);else if(f(t))u=this.element(t.apply());else if(y(t)){for(a in t)if(b.call(t,a))if(d=t[a],f(d)&&(d=d.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))u=this.attribute(a.substr(this.stringify.convertAttKey.length),d);else if(!this.options.separateArrayItems&&Array.isArray(d)&&g(d))u=this.dummy();else if(y(d)&&g(d))u=this.element(a);else if(this.options.keepNullNodes||null!=d)if(!this.options.separateArrayItems&&Array.isArray(d))for(s=0,c=d.length;s<c;s++)n=d[s],(r={})[a]=n,u=this.element(r);else y(d)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?u=this.element(d):(u=this.element(a)).element(d):u=this.element(a,d);else u=this.dummy()}else u=this.options.keepNullNodes||null!==i?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(i):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(i):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(i):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(i):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),i):this.node(t,e,i):this.dummy();if(null==u)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return u},t.prototype.insertBefore=function(t,e,i){var r,n,o,s,a;if(null!=t?t.type:void 0)return s=e,(o=t).setParent(this),s?(n=children.indexOf(s),a=children.splice(n),children.push(o),Array.prototype.push.apply(children,a)):children.push(o),o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),a=this.parent.children.splice(n),r=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,a),r},t.prototype.insertAfter=function(t,e,i){var r,n,o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),o=this.parent.children.splice(n+1),r=this.parent.element(t,e,i),Array.prototype.push.apply(this.parent.children,o),r},t.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},t.prototype.node=function(t,e,i){var r,n;return null!=t&&(t=m(t)),e||(e={}),e=m(e),y(e)||(i=(n=[e,i])[0],e=n[1]),r=new p(this,t,e),null!=i&&r.text(i),this.children.push(r),r},t.prototype.text=function(t){var e;return y(t)&&this.element(t),e=new d(this,t),this.children.push(e),this},t.prototype.cdata=function(t){var e;return e=new n(this,t),this.children.push(e),this},t.prototype.comment=function(t){var e;return e=new o(this,t),this.children.push(e),this},t.prototype.commentBefore=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.commentAfter=function(t){var e,i;return e=this.parent.children.indexOf(this),i=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.raw=function(t){var e;return e=new h(this,t),this.children.push(e),this},t.prototype.dummy=function(){return new u(this)},t.prototype.instruction=function(t,e){var i,r,n,o,s;if(null!=t&&(t=m(t)),null!=e&&(e=m(e)),Array.isArray(t))for(o=0,s=t.length;o<s;o++)i=t[o],this.instruction(i);else if(y(t))for(i in t)b.call(t,i)&&(r=t[i],this.instruction(i,r));else f(e)&&(e=e.apply()),n=new l(this,t,e),this.children.push(n);return this},t.prototype.instructionBefore=function(t,e){var i,r;return i=this.parent.children.indexOf(this),r=this.parent.children.splice(i),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.instructionAfter=function(t,e){var i,r;return i=this.parent.children.indexOf(this),r=this.parent.children.splice(i+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.declaration=function(t,e,i){var n,o;return n=this.document(),o=new s(n,t,e,i),0===n.children.length?n.children.unshift(o):n.children[0].type===r.Declaration?n.children[0]=o:n.children.unshift(o),n.root()||n},t.prototype.dtd=function(t,e){var i,n,o,s,u,p,c,l,h;for(i=this.document(),n=new a(i,t,e),o=s=0,p=(l=i.children).length;s<p;o=++s)if(l[o].type===r.DocType)return i.children[o]=n,n;for(o=u=0,c=(h=i.children).length;u<c;o=++u)if(h[o].isRoot)return i.children.splice(o,0,n),n;return i.children.push(n),n},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var t;for(t=this;t;){if(t.type===r.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},t.prototype.document=function(){var t;for(t=this;t;){if(t.type===r.Document)return t;t=t.parent}},t.prototype.end=function(t){return this.document().end(t)},t.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},t.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},t.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},t.prototype.debugInfo=function(t){var e,i;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(i=this.parent)?i.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},t.prototype.ele=function(t,e,i){return this.element(t,e,i)},t.prototype.nod=function(t,e,i){return this.node(t,e,i)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(t,e,i){return this.declaration(t,e,i)},t.prototype.e=function(t,e,i){return this.element(t,e,i)},t.prototype.n=function(t,e,i){return this.node(t,e,i)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(t){return this.importDocument(t)},t.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.hasChildNodes=function(){return 0!==this.children.length},t.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isSupported=function(t,e){return!0},t.prototype.hasAttributes=function(){return 0!==this.attribs.length},t.prototype.compareDocumentPosition=function(t){var i,r;return(i=this)===t?0:this.document()!==t.document()?(r=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?r|=e.Preceding:r|=e.Following,r):i.isAncestor(t)?e.Contains|e.Preceding:i.isDescendant(t)?e.Contains|e.Following:i.isPreceding(t)?e.Preceding:e.Following},t.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(t){var e,i,r;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=i=0,r=this.children.length-1;0<=r?i<=r:i>=r;e=0<=r?++i:--i)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.setUserData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},t.prototype.isDescendant=function(t){var e,i,r,n;for(i=0,r=(n=this.children).length;i<r;i++){if(t===(e=n[i]))return!0;if(e.isDescendant(t))return!0}return!1},t.prototype.isAncestor=function(t){return t.isDescendant(this)},t.prototype.isPreceding=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e<i},t.prototype.isFollowing=function(t){var e,i;return e=this.treePosition(t),i=this.treePosition(this),-1!==e&&-1!==i&&e>i},t.prototype.treePosition=function(t){var e,i;return i=0,e=!1,this.foreachTreeNode(this.document(),(function(r){if(i++,!e&&r===t)return e=!0})),e?i:-1},t.prototype.foreachTreeNode=function(t,e){var i,r,n,o,s;for(t||(t=this.document()),r=0,n=(o=t.children).length;r<n;r++){if(s=e(i=o[r]))return s;if(s=this.foreachTreeNode(i,e))return s}},t}()}).call(this)},583(t,e,i){var r=i(7237),n=i(7255),o=i(8586),s=i(7797);t.exports=function(t){return o(t)?r(s(t)):n(t)}},631(t,e,i){var r=i(8077),n=i(9326);t.exports=function(t,e){return null!=t&&n(t,e,r)}},641(t,e,i){var r=i(6649),n=i(5950);t.exports=function(t,e){return t&&r(t,e,n)}},659(t,e,i){var r=i(1873),n=Object.prototype,o=n.hasOwnProperty,s=n.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,a),i=t[a];try{t[a]=void 0;var r=!0}catch(t){}var n=s.call(t);return r&&(e?t[a]=i:delete t[a]),n}},689(t,e,i){var r=i(2),n=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,o,s,a){var u=1&i,p=r(t),c=p.length;if(c!=r(e).length&&!u)return!1;for(var l=c;l--;){var h=p[l];if(!(u?h in e:n.call(e,h)))return!1}var d=a.get(t),m=a.get(e);if(d&&m)return d==e&&m==t;var g=!0;a.set(t,e),a.set(e,t);for(var f=u;++l<c;){var y=t[h=p[l]],v=e[h];if(o)var b=u?o(v,y,h,e,t,a):o(y,v,h,t,e,a);if(!(void 0===b?y===v||s(y,v,i,o,a):b)){g=!1;break}f||(f="constructor"==h)}if(g&&!f){var S=t.constructor,T=e.constructor;S==T||!("constructor"in t)||!("constructor"in e)||"function"==typeof S&&S instanceof S&&"function"==typeof T&&T instanceof T||(g=!1)}return a.delete(t),a.delete(e),g}},695(t,e,i){var r=i(8096),n=i(2428),o=i(6449),s=i(3656),a=i(361),u=i(7167),p=Object.prototype.hasOwnProperty;t.exports=function(t,e){var i=o(t),c=!i&&n(t),l=!i&&!c&&s(t),h=!i&&!c&&!l&&u(t),d=i||c||l||h,m=d?r(t.length,String):[],g=m.length;for(var f in t)!e&&!p.call(t,f)||d&&("length"==f||l&&("offset"==f||"parent"==f)||h&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||a(f,g))||m.push(f);return m}},756(t,e,i){var r=i(3805);t.exports=function(t){return t==t&&!r(t)}},776(t,e,i){var r=i(756),n=i(5950);t.exports=function(t){for(var e=n(t),i=e.length;i--;){var o=e[i],s=t[o];e[i]=[o,s,r(s)]}return e}},841(t,e,i){"use strict";i.d(e,{BASIC:()=>m,DIGEST:()=>C,buildAuthorizationHeader:()=>E,parseWWWAuthenticateHeader:()=>P});const r=require("os");class n extends Error{code;params;wrappedErrors;constructor(t,e,...i){t instanceof Array||(i=("undefined"==typeof e?[]:[e]).concat(i),e=t,t=[]),super(e),this.code=e||"E_UNEXPECTED",this.params=i,this.wrappedErrors=t,this.name=this.toString(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}static wrap(t,e,...i){const r=s(t.message),o=("wrappedErrors"in t?t.wrappedErrors:[]).concat(t);return e||(e=r?t.message:"E_UNEXPECTED"),t.message&&!r&&i.push(t.message),new n(o,e,...i)}static cast(t,e,...i){return o(t)?t:n.wrap(t,e,...i)}static bump(t,e,...i){return o(t)?n.wrap(t,t.code,...t.params):n.wrap(t,e,...i)}toString(){return(this.wrappedErrors.length?this.wrappedErrors[this.wrappedErrors.length-1].stack+r.EOL:"")+this.constructor.name+": "+this.code+" ("+this.params.join(", ")+")"}}function o(t){return!!(t instanceof n)||!!(t.constructor&&t.constructor.name&&t.constructor.name.endsWith("Error")&&"code"in t&&"string"==typeof t.code&&s(t.code)&&"params"in t&&t.params&&t.params instanceof Array)}function s(t){return/^([A-Z0-9_]+)$/.test(t)}const a=/\w+=(".*?"|[^",]+)(?=,|$)/g;function u(t,e,i=[],r=[]){const o=t.trim().match(a);if(!o)throw new n("E_MALFORMED_QUOTEDKEYVALUE",t);const s=o.map(((t,e)=>{const[i,...r]=t.split("="),o=r.join("=");if(0===r.length)throw new n("E_MALFORMED_QUOTEDKEYVALUE",e,t);return[i,o]})).reduce((function(t,[i,o],s){const a=i.toLowerCase();if(-1===e.indexOf(a))throw new n("E_UNAUTHORIZED_KEY",s,a);const u=o.replace(/^"(.+(?="$))"$/,"$1");return t[a]=r.includes(a)?u.toLowerCase():u,t}),{});return c(i,s),s}function p(t,e,i=[]){return c(i,t),e.reduce((function(e,i){return t[i]?e+(e?", ":"")+i+'="'+t[i]+'"':e}),"")}function c(t,e){t.forEach((t=>{if("undefined"==typeof e[t])throw new n("E_REQUIRED_KEY",t)}))}const l=["realm"],h=l,d={type:"Basic",parseWWWAuthenticateRest:function(t){return u(t,h,l)},buildWWWAuthenticateRest:function(t){return p(t,h,l)},parseAuthorizationRest:function(t){if(!t)throw new n("E_EMPTY_AUTH");const{username:e,password:i}=d.decodeHash(t);return{hash:t,username:e,password:i}},buildAuthorizationRest:function({hash:t,username:e,password:i}){if(e&&i)return d.computeHash({username:e,password:i});if(!t)throw new n("E_NO_HASH");return t},computeHash:function({username:t,password:e}){return Buffer.from(t+":"+e).toString("base64")},decodeHash:function(t){const[e,...i]=Buffer.from(t,"base64").toString().split(":");return{username:e,password:i.join(":")}}},m=d,g=require("crypto"),f=["realm","nonce"],y=[...f,"domain","opaque","stale","algorithm","qop"],v=["stale"],b=["username","realm","nonce","uri","response"],S=[...b,"algorithm","cnonce","opaque","qop","nc"],T={type:"Digest",parseWWWAuthenticateRest:function(t){return u(t,y,f,v)},buildWWWAuthenticateRest:function(t){return p(t,y,f)},parseAuthorizationRest:function(t){return u(t,S,b)},buildAuthorizationRest:function(t){return p(t,S,b)},computeHash:function(t){const e=t.ha1||w(t.algorithm,[t.username,t.realm,t.password].join(":")),i=w(t.algorithm,[t.method,t.uri].join(":"));return w(t.algorithm,[e,t.nonce,t.nc,t.cnonce,t.qop,i].join(":"))}};function w(t,e){const i=g.createHash(t);return i.update(e),i.digest("hex")}const C=T,O=["invalid_request","invalid_token","insufficient_scope"],x=["realm","scope","error","error_description"],I={type:"Bearer",parseWWWAuthenticateRest:function(t){return u(t,x,[])},buildWWWAuthenticateRest:function(t){if(t.error&&-1===O.indexOf(t.error))throw new n("E_INVALID_ERROR",t.error,O);return p(t,x,[])},parseAuthorizationRest:function(t){if(!t)throw new n("E_EMPTY_AUTH");return{hash:t}},buildAuthorizationRest:function({hash:t}){if(!t)throw new n("E_NO_HASH");return t}},D=[m,T,I];function P(t,e=D,{strict:i=!0}={strict:!0}){let r=null;if(e.some((e=>(0===t.indexOf(e.type+" ")||!i&&0===t.indexOf(e.type.toLowerCase()+" "))&&(r={type:e.type,data:e.parseWWWAuthenticateRest(t.substr(e.type.length+1))},!0))),!r)throw new n("E_UNKNOWN_AUTH_MECHANISM",t);return r}function E(t,e){return`${t.type} ${t.buildAuthorizationRest(e)}`}},909(t,e,i){var r=i(641),n=i(8329)(r);t.exports=n},938(t){t.exports=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}},945(t,e,i){var r=i(79),n=i(8223),o=i(3661);t.exports=function(t,e){var i=this.__data__;if(i instanceof r){var s=i.__data__;if(!n||s.length<199)return s.push([t,e]),this.size=++i.size,this;i=this.__data__=new o(s)}return i.set(t,e),this.size=i.size,this}},1042(t,e,i){var r=i(6110)(Object,"create");t.exports=r},1175(t,e,i){var r=i(6025);t.exports=function(t,e){var i=this.__data__,n=r(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this}},1218(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(468),e=i(1737),t.exports=function(t){function i(t){i.__super__.constructor.call(this,t),this.type=e.Dummy}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return""},i}(r)}).call(this)},1268(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(1737),r=i(468),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},1380(t){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},1420(t,e,i){var r=i(79);t.exports=function(){this.__data__=new r,this.size=0}},1459(t){t.exports=function(t){return this.__data__.has(t)}},1549(t,e,i){var r=i(2032),n=i(3862),o=i(6721),s=i(2749),a=i(5749);function u(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=n,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,t.exports=u},1737(t){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},1769(t,e,i){var r=i(6449),n=i(8586),o=i(1802),s=i(3222);t.exports=function(t,e){return r(t)?t:n(t,e)?[t]:o(s(t))}},1783(t,e,i){var r,n,o,s=i(7016),a=s.URL,u=i(8611),p=i(5692),c=i(2203).Writable,l=i(2613),h=i(4376);r="undefined"!=typeof process,n="undefined"!=typeof window&&"undefined"!=typeof document,o=L(Error.captureStackTrace),r||!n&&o||console.warn("The follow-redirects package should be excluded from browser builds.");var d=!1;try{l(new a(""))}catch(t){d="ERR_INVALID_URL"===t.code}var m=["auth","host","hostname","href","path","pathname","port","protocol","query","search","hash"],g=["abort","aborted","connect","error","socket","timeout"],f=Object.create(null);g.forEach((function(t){f[t]=function(e,i,r){this._redirectable.emit(t,e,i,r)}}));var y=_("ERR_INVALID_URL","Invalid URL",TypeError),v=_("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),b=_("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded",v),S=_("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),T=_("ERR_STREAM_WRITE_AFTER_END","write after end"),w=c.prototype.destroy||x;function C(t,e){c.call(this),this._sanitizeOptions(t),this._options=t,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],e&&this.on("response",e);var i=this;this._onNativeResponse=function(t){try{i._processResponse(t)}catch(t){i.emit("error",t instanceof v?t:new v({cause:t}))}},this._performRequest()}function O(t){var e={maxRedirects:21,maxBodyLength:10485760},i={};return Object.keys(t).forEach((function(r){var n=r+":",o=i[n]=t[r],s=e[r]=Object.create(o);Object.defineProperties(s,{request:{value:function(t,r,o){var s;return s=t,a&&s instanceof a?t=P(t):N(t)?t=P(I(t)):(o=r,r=D(t),t={protocol:n}),L(r)&&(o=r,r=null),(r=Object.assign({maxRedirects:e.maxRedirects,maxBodyLength:e.maxBodyLength},t,r)).nativeProtocols=i,N(r.host)||N(r.hostname)||(r.hostname="::1"),l.equal(r.protocol,n,"protocol mismatch"),h("options",r),new C(r,o)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(t,e,i){var r=s.request(t,e,i);return r.end(),r},configurable:!0,enumerable:!0,writable:!0}})})),e}function x(){}function I(t){var e;if(d)e=new a(t);else if(!N((e=D(s.parse(t))).protocol))throw new y({input:t});return e}function D(t){if(/^\[/.test(t.hostname)&&!/^\[[:0-9a-f]+\]$/i.test(t.hostname))throw new y({input:t.href||t});if(/^\[/.test(t.host)&&!/^\[[:0-9a-f]+\](:\d+)?$/i.test(t.host))throw new y({input:t.href||t});return t}function P(t,e){var i=e||{};for(var r of m)i[r]=t[r];return i.hostname.startsWith("[")&&(i.hostname=i.hostname.slice(1,-1)),""!==i.port&&(i.port=Number(i.port)),i.path=i.search?i.pathname+i.search:i.pathname,i}function E(t,e){var i;for(var r in e)t.test(r)&&(i=e[r],delete e[r]);return null===i||"undefined"==typeof i?void 0:String(i).trim()}function _(t,e,i){function r(i){L(Error.captureStackTrace)&&Error.captureStackTrace(this,this.constructor),Object.assign(this,i||{}),this.code=t,this.message=this.cause?e+": "+this.cause.message:e}return r.prototype=new(i||Error),Object.defineProperties(r.prototype,{constructor:{value:r,enumerable:!1},name:{value:"Error ["+t+"]",enumerable:!1}}),r}function A(t,e){for(var i of g)t.removeListener(i,f[i]);t.on("error",x),t.destroy(e)}function N(t){return"string"==typeof t||t instanceof String}function L(t){return"function"==typeof t}C.prototype=Object.create(c.prototype),C.prototype.abort=function(){A(this._currentRequest),this._currentRequest.abort(),this.emit("abort")},C.prototype.destroy=function(t){return A(this._currentRequest,t),w.call(this,t),this},C.prototype.write=function(t,e,i){if(this._ending)throw new T;if(!N(t)&&("object"!=typeof(r=t)||!("length"in r)))throw new TypeError("data should be a string, Buffer or Uint8Array");var r;L(e)&&(i=e,e=null),0!==t.length?this._requestBodyLength+t.length<=this._options.maxBodyLength?(this._requestBodyLength+=t.length,this._requestBodyBuffers.push({data:t,encoding:e}),this._currentRequest.write(t,e,i)):(this.emit("error",new S),this.abort()):i&&i()},C.prototype.end=function(t,e,i){if(L(t)?(i=t,t=e=null):L(e)&&(i=e,e=null),t){var r=this,n=this._currentRequest;this.write(t,e,(function(){r._ended=!0,n.end(null,null,i)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,i)},C.prototype.setHeader=function(t,e){this._options.headers[t]=e,this._currentRequest.setHeader(t,e)},C.prototype.removeHeader=function(t){delete this._options.headers[t],this._currentRequest.removeHeader(t)},C.prototype.setTimeout=function(t,e){var i=this;function r(e){e.setTimeout(t),e.removeListener("timeout",e.destroy),e.addListener("timeout",e.destroy)}function n(e){i._timeout&&clearTimeout(i._timeout),i._timeout=setTimeout((function(){i.emit("timeout"),o()}),t),r(e)}function o(){i._timeout&&(clearTimeout(i._timeout),i._timeout=null),i.removeListener("abort",o),i.removeListener("error",o),i.removeListener("response",o),i.removeListener("close",o),e&&i.removeListener("timeout",e),i.socket||i._currentRequest.removeListener("socket",n)}return e&&this.on("timeout",e),this.socket?n(this.socket):this._currentRequest.once("socket",n),this.on("socket",r),this.on("abort",o),this.on("error",o),this.on("response",o),this.on("close",o),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(t){C.prototype[t]=function(e,i){return this._currentRequest[t](e,i)}})),["aborted","connection","socket"].forEach((function(t){Object.defineProperty(C.prototype,t,{get:function(){return this._currentRequest[t]}})})),C.prototype._sanitizeOptions=function(t){if(t.headers||(t.headers={}),t.host&&(t.hostname||(t.hostname=t.host),delete t.host),!t.pathname&&t.path){var e=t.path.indexOf("?");e<0?t.pathname=t.path:(t.pathname=t.path.substring(0,e),t.search=t.path.substring(e))}},C.prototype._performRequest=function(){var t=this._options.protocol,e=this._options.nativeProtocols[t];if(!e)throw new TypeError("Unsupported protocol "+t);if(this._options.agents){var i=t.slice(0,-1);this._options.agent=this._options.agents[i]}var r=this._currentRequest=e.request(this._options,this._onNativeResponse);for(var n of(r._redirectable=this,g))r.on(n,f[n]);if(this._currentUrl=/^\//.test(this._options.path)?s.format(this._options):this._options.path,this._isRedirect){var o=0,a=this,u=this._requestBodyBuffers;!function t(e){if(r===a._currentRequest)if(e)a.emit("error",e);else if(o<u.length){var i=u[o++];r.finished||r.write(i.data,i.encoding,t)}else a._ended&&r.end()}()}},C.prototype._processResponse=function(t){var e=t.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:t.headers,statusCode:e});var i,r=t.headers.location;if(!r||!1===this._options.followRedirects||e<300||e>=400)return t.responseUrl=this._currentUrl,t.redirects=this._redirects,this.emit("response",t),void(this._requestBodyBuffers=[]);if(A(this._currentRequest),t.destroy(),++this._redirectCount>this._options.maxRedirects)throw new b;var n=this._options.beforeRedirect;n&&(i=Object.assign({Host:t.req.getHeader("host")},this._options.headers));var o=this._options.method;((301===e||302===e)&&"POST"===this._options.method||303===e&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],E(/^content-/i,this._options.headers));var u,p,c=E(/^host$/i,this._options.headers),m=I(this._currentUrl),g=c||m.host,f=/^\w+:/.test(r)?this._currentUrl:s.format(Object.assign(m,{host:g})),y=(u=r,p=f,d?new a(u,p):I(s.resolve(p,u)));if(h("redirecting to",y.href),this._isRedirect=!0,P(y,this._options),(y.protocol!==m.protocol&&"https:"!==y.protocol||y.host!==g&&!function(t,e){l(N(t)&&N(e));var i=t.length-e.length-1;return i>0&&"."===t[i]&&t.endsWith(e)}(y.host,g))&&E(/^(?:(?:proxy-)?authorization|cookie)$/i,this._options.headers),L(n)){var v={headers:t.headers,statusCode:e},S={url:f,method:o,headers:i};n(this._options,v,S),this._sanitizeOptions(this._options)}this._performRequest()},t.exports=O({http:u,https:p}),t.exports.wrap=O},1799(t,e,i){var r=i(7217),n=i(270);t.exports=function(t,e,i,o){var s=i.length,a=s,u=!o;if(null==t)return!a;for(t=Object(t);s--;){var p=i[s];if(u&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++s<a;){var c=(p=i[s])[0],l=t[c],h=p[1];if(u&&p[2]){if(void 0===l&&!(c in t))return!1}else{var d=new r;if(o)var m=o(l,h,c,t,e,d);if(!(void 0===m?n(h,l,3,o,d):m))return!1}}return!0}},1802(t,e,i){var r=i(2224),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,(function(t,i,r,n){e.push(r?n.replace(o,"$1"):i||t)})),e}));t.exports=s},1873(t,e,i){var r=i(9325).Symbol;t.exports=r},1882(t,e,i){var r=i(2552),n=i(3805);t.exports=function(t){if(!n(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},1912(t,e,i){(function(){"use strict";var t,r,n,o,s,a,u,p,c,l=function(t,e){return function(){return t.apply(e,arguments)}},h={}.hasOwnProperty;p=i(4043),o=i(4434),t=i(3177),u=i(2114),c=i(3557).setImmediate,r=i(6465).defaults,s=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},a=function(t,e,i){var r,n;for(r=0,n=t.length;r<n;r++)e=(0,t[r])(e,i);return e},n=function(t,e,i){var r;return(r=Object.create(null)).value=i,r.writable=!0,r.enumerable=!0,r.configurable=!0,Object.defineProperty(t,e,r)},e.Parser=function(i){function o(t){var i,n,o;if(this.parseStringPromise=l(this.parseStringPromise,this),this.parseString=l(this.parseString,this),this.reset=l(this.reset,this),this.assignOrPush=l(this.assignOrPush,this),this.processAsync=l(this.processAsync,this),!(this instanceof e.Parser))return new e.Parser(t);for(i in this.options={},n=r[.2])h.call(n,i)&&(o=n[i],this.options[i]=o);for(i in t)h.call(t,i)&&(o=t[i],this.options[i]=o);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(u.normalize)),this.reset()}return function(t,e){for(var i in e)h.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(o,i),o.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),c(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},o.prototype.assignOrPush=function(t,e,i){return e in t?(t[e]instanceof Array||n(t,e,[t[e]]),t[e].push(i)):this.options.explicitArray?n(t,e,[i]):n(t,e,i)},o.prototype.reset=function(){var t,e,i,r,o;return this.removeAllListeners(),this.saxParser=p.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(o=this,function(t){if(o.saxParser.resume(),!o.saxParser.errThrown)return o.saxParser.errThrown=!0,o.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,r=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(i){return function(o){var s,u,p,c,l;if((p={})[e]="",!i.options.ignoreAttrs)for(s in l=o.attributes)h.call(l,s)&&(t in p||i.options.mergeAttrs||(p[t]={}),u=i.options.attrValueProcessors?a(i.options.attrValueProcessors,o.attributes[s],s):o.attributes[s],c=i.options.attrNameProcessors?a(i.options.attrNameProcessors,s):s,i.options.mergeAttrs?i.assignOrPush(p,c,u):n(p[t],c,u));return p["#name"]=i.options.tagNameProcessors?a(i.options.tagNameProcessors,o.name):o.name,i.options.xmlns&&(p[i.options.xmlnskey]={uri:o.uri,local:o.local}),r.push(p)}}(this),this.saxParser.onclosetag=function(t){return function(){var i,o,u,p,c,l,d,m,g,f;if(l=r.pop(),c=l["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete l["#name"],!0===l.cdata&&(i=l.cdata,delete l.cdata),g=r[r.length-1],l[e].match(/^\s*$/)&&!i?(o=l[e],delete l[e]):(t.options.trim&&(l[e]=l[e].trim()),t.options.normalize&&(l[e]=l[e].replace(/\s{2,}/g," ").trim()),l[e]=t.options.valueProcessors?a(t.options.valueProcessors,l[e],c):l[e],1===Object.keys(l).length&&e in l&&!t.EXPLICIT_CHARKEY&&(l=l[e])),s(l)&&(l="function"==typeof t.options.emptyTag?t.options.emptyTag():""!==t.options.emptyTag?t.options.emptyTag:o),null!=t.options.validator&&(f="/"+function(){var t,e,i;for(i=[],t=0,e=r.length;t<e;t++)p=r[t],i.push(p["#name"]);return i}().concat(c).join("/"),function(){var e;try{return l=t.options.validator(f,g&&g[c],l)}catch(i){return e=i,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof l)if(t.options.preserveChildrenOrder){if(g){for(u in g[t.options.childkey]=g[t.options.childkey]||[],d={},l)h.call(l,u)&&n(d,u,l[u]);g[t.options.childkey].push(d),delete l["#name"],1===Object.keys(l).length&&e in l&&!t.EXPLICIT_CHARKEY&&(l=l[e])}}else p={},t.options.attrkey in l&&(p[t.options.attrkey]=l[t.options.attrkey],delete l[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in l&&(p[t.options.charkey]=l[t.options.charkey],delete l[t.options.charkey]),Object.getOwnPropertyNames(l).length>0&&(p[t.options.childkey]=l),l=p;return r.length>0?t.assignOrPush(g,c,l):(t.options.explicitRoot&&(m=l,n(l={},c,m)),t.resultObject=l,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),i=function(t){return function(i){var n,o;if(o=r[r.length-1])return o[e]+=i,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==i.replace(/\\n/g,"").trim())&&(o[t.options.childkey]=o[t.options.childkey]||[],(n={"#name":"__text__"})[e]=i,t.options.normalize&&(n[e]=n[e].replace(/\s{2,}/g," ").trim()),o[t.options.childkey].push(n)),o}}(this),this.saxParser.ontext=i,this.saxParser.oncdata=function(t){var e;if(e=i(t))return e.cdata=!0}},o.prototype.parseString=function(e,i){var r;null!=i&&"function"==typeof i&&(this.on("end",(function(t){return this.reset(),i(null,t)})),this.on("error",(function(t){return this.reset(),i(t)})));try{return""===(e=e.toString()).trim()?(this.emit("end",null),!0):(e=t.stripBOM(e),this.options.async?(this.remaining=e,c(this.processAsync),this.saxParser):this.saxParser.write(e).close())}catch(t){if(r=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",r),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw r}},o.prototype.parseStringPromise=function(t){return new Promise((e=this,function(i,r){return e.parseString(t,(function(t,e){return t?r(t):i(e)}))}));var e},o}(o),e.parseString=function(t,i,r){var n,o;return null!=r?("function"==typeof r&&(n=r),"object"==typeof i&&(o=i)):("function"==typeof i&&(n=i),o={}),new e.Parser(o).parseString(t,n)},e.parseStringPromise=function(t,i){var r;return"object"==typeof i&&(r=i),new e.Parser(r).parseStringPromise(t)}}).call(this)},1933(t,e,i){(function(){var e,r,n,o,s,a,u,p={}.hasOwnProperty;u=i(9241).isPlainObject,n=i(7260),r=i(3074),o=i(468),e=i(1737),a=i(3976),s=i(382),t.exports=function(t){function i(t){i.__super__.constructor.call(this,null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new r,t||(t={}),t.writer||(t.writer=new s),this.options=t,this.stringify=new a(t)}return function(t,e){for(var i in e)p.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"implementation",{value:new n}),Object.defineProperty(i.prototype,"doctype",{get:function(){var t,i,r,n;for(i=0,r=(n=this.children).length;i<r;i++)if((t=n[i]).type===e.DocType)return t;return null}}),Object.defineProperty(i.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(i.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(i.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(i.prototype,"origin",{get:function(){return null}}),Object.defineProperty(i.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(i.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(i.prototype,"contentType",{get:function(){return null}}),i.prototype.end=function(t){var e;return e={},t?u(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},i.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},i.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.renameNode=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createNodeIterator=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.createTreeWalker=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(o)}).call(this)},1986(t,e,i){var r=i(1873),n=i(7828),o=i(5288),s=i(5911),a=i(317),u=i(4247),p=r?r.prototype:void 0,c=p?p.valueOf:void 0;t.exports=function(t,e,i,r,p,l,h){switch(i){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!l(new n(t),new n(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var d=a;case"[object Set]":var m=1&r;if(d||(d=u),t.size!=e.size&&!m)return!1;var g=h.get(t);if(g)return g==e;r|=2,h.set(t,e);var f=s(d(t),d(e),r,p,l,h);return h.delete(t),f;case"[object Symbol]":if(c)return c.call(t)==c.call(e)}return!1}},2e3(t,e,i){var r=i(3945),n=i(2429),o=i(5389),s=i(6449);t.exports=function(t,e){return function(i,a){var u=s(i)?r:n,p=e?e():{};return u(i,t,o(a,2),p)}}},2018(t){"use strict";t.exports=require("tty")},2032(t,e,i){var r=i(1042);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},2112(t,e,i){"use strict";var r,n=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||(r=function(t){return r=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},r(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=r(t),s=0;s<i.length;s++)"default"!==i[s]&&n(e,t,i[s]);return o(e,t),e}),a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const u=s(i(7562)),p=i(2673),c=i(6117),l=a(i(8970)),h=i(3985),d=i(6185);class m extends p.SettingsMixinDeviceBase{constructor(t,e){super(t),this.plugin=e,this.streamCaps=[],this.motionCaps=null,this.audioCaps=null,this.timeCaps=null,this.osdCaps=null,this.ptzCaps=null,this.ptzPresets=[],this.deviceInfo=null,this.supplementLightCaps=null,this.supplementLightSettings=null,this.alarmCaps=null,this.alarmLinkageCaps=null,this.audioAlarmCaps=null,this.whiteLightAlarmCaps=null,this.lightAutomationForced=!1,this.suppressOnPut=!1,this.initStorage={},this.storageSettings=new c.StorageSettings(this,this.initStorage),this.plugin.mixinsMap[this.id]=this,setTimeout((async()=>!this.killed&&await this.init()),2e3)}async init(){await this.fetchMotionCapabilities(),await this.fetchStreamCapabilities(),await this.fetchAudioCapabilities(),await this.fetchTimeCapabilities(),await this.fetchOSDCapabilities(),await this.fetchPTZCapabilities(),await this.fetchDeviceInfo(),await this.fetchSupplementLightCapabilities(),await this.fetchAlarmCapabilities(),await this.refreshSettings(),await this.refreshSettings(),this.storageSettings.values.activateLightAutomation&&await this.startMotionListener()}async updateMotionCapabilities(){await this.fetchMotionCapabilities(),this.setMotionSettingsValues()}async updateStreamCapabilities(){await this.fetchStreamCapabilities(),this.setStreamSettingsValues(this.streamCaps)}async updateAudioCapabilities(){await this.fetchAudioCapabilities(),this.setAudioSettingsValues()}async updateTimeCapabilities(){await this.fetchTimeCapabilities(),this.setTimeSettingsValues()}async updateOSDCapabilities(){await this.fetchOSDCapabilities(),this.setOSDSettingsValues()}async updatePTZCapabilities(){await this.fetchPTZCapabilities(),this.setPTZSettingsValues()}async updateSupplementLightCapabilities(){await this.fetchSupplementLightCapabilities(),this.setSupplementLightSettingsValues()}async updateAlarmCapabilities(){await this.fetchAlarmCapabilities(),this.setAlarmSettingsValues()}async fetchMotionCapabilities(){const t=await this.getClient();this.motionCaps=await t.getMotionCapabilities();const e=await t.getMotionEventTrigger();this.motionCaps.centerNotificationEnabled=e.centerNotificationEnabled}async fetchAudioCapabilities(){const t=await this.getClient();this.audioCaps=await t.getTwoWayAudioCapabilities()}async fetchTimeCapabilities(){const t=await this.getClient();this.timeCaps=await t.getTimeCapabilities()}async fetchOSDCapabilities(){const t=await this.getClient(),e=await t.getOSDCapabilities(),i=await t.getOSD(),r=await t.getVideoInputChannel();this.osdCaps={...e,...i,videoInputName:r.name}}async fetchDeviceInfo(){const t=await this.getClient();this.deviceInfo=await t.getDeviceInfo()}async fetchPTZCapabilities(){const t=await this.getClient();try{this.ptzCaps=await t.getPTZCapabilities(),this.ptzPresets=await t.getPTZPresets()}catch(t){this.console.log("PTZ not supported or error fetching capabilities",t),this.ptzCaps=null,this.ptzPresets=[]}}async fetchSupplementLightCapabilities(){const t=await this.getClient();try{if(this.supplementLightCaps=await t.getSupplementLightCapabilities(),this.supplementLightCaps&&(this.supplementLightSettings=await t.getSupplementLight(),this.supplementLightSettings)){const t={eventIntelligence:"Smart",colorVuWhiteLight:"White",irLight:"IR",close:"Off"},e=this.supplementLightSettings.supplementLightMode?.[0]||"close",i=this.supplementLightCaps.cameraType?.[0];this.storageSettings.values.supplementLightMode="white-only"===i?"White":"ir-only"===i?"IR":t[e]||"Smart"}}catch(t){this.supplementLightCaps=null,this.supplementLightSettings=null}}async fetchAlarmCapabilities(){const t=await this.getClient();try{this.alarmCaps=await t.getAlarmCapabilities(),this.alarmLinkageCaps=await t.getAlarmLinkageCapabilities(),this.audioAlarmCaps=await t.getAudioAlarmCapabilities(),this.whiteLightAlarmCaps=await t.getWhiteLightAlarmCapabilities()}catch(t){this.alarmCaps=null,this.alarmLinkageCaps=null,this.audioAlarmCaps=null,this.whiteLightAlarmCaps=null}}generateMotionSettings(){const t=[];return this.motionCaps?(t.push({key:"motionEnabled",title:"Motion Enabled",subgroup:"Motion",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateMotionDetection({enabled:e})}}),t.push({key:"motionSensitivity",title:"Motion Sensitivity",subgroup:"Motion",type:"string",choices:this.motionCaps.sensitivityOptions,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateMotionDetection({motionSensitivity:e})}}),t.push({key:"motionCenterNotification",title:"Send to Notification Center",description:"Enable notifications to surveillance center",subgroup:"Motion",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateMotionEventTrigger({centerNotificationEnabled:e})}}),t.push({key:"motionRefetch",title:"Refetch",subgroup:"Motion",type:"button",onPut:async()=>{await this.updateMotionCapabilities()}}),t):t}generateStreamSettings(t){const e=[];for(const i of t){const t=i.id,r=i.capabilities;e.push({key:`${t}:name`,title:"Stream name",description:`${t}`,subgroup:"Stream",type:"html"});const n=r.resolutions.map((t=>`${t.width}x${t.height}`));e.push({key:`${t}:videoResolution`,title:`Resolution (Stream ${t})`,subgroup:"Stream",type:"string",choices:n,immediate:!0,onPut:async(e,i)=>{if(e!==i&&void 0!==e){const[e,r]=i.split("x").map(Number);await this.updateStreamingChannel(t,{videoResolutionWidth:e,videoResolutionHeight:r})}}});const o=r.allFrameRates.map((t=>t.label));e.push({key:`${t}:maxFrameRate`,title:`FPS (Stream ${t})`,subgroup:"Stream",type:"string",choices:o,immediate:!0,onPut:async(e,i)=>{if(e!==i&&void 0!==e){const e=r.allFrameRates.find((t=>t.label===i))?.value;e&&await this.updateStreamingChannel(t,{maxFrameRate:e})}}}),e.push({key:`${t}:videoQualityControlType`,title:`Quality Control (Stream ${t})`,subgroup:"Stream",type:"string",choices:r.qualityControlTypes,immediate:!0}),e.push({key:`${t}:bitrate`,title:`Bitrate kbps (Stream ${t})`,subgroup:"Stream",type:"string",choices:[],immediate:!0});const s=r.videoCodecs.map((t=>t.type));e.push({key:`${t}:videoCodecType`,title:`Video Codec (Stream ${t})`,subgroup:"Stream",type:"string",choices:s,immediate:!0});const a=i.video,u=(i.audio,a.maxFrameRate/100),p=Math.ceil(a.govLengthMin/u),c=Math.floor(a.govLengthMax/u),l=[];for(let t=p;t<=c;t++)l.push(String(t));e.push({key:`${t}:govLength`,title:`I-Frame Interval (Stream ${t})`,description:`Min: ${p}s, Max: ${c}s (GOP)`,subgroup:"Stream",type:"string",choices:l,immediate:!0,onPut:async(e,i)=>{if(e!==i&&void 0!==e){const e=Math.round(Number(i)*u);await this.updateStreamingChannel(t,{govLength:e})}}});const h=["Minimum (1)","Very Low (20)","Low (40)","Medium (60)","High (80)","Maximum (100)"];e.push({key:`${t}:fixedQuality`,title:`Fixed Quality (Stream ${t})`,subgroup:"Stream",type:"string",choices:h,immediate:!0,onPut:async(e,i)=>{if(e!==i&&void 0!==e){const e=i.match(/\((\d+)\)/),r=Number(e?e[1]:i);this.console.log(`Setting fixedQuality for stream ${t}: ${i} -> ${r}`),await this.updateStreamingChannel(t,{fixedQuality:r})}}}),e.push({key:`${t}:audioEnabled`,title:`Audio Enabled (Stream ${t})`,subgroup:"Stream",type:"boolean",immediate:!0,onPut:async(e,i)=>{e!==i&&void 0!==e&&await this.updateStreamingChannel(t,{audioEnabled:i})}}),"H.265"===a.videoCodecType&&e.push({key:`${t}:smartCodecEnabled`,title:`H.265+ Smart Codec (Stream ${t})`,description:"Enable H.265+ for better compression",subgroup:"Stream",type:"boolean",immediate:!0,onPut:async(e,i)=>{e!==i&&void 0!==e&&await this.updateStreamingChannel(t,{smartCodecEnabled:i})}})}return e.push({key:"streamsRefetch",title:"Refetch",subgroup:"Stream",type:"button",onPut:async()=>{await this.updateStreamCapabilities()}}),e}generateAudioSettings(){const t=[];if(!this.audioCaps)return t;t.push({key:"audioCodec",title:"Audio Codec",subgroup:"Audio",type:"string",choices:this.audioCaps.audioCodecs,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({audioCompressionType:e})}});const e=[];for(let t=this.audioCaps.speakerVolumeMin;t<=this.audioCaps.speakerVolumeMax;t+=10)e.push(String(t));return e.includes(String(this.audioCaps.speakerVolumeMax))||e.push(String(this.audioCaps.speakerVolumeMax)),t.push({key:"speakerVolume",title:"Speaker Volume",description:`Range: ${this.audioCaps.speakerVolumeMin}-${this.audioCaps.speakerVolumeMax}`,subgroup:"Audio",type:"string",choices:e,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({speakerVolume:Number(e)})}}),this.audioCaps.supportsNoiseReduction&&t.push({key:"noiseReduction",title:"Noise Reduction",subgroup:"Audio",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({noiseReduction:e})}}),t.push({key:"audioInputType",title:"Audio Input Type",subgroup:"Audio",type:"string",choices:this.audioCaps.audioInputTypes,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({audioInputType:e})}}),t.push({key:"audioRefetch",title:"Refetch",subgroup:"Audio",type:"button",onPut:async()=>{await this.updateAudioCapabilities()}}),t}generateTimeSettings(){const t=[];if(!this.timeCaps)return t;const e=this.storageSettings.values.timeMode;if(t.push({key:"timeMode",title:"Time Mode",subgroup:"Time",type:"string",choices:this.timeCaps.timeModes||[],immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){if("manual"===e){const t=(new Date).toISOString().slice(0,19);await this.updateTime({timeMode:e,localTime:t})}else await this.updateTime({timeMode:e});await this.updateTimeCapabilities(),await this.refreshSettings()}}}),"NTP"===e){t.push({key:"ntpServer",title:"NTP Server IP",description:"IP address of NTP server",subgroup:"Time",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateNTPServer({ipAddress:e})}}),t.push({key:"ntpPort",title:"NTP Server Port",description:"Port number of NTP server",subgroup:"Time",type:"number",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateNTPServer({portNo:e})}});const e=[];for(let t=1;t<=36;t++)e.push(`${t} hour${t>1?"s":""}`);t.push({key:"ntpSyncInterval",title:"NTP Sync Interval",description:"How often to sync with NTP server",subgroup:"Time",type:"string",choices:e,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=e.match(/^(\d+) hour/);if(t){const e=60*Number(t[1]);await this.updateNTPServer({synchronizeInterval:e})}}}})}t.push({key:"timeZone",title:"Time Zone",description:"Select timezone offset from UTC",subgroup:"Time",type:"string",choices:["UTC-12:00:00","UTC-11:00:00","UTC-10:00:00","UTC-9:00:00","UTC-8:00:00","UTC-7:00:00","UTC-6:00:00","UTC-5:00:00","UTC-4:00:00","UTC-3:00:00","UTC-2:00:00","UTC-1:00:00","UTC+0:00:00","UTC+1:00:00","UTC+2:00:00","UTC+3:00:00","UTC+4:00:00","UTC+5:00:00","UTC+6:00:00","UTC+7:00:00","UTC+8:00:00","UTC+9:00:00","UTC+10:00:00","UTC+11:00:00","UTC+12:00:00"],immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=e.match(/UTC([+-])(\d+):00:00/);if(t){const e=`CST${"+"===t[1]?"-":"+"}${t[2]}:00:00`,i="DST01:00:00,M3.5.0/02:00:00,M10.5.0/03:00:00",r=!0===this.storageSettings.values.daylightSaving?`${e}${i}`:e;await this.updateTime({timeZone:r})}}}});return t.push({key:"daylightSaving",title:"Daylight Saving Time",description:"Enable DST (Ora Legale)",subgroup:"Time",type:"boolean",immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=(this.storageSettings.values.timeZone||"UTC+1:00:00").match(/UTC([+-])(\d+):00:00/);if(t){const i=`CST${"+"===t[1]?"-":"+"}${t[2]}:00:00`,r=e?`${i}DST01:00:00,M3.5.0/02:00:00,M10.5.0/03:00:00`:i;await this.updateTime({timeZone:r})}}}}),t.push({key:"timeRefetch",title:"Refetch",subgroup:"Time",type:"button",onPut:async()=>{await this.updateTimeCapabilities()}}),t}getOSDPositionPresets(t,e){const i=60,r=220;return{"Top Left 1":{x:0,y:e-0},"Top Left 2":{x:0,y:e-0-i},"Top Left 3":{x:0,y:e-0-120},"Top Right 1":{x:t-r-0,y:e-0},"Top Right 2":{x:t-r-0,y:e-0-i},"Top Right 3":{x:t-r-0,y:e-0-120},"Bottom Left 1":{x:0,y:0},"Bottom Left 2":{x:0,y:60},"Bottom Left 3":{x:0,y:120},"Bottom Right 1":{x:t-r-0,y:0},"Bottom Right 2":{x:t-r-0,y:60},"Bottom Right 3":{x:t-r-0,y:120}}}generateOSDSettings(){const t=[];if(!this.osdCaps)return t;const e=this.osdCaps.normalizedScreenWidth||704,i=this.osdCaps.normalizedScreenHeight||576,r=this.getOSDPositionPresets(e,i),n=Object.keys(r);t.push({key:"osdDateTimeEnabled",title:"Show Date/Time",subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{enabled:e}})}}),this.storageSettings.values.osdDateTimeEnabled&&(t.push({key:"osdDateStyle",title:"Date Format",subgroup:"OSD",type:"string",choices:["YYYY-MM-DD","MM-DD-YYYY","DD-MM-YYYY"],immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{dateStyle:e}})}}),t.push({key:"osdTimeStyle",title:"Time Format",subgroup:"OSD",type:"string",choices:["12hour","24hour"],immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{timeStyle:e}})}}),t.push({key:"osdDisplayWeek",title:"Show Week Day",subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{displayWeek:e}})}}),t.push({key:"osdDateTimePositionPreset",title:"Date/Time Position Preset",subgroup:"OSD",type:"string",choices:n,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=r[e];if(t){this.suppressOnPut=!0;try{this.storageSettings.values.osdDateTimeX=t.x,this.storageSettings.values.osdDateTimeY=t.y,await this.updateOSD({dateTimeOverlay:{positionX:t.x,positionY:t.y}}),this.osdCaps&&this.osdCaps.dateTimeOverlay&&(this.osdCaps.dateTimeOverlay.positionX=[String(t.x)],this.osdCaps.dateTimeOverlay.positionY=[String(t.y)])}finally{this.suppressOnPut=!1}await this.refreshSettings()}}}}),t.push({key:"osdDateTimeX",title:"Date/Time X Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{positionX:e}})}}),t.push({key:"osdDateTimeY",title:"Date/Time Y Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{positionY:e}})}})),t.push({key:"osdChannelNameEnabled",title:"Show Channel Name",subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&(await this.updateOSD({channelNameOverlay:{enabled:e}}),await this.updateOSDCapabilities(),await this.refreshSettings())}}),this.storageSettings.values.osdChannelNameEnabled&&(t.push({key:"osdChannelName",title:"Channel Name",description:"Updates the video input channel name which is used as channel name overlay",subgroup:"OSD",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&(await this.updateVideoInputChannel(e),this.osdCaps&&(this.osdCaps.videoInputName=e))}}),t.push({key:"osdChannelNamePositionPreset",title:"Channel Name Position Preset",subgroup:"OSD",type:"string",choices:n,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=r[e];if(t){this.suppressOnPut=!0;try{this.storageSettings.values.osdChannelNameX=t.x,this.storageSettings.values.osdChannelNameY=t.y,await this.updateOSD({channelNameOverlay:{positionX:t.x,positionY:t.y}}),this.osdCaps&&this.osdCaps.channelNameOverlay&&(this.osdCaps.channelNameOverlay.positionX=[String(t.x)],this.osdCaps.channelNameOverlay.positionY=[String(t.y)])}finally{this.suppressOnPut=!1}await this.refreshSettings()}}}}),t.push({key:"osdChannelNameX",title:"Channel Name X Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({channelNameOverlay:{positionX:e}})}}),t.push({key:"osdChannelNameY",title:"Channel Name Y Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({channelNameOverlay:{positionY:e}})}}));const o=this.osdCaps.textOverlayListSize||8;for(let e=1;e<=o;e++){const i=String(e);t.push({key:`osdText${i}Enabled`,title:`Text Overlay ${i} Enabled`,subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&(await this.updateOSD({textOverlays:[{id:i,enabled:e}]}),await this.updateOSDCapabilities(),await this.refreshSettings())}}),this.storageSettings.values[`osdText${i}Enabled`]&&(t.push({key:`osdText${i}Content`,title:`Text Overlay ${i} Content`,subgroup:"OSD",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({textOverlays:[{id:i,displayText:e}]})}}),t.push({key:`osdText${i}PositionPreset`,title:`Text Overlay ${i} Position Preset`,subgroup:"OSD",type:"string",choices:n,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=r[e];if(t){this.suppressOnPut=!0;try{if(this.storageSettings.values[`osdText${i}X`]=t.x,this.storageSettings.values[`osdText${i}Y`]=t.y,await this.updateOSD({textOverlays:[{id:i,positionX:t.x,positionY:t.y}]}),this.osdCaps&&this.osdCaps.textOverlayList){const e=this.osdCaps.textOverlayList.find((t=>t.id?.[0]===i));e&&(e.positionX=[String(t.x)],e.positionY=[String(t.y)])}}finally{this.suppressOnPut=!1}await this.refreshSettings()}}}}),t.push({key:`osdText${i}X`,title:`Text Overlay ${i} X`,subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({textOverlays:[{id:i,positionX:e}]})}}),t.push({key:`osdText${i}Y`,title:`Text Overlay ${i} Y`,subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({textOverlays:[{id:i,positionY:e}]})}}))}return t.push({key:"refetchOSD",title:"Refetch OSD Settings",subgroup:"OSD",type:"button",onPut:async()=>{await this.updateOSDCapabilities(),await this.refreshSettings()}}),t}generatePTZSettings(){const t=[];if(!this.ptzCaps)return t;const e=this.ptzCaps.specialNos||[],i=Math.min(this.ptzCaps.maxPresetNum||32,32);for(let r=1;r<=i;r++){if(e.includes(r))continue;const i=String(r);t.push({key:`ptzPreset${i}Enabled`,title:`Preset ${i} Enabled`,subgroup:"PTZ",type:"boolean",immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){if(e){const t=this.storageSettings.values[`ptzPreset${i}Name`]||`Preset ${i}`;await this.updatePTZPreset(i,t)}else await this.deletePTZPreset(i);await this.updatePTZCapabilities(),await this.refreshSettings()}}}),this.storageSettings.values[`ptzPreset${i}Enabled`]&&(t.push({key:`ptzPreset${i}Name`,title:`Preset ${i} Name`,description:"Updating name also sets preset to CURRENT position",subgroup:"PTZ",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updatePTZPreset(i,e)}}),t.push({key:`ptzPreset${i}Go`,title:`Go to Preset ${i}`,subgroup:"PTZ",type:"button",onPut:async()=>{await this.gotoPTZPreset(i)}}))}return t.push({key:"refetchPTZ",title:"Refetch PTZ Settings",subgroup:"PTZ",type:"button",onPut:async()=>{await this.updatePTZCapabilities(),await this.refreshSettings()}}),t}generateInfoSettings(){const t=[];if(!this.deviceInfo)return t;const e=[{key:"deviceName",title:"Device Name"},{key:"model",title:"Model"},{key:"serialNumber",title:"Serial Number"},{key:"firmwareVersion",title:"Firmware Version"},{key:"firmwareReleasedDate",title:"Firmware Date"},{key:"macAddress",title:"MAC Address"},{key:"deviceType",title:"Device Type"}];for(const i of e)"deviceName"===i.key?t.push({key:`info_${i.key}`,title:i.title,subgroup:"Info",type:"string",immediate:!1,onPut:async(t,e)=>{const i=await this.getClient();await i.updateDeviceInfo(e),this.deviceInfo&&(this.deviceInfo.deviceName=e)}}):t.push({key:`info_${i.key}`,title:i.title,subgroup:"Info",type:"string",readonly:!0});return t}generateSupplementLightSettings(){const t=[];if(!this.supplementLightCaps||"not-supported"===this.supplementLightCaps.cameraType?.[0])return t;const e=this.supplementLightCaps,i=e.modes.includes("Smart"),r=e.modes.includes("White"),n=e.modes.includes("IR");return t.push({key:"supplementLightEnabled",title:"Supplemental Light",subgroup:"Light",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateSupplementLight({enabled:e})}}),t.push({key:"smartSupplementLight",title:"Smart Supplement Light",description:"Enable to automatically adjust exposure to prevent overexposure when light is active",subgroup:"Light",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOverexposeSuppress(e)}}),"smart-hybrid"===e.cameraType?.[0]&&t.push({key:"supplementLightMode",title:"Light Mode",subgroup:"Light",type:"radiopanel",choices:e.modes,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateSupplementLight({mode:e})}}),i&&"smart-hybrid"===e.cameraType?.[0]&&t.push({key:"smartBrightnessControl",title:"Smart Brightness Control",subgroup:"Light",type:"string",choices:e.smartBrightnessControlOptions,radioGroups:["Smart"],onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateSupplementLight({smartBrightnessControl:e})}}),!r||"smart-hybrid"!==e.cameraType?.[0]&&"white-only"!==e.cameraType?.[0]||(t.push({key:"whiteBrightnessControl",title:"Light Brightness Control",subgroup:"Light",type:"string",choices:e.brightnessControlOptions,radioGroups:["White"],onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateSupplementLight({whiteBrightnessControl:e})}}),t.push({key:"whiteBrightness",title:"White Light Brightness",subgroup:"Light",type:"number",placeholder:"0-100",range:[Number(e.whiteBrightnessMin?.[0]),Number(e.whiteBrightnessMax?.[0])],radioGroups:["White","Smart"],onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateSupplementLight({whiteBrightness:e})}})),!n||"smart-hybrid"!==e.cameraType?.[0]&&"ir-only"!==e.cameraType?.[0]||(t.push({key:"irBrightnessControl",title:"IR Brightness Control",subgroup:"Light",type:"string",choices:e.brightnessControlOptions,radioGroups:["IR"],immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateSupplementLight({irBrightnessControl:e})}}),t.push({key:"irBrightness",title:"IR Light Brightness",subgroup:"Light",type:"number",placeholder:"0-100",range:[Number(e.irBrightnessMin?.[0]),Number(e.irBrightnessMax?.[0])],radioGroups:["IR","Smart"],onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateSupplementLight({irBrightness:e})}})),"smart-hybrid"===e.cameraType?.[0]&&r&&(t.push({key:"activateLightAutomation",title:"Activate Light Automation",description:"If enabled, motion events will temporarily force the supplemental light to White mode",subgroup:"Light",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&(e?await this.startMotionListener():await this.stopMotionListener(!0))}}),t.push({key:"additionalLightOffDelay",title:"Additional Light Off Delay (seconds)",description:"Extra seconds to keep the light on after motion ends",subgroup:"Light",type:"number",placeholder:"0",range:[0,3600],immediate:!1})),t.push({key:"supplementLightRefetch",title:"Refetch",subgroup:"Light",type:"button",onPut:async()=>{await this.updateSupplementLightCapabilities(),await this.refreshSettings()}}),t}generateAlarmSettings(){const t=[];if(this.alarmCaps&&t.push({key:"alarmEnabled",title:"Alarm Enabled",subgroup:"alarm",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAlarm({enabled:e})}}),this.alarmCaps&&this.alarmLinkageCaps&&(this.alarmLinkageCaps.supportsBeep&&t.push({key:"alarmBeep",title:"Audible Alarm Linkage",subgroup:"alarm",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAlarmLinkages({beep:e})}}),this.alarmLinkageCaps.supportsWhiteLight&&t.push({key:"alarmWhiteLight",title:"Flashing Alarm Light Linkage",subgroup:"alarm",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAlarmLinkages({whiteLight:e})}}),this.alarmLinkageCaps.supportsIO&&t.push({key:"alarmIOOutput",title:"IO Output Linkage",subgroup:"alarm",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAlarmLinkages({ioOutput:e})}})),this.audioAlarmCaps&&this.audioAlarmCaps.supported){const e=this.audioAlarmCaps;if(e.audioTypes&&e.audioTypes.length>0){const i=e.audioTypes.map((t=>t.description));t.push({key:"audioAlarmSoundType",title:"Audio Sound Type",subgroup:"alarm",type:"string",choices:i,onPut:async(t,i)=>{if(t!==i&&void 0!==t){const t=e.audioTypes.find((t=>t.description===i));t&&await this.updateAudioAlarmSettings({soundType:String(t.id)})}}})}t.push({key:"audioAlarmVolume",title:"Audio Volume",subgroup:"alarm",type:"number",onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudioAlarmSettings({volume:e})}}),t.push({key:"audioAlarmPlayCount",title:"Audio Play Count",subgroup:"alarm",type:"number",onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudioAlarmSettings({playCount:e})}})}if(this.whiteLightAlarmCaps&&this.whiteLightAlarmCaps.supported){const e=this.whiteLightAlarmCaps;t.push({key:"whiteLightAlarmDuration",title:"Flashing Light Duration",subgroup:"alarm",type:"number",onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateWhiteLightAlarmSettings({duration:e})}}),e.frequencyOptions&&e.frequencyOptions.length>0&&t.push({key:"whiteLightAlarmFrequency",title:"Flashing Light Frequency",subgroup:"alarm",type:"string",immediate:!0,choices:e.frequencyOptions,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateWhiteLightAlarmSettings({frequency:e})}})}return t.push({key:"alarmRefetch",title:"Refetch Alarm Settings",subgroup:"alarm",type:"button",onPut:async()=>{await this.updateAlarmCapabilities(),await this.refreshSettings()}}),t}setMotionSettingsValues(){this.motionCaps&&(this.storageSettings.values.motionEnabled=this.motionCaps.enabled,this.storageSettings.values.motionSensitivity=String(this.motionCaps.sensitivityLevel),this.storageSettings.values.motionCenterNotification=this.motionCaps.centerNotificationEnabled)}setStreamSettingsValues(t){for(const e of t){const t=e.id,i=e.video;this.storageSettings.values[`${t}:videoResolution`]=`${i.videoResolutionWidth}x${i.videoResolutionHeight}`,this.storageSettings.values[`${t}:maxFrameRate`]=i.maxFrameRateUI,this.storageSettings.values[`${t}:videoQualityControlType`]=i.videoQualityControlType;const r="VBR"===i.videoQualityControlType?i.vbrUpperCap:i.constantBitRate,n="VBR"===i.videoQualityControlType?i.vbrUpperCapMin:i.constantBitRateMin,o="VBR"===i.videoQualityControlType?i.vbrUpperCapMax:i.constantBitRateMax,s=(0,d.generateBitrateChoices)(n,o);this.storageSettings.settings[`${t}:bitrate`].choices=s,this.storageSettings.values[`${t}:bitrate`]=String(r),this.storageSettings.values[`${t}:videoCodecType`]=i.videoCodecType,this.storageSettings.values[`${t}:govLength`]=String(i.govLengthUI);const a={1:"Minimum (1)",20:"Very Low (20)",40:"Low (40)",60:"Medium (60)",80:"High (80)",100:"Maximum (100)"}[i.fixedQuality]||`Custom (${i.fixedQuality})`;this.storageSettings.values[`${t}:fixedQuality`]=a;const u=e.audio;this.storageSettings.values[`${t}:audioEnabled`]=u.enabled,"H.265"===i.videoCodecType&&(this.storageSettings.values[`${t}:smartCodecEnabled`]=i.smartCodecEnabled)}}async fetchStreamCapabilities(){const t=await this.getClient();this.streamCaps=await t.getStreamingCapabilities()}async setAudioSettingsValues(){const t=await this.getClient(),e=await t.getTwoWayAudio();e&&(this.storageSettings.values.audioCodec=e.audioCompressionType,this.storageSettings.values.speakerVolume=String(e.speakerVolume),this.storageSettings.values.noiseReduction=e.noiseReduction,this.storageSettings.values.audioInputType=e.audioInputType)}async setTimeSettingsValues(){const t=await this.getClient(),e=await t.getTime(),i=await t.getNTPServer();if(!e)return;if(this.storageSettings.values.timeMode=e.timeMode,"NTP"===e.timeMode&&i){this.storageSettings.values.ntpServer=i.ipAddress,this.storageSettings.values.ntpPort=i.portNo;const t=i.synchronizeInterval,e=Math.round(t/60);this.storageSettings.values.ntpSyncInterval=`${e} hour${e>1?"s":""}`}if(e.timeZone){const t=e.timeZone.split("DST")[0].match(/CST([+-])(\d+):00:00/);if(t){const e="-"===t[1]?"+":"-",i=t[2];this.storageSettings.values.timeZone=`UTC${e}${i}:00:00`}}const r=e.timeZone?.includes("DST");this.storageSettings.values.daylightSaving=r}setOSDSettingsValues(){if(!this.osdCaps)return;const{dateTimeOverlay:t,channelNameOverlay:e,textOverlayList:i}=this.osdCaps;if(t&&(this.storageSettings.values.osdDateTimeEnabled="true"===t.enabled?.[0],this.storageSettings.values.osdDateStyle=t.dateStyle?.[0],this.storageSettings.values.osdTimeStyle=t.timeStyle?.[0],this.storageSettings.values.osdDisplayWeek="true"===t.displayWeek?.[0],this.storageSettings.values.osdDateTimeX=Number(t.positionX?.[0]||0),this.storageSettings.values.osdDateTimeY=Number(t.positionY?.[0]||0)),e&&(this.storageSettings.values.osdChannelNameEnabled="true"===e.enabled?.[0],this.storageSettings.values.osdChannelName=this.osdCaps.videoInputName||"",this.storageSettings.values.osdChannelNameX=Number(e.positionX?.[0]||0),this.storageSettings.values.osdChannelNameY=Number(e.positionY?.[0]||0)),i)for(const t of i){const e=t.id?.[0];e&&(this.storageSettings.values[`osdText${e}Enabled`]="true"===t.enabled?.[0],this.storageSettings.values[`osdText${e}Content`]=t.displayText?.[0]||"",this.storageSettings.values[`osdText${e}X`]=Number(t.positionX?.[0]),this.storageSettings.values[`osdText${e}Y`]=Number(t.positionY?.[0]))}}setPTZSettingsValues(){if(this.ptzPresets)for(const t of this.ptzPresets){const e=t.id?.[0];e&&(this.storageSettings.values[`ptzPreset${e}Enabled`]=!0,this.storageSettings.values[`ptzPreset${e}Name`]=t.presetName?.[0]||`Preset ${e}`)}}setInfoSettingsValues(){if(!this.deviceInfo)return;const t=["deviceName","model","serialNumber","firmwareVersion","firmwareReleasedDate","macAddress","deviceType"];for(const e of t)this.storageSettings.values[`info_${e}`]=this.deviceInfo[e]||""}setSupplementLightSettingsValues(){if(!this.supplementLightCaps||!this.supplementLightSettings)return;const t=this.supplementLightSettings,e=this.supplementLightCaps,i=t.supplementLightMode?.[0]||"close",r={eventIntelligence:"Smart",colorVuWhiteLight:"White",irLight:"IR",close:"Off"}[i]||"Smart",n="close"!==i;this.storageSettings.values.supplementLightEnabled=n;const o=e.cameraType?.[0];if(this.storageSettings.values.supplementLightMode="white-only"===o?"White":"ir-only"===o?"IR":r,this.storageSettings.values.whiteBrightnessControl=t.mixedLightBrightnessRegulatMode?.[0]||"manual",this.storageSettings.values.irBrightnessControl=t.mixedLightBrightnessRegulatMode?.[0]||"manual",t.whiteLightBrightness&&(this.storageSettings.values.whiteBrightness=Number(t.whiteLightBrightness[0])),t.irLightBrightness&&(this.storageSettings.values.irBrightness=Number(t.irLightBrightness[0])),t.eventIntelligenceConfig&&"smart-hybrid"===o){const e=t.eventIntelligenceConfig[0];this.storageSettings.values.smartBrightnessControl=e.brightnessRegulatMode?.[0]||"manual",e.whiteLightBrightness&&(this.storageSettings.values.whiteBrightness=Number(e.whiteLightBrightness[0])),e.irLightBrightness&&(this.storageSettings.values.irBrightness=Number(e.irLightBrightness[0]))}}async setAlarmSettingsValues(){const t=await this.getClient();if(this.alarmCaps){const e=await t.getAlarm("1"),i=e.json.triggering?.[0],r="low"===i;this.storageSettings.values.alarmEnabled=r}if(this.alarmCaps&&this.alarmLinkageCaps){const e=await t.getAlarmLinkages();this.alarmLinkageCaps.supportsBeep&&(this.storageSettings.values.alarmBeep=e.beep),this.alarmLinkageCaps.supportsWhiteLight&&(this.storageSettings.values.alarmWhiteLight=e.whiteLight),this.alarmLinkageCaps.supportsIO&&(this.storageSettings.values.alarmIOOutput=e.io)}if(this.audioAlarmCaps?.supported){const e=await t.getAudioAlarmSettings();if(e){const t=this.audioAlarmCaps.audioTypes?.find((t=>t.id===e.audioID));t&&(this.storageSettings.values.audioAlarmSoundType=t.description),this.storageSettings.values.audioAlarmVolume=e.audioVolume,this.storageSettings.values.audioAlarmPlayCount=e.alarmTimes}}if(this.whiteLightAlarmCaps?.supported){const e=await t.getWhiteLightAlarmSettings();e&&(this.storageSettings.values.whiteLightAlarmDuration=e.durationTime,this.storageSettings.values.whiteLightAlarmFrequency=e.frequency)}}async updateStreamingChannel(t,e){const i=await this.getClient();this.console.log(`Updating stream ${t} with params:`,JSON.stringify(e,null,2)),await i.updateStreamingChannel({channelId:t,...e})}async updateAudio(t){const e=await this.getClient();this.console.log("Updating audio with params:",JSON.stringify(t,null,2)),await e.updateTwoWayAudio(t)}async updateTime(t){const e=await this.getClient();this.console.log("Updating time with params:",JSON.stringify(t,null,2)),await e.updateTime(t)}async updateNTPServer(t){const e=await this.getClient();this.console.log("Updating NTP server with params:",JSON.stringify(t,null,2)),await e.updateNTPServer(t)}async updateOSD(t){const e=await this.getClient();this.console.log("Updating OSD with params:",JSON.stringify(t,null,2)),await e.updateOSD(t)}async updateVideoInputChannel(t){const e=await this.getClient();this.console.log(`Updating video input channel name to: ${t}`),await e.updateVideoInputChannel(t)}async updatePTZPreset(t,e){const i=await this.getClient();this.console.log(`Updating PTZ preset ${t} with name: ${e}`),await i.updatePTZPreset(t,e)}async deletePTZPreset(t){const e=await this.getClient();this.console.log(`Deleting PTZ preset ${t}`),await e.deletePTZPreset(t)}async gotoPTZPreset(t){const e=await this.getClient();this.console.log(`Going to PTZ preset ${t}`),await e.gotoPTZPreset(t)}async updateMotionDetection({enabled:t,motionSensitivity:e}){const i=await this.getClient(),r={enabled:t,motionSensitivity:e};this.console.log("Updating motion detection with params:",r),await i.updateMotionDetection(r)}async updateMotionEventTrigger({centerNotificationEnabled:t}){const e=await this.getClient();this.console.log("Updating motion event trigger with params:",{centerNotificationEnabled:t}),await e.updateMotionEventTrigger({centerNotificationEnabled:t})}async updateSupplementLight(t){const e=await this.getClient(),i={Smart:"eventIntelligence",White:"colorVuWhiteLight",IR:"irLight",Off:"close"},r={};if(void 0!==t.enabled)if(t.enabled){const t=this.storageSettings.values.supplementLightMode||"Smart";r.supplementLightMode=i[t]||"eventIntelligence"}else r.supplementLightMode="close";void 0!==t.mode&&(r.supplementLightMode=i[t.mode]||"eventIntelligence"),void 0===t.whiteBrightnessControl&&void 0===t.irBrightnessControl||(r.mixedLightBrightnessRegulatMode=t.whiteBrightnessControl||t.irBrightnessControl),void 0!==t.smartBrightnessControl&&(r.eventIntelligenceConfig=r.eventIntelligenceConfig||{},r.eventIntelligenceConfig.brightnessRegulatMode=t.smartBrightnessControl);const n="Smart"===this.storageSettings.values.supplementLightMode;void 0===t.whiteBrightness&&void 0===t.irBrightness||(n?(r.eventIntelligenceConfig=r.eventIntelligenceConfig||{},r.eventIntelligenceConfig.whiteLightBrightness=void 0!==t.whiteBrightness?t.whiteBrightness:this.storageSettings.values.whiteBrightness,r.eventIntelligenceConfig.irLightBrightness=void 0!==t.irBrightness?t.irBrightness:this.storageSettings.values.irBrightness):(void 0!==t.whiteBrightness&&(r.whiteLightBrightness=t.whiteBrightness),void 0!==t.irBrightness&&(r.irLightBrightness=t.irBrightness))),await e.updateSupplementLight(r)}async updateOverexposeSuppress(t){const e=await this.getClient();await e.updateOverexposeSuppress(t)}async updateAlarm(t){const e=await this.getClient();await e.setAlarm(t.enabled)}async updateAlarmLinkages(t){const e=await this.getClient(),i=await e.getAlarmLinkages(),r={beep:t.beep??i.beep,whiteLight:t.whiteLight??i.whiteLight,io:t.ioOutput??i.io,whiteLightDuration:i.whiteLightDuration};await e.setAlarmLinkages(r),this.alarmLinkageCaps?.supportsBeep&&(this.storageSettings.values.alarmBeep=r.beep),this.alarmLinkageCaps?.supportsWhiteLight&&(this.storageSettings.values.alarmWhiteLight=r.whiteLight),this.alarmLinkageCaps?.supportsIO&&(this.storageSettings.values.alarmIOOutput=r.io)}async updateAudioAlarmSettings(t){const e=await this.getClient(),i=await e.getAudioAlarmSettings();if(i){const r={audioID:t.soundType?Number(t.soundType):i.audioID,audioVolume:t.volume??i.audioVolume,alarmTimes:t.playCount??i.alarmTimes};if(await e.setAudioAlarmSettings(r),this.audioAlarmCaps){const t=this.audioAlarmCaps.audioTypes.find((t=>t.id===r.audioID));this.storageSettings.values.audioAlarmSoundType=t?t.description:String(r.audioID)}this.storageSettings.values.audioAlarmVolume=r.audioVolume,this.storageSettings.values.audioAlarmPlayCount=r.alarmTimes}}async updateWhiteLightAlarmSettings(t){const e=await this.getClient(),i=await e.getWhiteLightAlarmSettings();if(i){const r={durationTime:t.duration??i.durationTime,frequency:t.frequency??i.frequency};await e.setWhiteLightAlarmSettings(r),this.storageSettings.values.whiteLightAlarmDuration=r.durationTime,this.storageSettings.values.whiteLightAlarmFrequency=r.frequency}}async release(){this.killed=!0,await this.stopMotionListener(!1)}clearLightAutomationTimeout(){this.lightAutomationOffTimeout&&(clearTimeout(this.lightAutomationOffTimeout),this.lightAutomationOffTimeout=void 0)}async restoreSupplementLightFromAutomation(){if(this.clearLightAutomationTimeout(),!this.lightAutomationForced)return;const t=this.lightAutomationPreviousState;if(this.lightAutomationForced=!1,this.lightAutomationPreviousState=void 0,t)try{t.enabled?(await this.updateSupplementLight({enabled:!0,mode:t.mode}),this.storageSettings.values.supplementLightEnabled=!0,this.storageSettings.values.supplementLightMode=t.mode):(await this.updateSupplementLight({enabled:!1}),this.storageSettings.values.supplementLightEnabled=!1)}catch(t){this.console.error("Failed restoring supplement light after automation",t)}}async stopMotionListener(t){this.clearLightAutomationTimeout(),t?await this.restoreSupplementLightFromAutomation():(this.lightAutomationForced=!1,this.lightAutomationPreviousState=void 0),this.motionListener=void 0;try{if(!this.motionListener)return;this.motionListener.removeListener(),this.motionListener=void 0}catch(t){this.console.error("Error stopping motion listener",t)}}async getDeviceProperties(){const t=await this.mixinDevice.getSettings(),e=(0,l.default)(t,(t=>t.key)),i=e.username?.value,r=e.password?.value,n=e.ip?.value;return{username:i,password:r,httpAddress:`${n}:${e.httpPort?.value||80}`,channel:e.rtspChannel?.value??"101",host:n}}async getClient(){if(!this.client){const{channel:t,httpAddress:e,username:i,password:r}=await this.getDeviceProperties();this.client=new h.HikvisionCameraAPI(e,i,r,t,this.console)}return this.client}async refreshSettings(){const t=[],e=this.generateInfoSettings();t.push(...e);const i=this.generateMotionSettings();t.push(...i);const r=this.generateStreamSettings(this.streamCaps);t.push(...r);const n=this.generateAudioSettings();t.push(...n);const o=this.generateTimeSettings();t.push(...o);const s=this.generateOSDSettings();t.push(...s);const a=this.generatePTZSettings();t.push(...a);const u=this.generateSupplementLightSettings();t.push(...u);const p=this.generateAlarmSettings();t.push(...p),this.storageSettings=await(0,d.convertSettingsToStorageSettings)({device:this,dynamicSettings:t,initStorage:this.initStorage}),this.setMotionSettingsValues(),this.setStreamSettingsValues(this.streamCaps),this.setAudioSettingsValues(),this.setTimeSettingsValues(),this.setOSDSettingsValues(),this.setPTZSettingsValues(),this.setInfoSettingsValues(),this.setSupplementLightSettingsValues(),this.setAlarmSettingsValues()}async startMotionListener(){this.motionListener||(this.motionListener=u.default.systemManager.listenDevice(this.id,{event:u.ScryptedInterface.MotionSensor},(async(t,e,i)=>{if(this.killed)return;if(!this.storageSettings.values.activateLightAutomation)return;let r;if(r="boolean"==typeof i?i:"string"==typeof i?"true"===i:void 0!==i?.motion?!!i.motion:void 0!==i?.data?!!i.data:!!i,r){if(this.clearLightAutomationTimeout(),!this.lightAutomationForced){const t=!!this.storageSettings.values.supplementLightEnabled,e=this.storageSettings.values.supplementLightMode||"Smart";this.lightAutomationPreviousState={enabled:t,mode:e},this.lightAutomationForced=!0}try{await this.updateSupplementLight({enabled:!0,mode:"White"}),this.storageSettings.values.supplementLightEnabled=!0,this.storageSettings.values.supplementLightMode="White"}catch(t){this.console.error("Failed enabling White supplemental light on motion",t)}return}const n=1e3*this.storageSettings.values.additionalLightOffDelay;this.clearLightAutomationTimeout(),this.lightAutomationOffTimeout=setTimeout((()=>{this.restoreSupplementLightFromAutomation()}),n)})))}async getMixinSettings(){try{return this.storageSettings.getSettings()}catch(t){return this.console.error("Error in getMixinSettings",t),[]}}async putSetting(t,e){const[i,...r]=t.split(":");i===this.settingsGroupKey?this.storageSettings.putSetting(r.join(":"),e):super.putSetting(t,e)}async putMixinSetting(t,e){this.storageSettings.putSetting(t,e)}}e.default=m},2114(t,e){(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),e.normalize=function(t){return t.toLowerCase()},e.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.stripPrefix=function(e){return e.replace(t,"")},e.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},e.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},2199(t,e,i){var r=i(4528),n=i(6449);t.exports=function(t,e,i){var o=e(t);return n(t)?o:r(o,i(t))}},2203(t){"use strict";t.exports=require("stream")},2224(t,e,i){var r=i(104);t.exports=function(t){var e=r(t,(function(t){return 500===i.size&&i.clear(),t})),i=e.cache;return e}},2428(t,e,i){var r=i(7534),n=i(346),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return n(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=u},2429(t,e,i){var r=i(909);t.exports=function(t,e,i,n){return r(t,(function(t,r,o){e(n,t,i(t),o)})),n}},2527(t){(function(){t.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}).call(this)},2535(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(1737),r=i(7457),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"wholeText",{get:function(){var t,e,i;for(i="",e=this.previousSibling;e;)i=e.data+i,e=e.previousSibling;for(i+=this.data,t=this.nextSibling;t;)i+=t.data,t=t.nextSibling;return i}}),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},i.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i}(r)}).call(this)},2552(t,e,i){var r=i(1873),n=i(659),o=i(9350),s=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?n(t):o(t)}},2613(t){"use strict";t.exports=require("assert")},2651(t,e,i){var r=i(4218);t.exports=function(t,e){var i=t.__data__;return r(e)?i["string"==typeof e?"string":"hash"]:i.map}},2673(t,e,i){"use strict";var r,n=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||(r=function(t){return r=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},r(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=r(t),s=0;s<i.length;s++)"default"!==i[s]&&n(e,t,i[s]);return o(e,t),e});Object.defineProperty(e,"__esModule",{value:!0}),e.SettingsMixinDeviceBase=void 0;const a=s(i(7562)),{deviceManager:u}=a.default;class p extends a.MixinDeviceBase{constructor(t){super(t),this.settingsGroup=t.group,this.settingsGroupKey=t.groupKey,process.nextTick((()=>u.onMixinEvent(this.id,this,a.ScryptedInterface.Settings,null)))}async getSettings(){const t=this.mixinDeviceInterfaces.includes(a.ScryptedInterface.Settings)?this.mixinDevice.getSettings():void 0,e=this.getMixinSettings(),i=[];try{const e=await t||[];i.push(...e)}catch(t){const e=this.name,r=`${e} Extension settings failed to load.`;this.console.error(r,t),i.push({key:Math.random().toString(),title:e,value:"Settings Error",group:"Errors",description:r,readonly:!0})}try{const t=await e||[];for(const e of t)e.group=e.group||this.settingsGroup,e.key=this.settingsGroupKey+":"+e.key;i.push(...t)}catch(t){const e=u.getDeviceState(this.mixinProviderNativeId).name,r=`${e} Extension settings failed to load.`;this.console.error(r,t),i.push({key:Math.random().toString(),title:e,value:"Settings Error",group:"Errors",description:r,readonly:!0})}return i}async putSetting(t,e){const i=this.settingsGroupKey+":";if(!t?.startsWith(i))return this.mixinDevice.putSetting(t,e);await this.putMixinSetting(t.substring(i.length),e)||u.onMixinEvent(this.id,this,a.ScryptedInterface.Settings,null)}async release(){await u.onMixinEvent(this.id,this,a.ScryptedInterface.Settings,null)}}e.SettingsMixinDeviceBase=p},2679(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(1737),r=i(7457),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},2691(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(1737),r=i(7457),t.exports=function(t){function i(t,r){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(r)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},2726(t){var e=1e3,i=60*e,r=60*i,n=24*r,o=7*n,s=365.25*n;function a(t,e,i,r){var n=e>=1.5*i;return Math.round(t/i)+" "+r+(n?"s":"")}t.exports=function(t,u){u=u||{};var p=typeof t;if("string"===p&&t.length>0)return function(t){if((t=String(t)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!a)return;var u=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*o;case"days":case"day":case"d":return u*n;case"hours":case"hour":case"hrs":case"hr":case"h":return u*r;case"minutes":case"minute":case"mins":case"min":case"m":return u*i;case"seconds":case"second":case"secs":case"sec":case"s":return u*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(t);if("number"===p&&isFinite(t))return u.long?function(t){var o=Math.abs(t);if(o>=n)return a(t,o,n,"day");if(o>=r)return a(t,o,r,"hour");if(o>=i)return a(t,o,i,"minute");if(o>=e)return a(t,o,e,"second");return t+" ms"}(t):function(t){var o=Math.abs(t);if(o>=n)return Math.round(t/n)+"d";if(o>=r)return Math.round(t/r)+"h";if(o>=i)return Math.round(t/i)+"m";if(o>=e)return Math.round(t/e)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},2749(t,e,i){var r=i(1042),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:n.call(e,t)}},2804(t,e,i){var r=i(6110)(i(9325),"Promise");t.exports=r},2949(t,e,i){var r=i(2651);t.exports=function(t,e){var i=r(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this}},3040(t,e,i){var r=i(1549),n=i(79),o=i(8223);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||n),string:new r}}},3074(t,e,i){(function(){var e,r;e=i(5660),r=i(2527),t.exports=function(){function t(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new r(Object.keys(this.defaultParams))}}),t.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},t.prototype.canSetParameter=function(t,e){return!0},t.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},t}()}).call(this)},3177(t,e){(function(){"use strict";e.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},3193(t){"use strict";t.exports=require("string_decoder")},3221(t){t.exports=function(t){return function(e,i,r){for(var n=-1,o=Object(e),s=r(e),a=s.length;a--;){var u=s[t?a:++n];if(!1===i(o[u],u,o))break}return e}}},3222(t,e,i){var r=i(7556);t.exports=function(t){return null==t?"":r(t)}},3243(t,e,i){var r=i(6110),n=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=n},3339(t){"use strict";t.exports=require("module")},3345(t){t.exports=function(){return[]}},3360(t,e,i){var r=i(3243);t.exports=function(t,e,i){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}},3482(t,e,i){const r=i(2018),n=i(9023);e.init=function(t){t.inspectOpts={};const i=Object.keys(e.inspectOpts);for(let r=0;r<i.length;r++)t.inspectOpts[i[r]]=e.inspectOpts[i[r]]},e.log=function(...t){return process.stderr.write(n.format(...t)+"\n")},e.formatArgs=function(i){const{namespace:r,useColors:n}=this;if(n){const e=this.color,n="[3"+(e<8?e:"8;5;"+e),o=`  ${n};1m${r} [0m`;i[0]=o+i[0].split("\n").join("\n"+o),i.push(n+"m+"+t.exports.humanize(this.diff)+"[0m")}else i[0]=function(){if(e.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+i[0]},e.save=function(t){t?process.env.DEBUG=t:delete process.env.DEBUG},e.load=function(){return process.env.DEBUG},e.useColors=function(){return"colors"in e.inspectOpts?Boolean(e.inspectOpts.colors):r.isatty(process.stderr.fd)},e.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),e.colors=[6,2,3,4,5,1];try{const t=i(Object(function(){var t=new Error("Cannot find module 'supports-color'");throw t.code="MODULE_NOT_FOUND",t}()));t&&(t.stderr||t).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(t){}e.inspectOpts=Object.keys(process.env).filter((t=>/^debug_/i.test(t))).reduce(((t,e)=>{const i=e.substring(6).toLowerCase().replace(/_([a-z])/g,((t,e)=>e.toUpperCase()));let r=process.env[e];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),t[i]=r,t}),{}),t.exports=i(5175)(e);const{formatters:o}=t.exports;o.o=function(t){return this.inspectOpts.colors=this.useColors,n.inspect(t,this.inspectOpts).split("\n").map((t=>t.trim())).join(" ")},o.O=function(t){return this.inspectOpts.colors=this.useColors,n.inspect(t,this.inspectOpts)}},3488(t){t.exports=function(t){return t}},3557(t){"use strict";t.exports=require("timers")},3605(t){t.exports=function(t){return this.__data__.get(t)}},3650(t,e,i){var r=i(4335)(Object.keys,Object);t.exports=r},3656(t,e,i){t=i.nmd(t);var r=i(9325),n=i(9935),o=e&&!e.nodeType&&e,s=o&&t&&!t.nodeType&&t,a=s&&s.exports===o?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||n;t.exports=u},3661(t,e,i){var r=i(3040),n=i(7670),o=i(289),s=i(4509),a=i(2949);function u(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=n,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,t.exports=u},3663(t,e,i){var r=i(1799),n=i(776),o=i(7197);t.exports=function(t){var e=n(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(i){return i===t||r(i,t,e)}}},3702(t){t.exports=function(){this.__data__=[],this.size=0}},3805(t){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},3862(t){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},3891(t){function e(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=3891,t.exports=e},3906(t,e,i){(function(){var e,r,n,o,s,a,u,p,c={}.hasOwnProperty;p=i(9241),u=p.isObject,a=p.isFunction,s=p.getValue,o=i(468),e=i(1737),r=i(4238),n=i(4797),t.exports=function(t){function i(t,r,n){var o,s,a,u;if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(r),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=n&&this.attribute(n),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,a=(u=t.children).length;s<a;s++)if((o=u[s]).type===e.DocType){o.name=this.name;break}}return function(t,e){for(var i in e)c.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(i.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(i.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(i.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(i.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new n(this.attribs)),this.attributeMap}}),i.prototype.clone=function(){var t,e,i,r;for(e in(i=Object.create(this)).isRoot&&(i.documentObject=null),i.attribs={},r=this.attribs)c.call(r,e)&&(t=r[e],i.attribs[e]=t.clone());return i.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=i,i.children.push(e)})),i},i.prototype.attribute=function(t,e){var i,n;if(null!=t&&(t=s(t)),u(t))for(i in t)c.call(t,i)&&(n=t[i],this.attribute(i,n));else a(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new r(this,t,""):null!=e&&(this.attribs[t]=new r(this,t,e));return this},i.prototype.removeAttribute=function(t){var e,i,r;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=s(t),Array.isArray(t))for(i=0,r=t.length;i<r;i++)e=t[i],delete this.attribs[e];else delete this.attribs[t];return this},i.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},i.prototype.att=function(t,e){return this.attribute(t,e)},i.prototype.a=function(t,e){return this.attribute(t,e)},i.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},i.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},i.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},i.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},i.prototype.setIdAttributeNS=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},i.prototype.isEqualNode=function(t){var e,r,n;if(!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=r=0,n=this.attribs.length-1;0<=n?r<=n:r>=n;e=0<=n?++r:--r)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},i}(o)}).call(this)},3945(t){t.exports=function(t,e,i,r){for(var n=-1,o=null==t?0:t.length;++n<o;){var s=t[n];e(r,s,i(s),t)}return r}},3976(t){(function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty;t.exports=function(){function t(t){var r,n,o;for(r in this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),n=t.stringify||{})i.call(n,r)&&(o=n[r],this[r]=o)}return t.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},t.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},t.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},t.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},t.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},t.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},t.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},t.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},t.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e,i;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+i.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,i=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+i.index);return t},t.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},t.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},t.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},t}()}).call(this)},3985(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.HikvisionCameraAPI=void 0;const n=i(6125),o=r(i(8805)),s=i(6185);e.HikvisionCameraAPI=class{constructor(t,e,i,r,n){this.ip=t,this.console=n,this.channel="101",this.credential={username:e,password:i},r&&(this.channel=r)}async request(t,e){return await(0,n.authHttpFetch)({..."string"==typeof t||t instanceof URL?{url:t}:t,rejectUnauthorized:!1,credential:this.credential,body:"string"==typeof t||t instanceof URL?e:t?.body})}async getMotionCapabilities(){const t=String(this.channel?.[0]??1),e=await this.request({method:"GET",url:`http://${this.ip}//ISAPI/System/Video/inputs/channels/${t}/motionDetection/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),i=(await o.default.parseStringPromise(e.body)).MotionDetection,r="true"===i.enabled[0]?._,n=i.MotionDetectionLayout[0]?.sensitivityLevel[0],s=Number(n?.$?.min??"0"),a=Number(n?.$?.max??"100"),u=Number(n?.$?.step??"20"),p=[String(s)];for(let t=s+u;t<=a;t+=u)p.push(String(t));const c=Number(n?._??"0");return{xml:e.body,enabled:r,sensitivityLevel:c,sensitivityOptions:p}}async updateMotionDetection(t){const{enabled:e,motionSensitivity:i}=t,r=String(this.channel?.[0]??1);let{xml:n}=await this.getMotionCapabilities();void 0!==e&&(n=n.replace(/<enabled[^>]*>.*?<\/enabled>/s,`<enabled>${e}</enabled>`)),void 0!==i&&(n=n.replace(/<sensitivityLevel[^>]*>.*?<\/sensitivityLevel>/s,`<sensitivityLevel>${i}</sensitivityLevel>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/${r}/motionDetection`,responseType:"text",headers:{"Content-Type":"application/xml"},body:n})}async getStreamingChannels(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Streaming/channels`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"}),i=e.StreamingChannelList?.StreamingChannel?.map((t=>{const e=t.Video?.[0],i=t=>t?"string"==typeof t?{value:Number(t),min:32,max:16384}:{value:Number(t._||0),min:Number(t.$.min||32),max:Number(t.$.max||16384)}:{value:0,min:32,max:16384},r=i(e?.constantBitRate?.[0]),n=i(e?.vbrUpperCap?.[0]),o=e?.GovLength?.[0],a=(u=o)?"string"==typeof u?{value:Number(u),min:1,max:400}:{value:Number(u._||0),min:Number(u.$.min||1),max:Number(u.$.max||400)}:{value:0,min:1,max:400};var u;const p=t.Audio?.[0];return{id:t.id?.[0],channelName:t.channelName?.[0],enabled:"true"===t.enabled?.[0],audio:{enabled:"true"===p?.enabled?.[0],audioInputChannelID:Number(p?.audioInputChannelID?.[0]),audioCompressionType:p?.audioCompressionType?.[0]},video:{enabled:"true"===e?.enabled?.[0],videoCodecType:e?.videoCodecType?.[0],videoResolutionWidth:Number(e?.videoResolutionWidth?.[0]),videoResolutionHeight:Number(e?.videoResolutionHeight?.[0]),maxFrameRate:Number(e?.maxFrameRate?.[0]),maxFrameRateUI:(0,s.formatFrameRate)(Number(e?.maxFrameRate?.[0])),videoQualityControlType:e?.videoQualityControlType?.[0],constantBitRate:r.value,constantBitRateMin:r.min,constantBitRateMax:r.max,vbrUpperCap:n.value,vbrUpperCapMin:n.min,vbrUpperCapMax:n.max,fixedQuality:Number(e?.fixedQuality?.[0]),govLength:a.value,govLengthMin:a.min,govLengthMax:a.max,govLengthUI:(0,s.formatKeyFrameInterval)(a.value,Number(e?.maxFrameRate?.[0])),smoothing:Number(e?.smoothing?.[0]),H264Profile:e?.H264Profile?.[0],H265Profile:e?.H265Profile?.[0],smartCodecEnabled:"true"===e?.SmartCodec?.[0]?.enabled?.[0]}}}))||[];return{xml:t.body,json:e,channels:i}}async updateStreamingChannel(t){const{channelId:e,videoCodecType:i,videoResolutionWidth:r,videoResolutionHeight:n,maxFrameRate:o,vbrUpperCap:s,constantBitRate:a,govLength:u,fixedQuality:p,videoQualityControlType:c,smoothing:l,H264Profile:h,H265Profile:d,audioEnabled:m,smartCodecEnabled:g}=t;let{xml:f}=await this.getStreamingChannels();const y=e||this.channel,v=new RegExp(`(<StreamingChannel[^>]*>[\\s\\S]*?<id>${y}<\\/id>[\\s\\S]*?<\\/StreamingChannel>)`,"g");f=f.replace(v,(t=>{let e=t;return void 0!==i&&(e=e.replace(/<videoCodecType[^>]*>.*?<\/videoCodecType>/s,`<videoCodecType>${i}</videoCodecType>`)),void 0!==r&&(e=e.replace(/<videoResolutionWidth[^>]*>.*?<\/videoResolutionWidth>/s,`<videoResolutionWidth>${r}</videoResolutionWidth>`)),void 0!==n&&(e=e.replace(/<videoResolutionHeight[^>]*>.*?<\/videoResolutionHeight>/s,`<videoResolutionHeight>${n}</videoResolutionHeight>`)),void 0!==o&&(e=e.replace(/<maxFrameRate[^>]*>.*?<\/maxFrameRate>/s,`<maxFrameRate>${o}</maxFrameRate>`)),void 0!==s&&(e=e.replace(/<vbrUpperCap[^>]*>.*?<\/vbrUpperCap>/s,`<vbrUpperCap>${s}</vbrUpperCap>`)),void 0!==a&&(e=e.replace(/<constantBitRate[^>]*>.*?<\/constantBitRate>/s,`<constantBitRate>${a}</constantBitRate>`)),void 0!==u&&(e=e.replace(/<GovLength(\s+[^>]*)?>.*?<\/GovLength>/s,((t,e)=>`<GovLength${e||""}>${u}</GovLength>`))),void 0!==p&&(e=e.replace(/<fixedQuality[^>]*>.*?<\/fixedQuality>/s,`<fixedQuality>${p}</fixedQuality>`)),void 0!==c&&(e=e.replace(/<videoQualityControlType[^>]*>.*?<\/videoQualityControlType>/s,`<videoQualityControlType>${c}</videoQualityControlType>`)),void 0!==l&&(e=e.replace(/<smoothing[^>]*>.*?<\/smoothing>/s,`<smoothing>${l}</smoothing>`)),void 0!==h&&(e=e.replace(/<H264Profile[^>]*>.*?<\/H264Profile>/s,`<H264Profile>${h}</H264Profile>`)),void 0!==d&&(e=e.replace(/<H265Profile[^>]*>.*?<\/H265Profile>/s,`<H265Profile>${d}</H265Profile>`)),void 0!==m&&(e=e.replace(/<Audio[^>]*>([\s\S]*?)<enabled[^>]*>.*?<\/enabled>([\s\S]*?)<\/Audio>/s,((t,e,i)=>`<Audio${e.match(/^[^>]*/)?.[0]||""}>${e.replace(/^[^>]*/,"")}<enabled>${m}</enabled>${i}</Audio>`))),void 0!==g&&(e=e.replace(/<SmartCodec[^>]*>([\s\S]*?)<enabled[^>]*>.*?<\/enabled>([\s\S]*?)<\/SmartCodec>/s,((t,e,i)=>`<SmartCodec${e.match(/^[^>]*/)?.[0]||""}>${e.replace(/^[^>]*/,"")}<enabled>${g}</enabled>${i}</SmartCodec>`))),e}));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Streaming/channels/${y}`,responseType:"text",headers:{"Content-Type":"application/xml"},body:f})}async getStreamingChannelCapabilities(t){const e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Streaming/channels/${t}/dynamicCap`,responseType:"text",headers:{"Content-Type":"application/xml"}}),i=(await o.default.parseStringPromise(e.body)).DynamicCap,r=i.ResolutionAvailableDscriptorList?.[0]?.ResolutionAvailableDscriptor?.map((t=>({width:Number(t.videoResolutionWidth?.[0]),height:Number(t.videoResolutionHeight?.[0]),frameRates:t.supportedFrameRate?.[0]?.split(",").map((t=>{const e=Number(t);return{value:e,label:(0,s.formatFrameRate)(e)}}))||[]})))||[],n=i.CodecParamDscriptorList?.[0]?.CodecParamDscriptor?.map((t=>({type:t.videoCodecType?.[0],supportProfile:"true"===t.isSupportProfile?.[0],supportSVC:"true"===t.isSupportSVC?.[0],cbrSupported:"true"===t.CBRCap?.[0]?.isSupportSmooth?.[0],vbrSupported:"true"===t.VBRCap?.[0]?.isSupportSmooth?.[0],smartCodecCap:t.SmartCodecCap?.[0]?{readOnlyParams:t.SmartCodecCap[0].readOnlyParams?.[0]?.$?.opt?.split(",")||[],constantBitrateSupport:t.SmartCodecCap[0].BitrateType?.[0]?.Constant?.[0]?.support?.[0]?.$?.opt?.split(",")||[],variableBitrateSupport:t.SmartCodecCap[0].BitrateType?.[0]?.Variable?.[0]?.support?.[0]?.$?.opt?.split(",")||[]}:void 0})))||[],a=[...new Set(r.flatMap((t=>t.frameRates.map((t=>t.value)))))].sort(((t,e)=>e-t)).map((t=>({value:t,label:(0,s.formatFrameRate)(t)}))),u=[];return n.forEach((t=>{t.vbrSupported&&!u.includes("VBR")&&u.push("VBR"),t.cbrSupported&&!u.includes("CBR")&&u.push("CBR")})),{resolutions:r,videoCodecs:n,allFrameRates:a,qualityControlTypes:u}}async getStreamingCapabilities(){const{channels:t}=await this.getStreamingChannels();return await Promise.all(t.map((async t=>{const e=await this.getStreamingChannelCapabilities(t.id);return{...t,capabilities:e}})))}async getTwoWayAudioCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/TwoWayAudio/channels/1/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).TwoWayAudioChannel,i=e.audioCompressionType?.[0],r="object"==typeof i?i.$.opt.split(","):[],n=e.audioInputType?.[0],s="object"==typeof n?n.$.opt.split(","):[],a=e.speakerVolume?.[0];return{audioCodecs:r,audioInputTypes:s,speakerVolumeMin:"object"==typeof a?Number(a.$.min):0,speakerVolumeMax:"object"==typeof a?Number(a.$.max):100,supportsNoiseReduction:e.noisereduce?.[0]?.$.opt?.includes("true")||!1}}async getTwoWayAudio(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/TwoWayAudio/channels/1`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).TwoWayAudioChannel;return{xml:t.body,enabled:"true"===e.enabled?.[0],audioCompressionType:e.audioCompressionType?.[0],speakerVolume:Number(e.speakerVolume?.[0]),noiseReduction:"true"===e.noisereduce?.[0],audioInputType:e.audioInputType?.[0]}}async updateTwoWayAudio(t){let{xml:e}=await this.getTwoWayAudio();void 0!==t.audioCompressionType&&(e=e.replace(/<audioCompressionType[^>]*>.*?<\/audioCompressionType>/s,`<audioCompressionType>${t.audioCompressionType}</audioCompressionType>`)),void 0!==t.speakerVolume&&(e=e.replace(/<speakerVolume[^>]*>.*?<\/speakerVolume>/s,`<speakerVolume>${t.speakerVolume}</speakerVolume>`)),void 0!==t.noiseReduction&&(e=e.replace(/<noisereduce[^>]*>.*?<\/noisereduce>/s,`<noisereduce>${t.noiseReduction}</noisereduce>`)),void 0!==t.audioInputType&&(e=e.replace(/<audioInputType[^>]*>.*?<\/audioInputType>/s,`<audioInputType>${t.audioInputType}</audioInputType>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/TwoWayAudio/channels/1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async getTimeCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/time/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).Time,i=e.timeMode?.[0];return{timeModes:"object"==typeof i?i.$.opt.split(","):[]}}async getTime(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/time`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).Time;return{xml:t.body,timeMode:e.timeMode?.[0],localTime:e.localTime?.[0],timeZone:e.timeZone?.[0]}}async getNTPServer(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/time/ntpServers/1`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).NTPServer;return{xml:t.body,ipAddress:e.ipAddress?.[0],portNo:Number(e.portNo?.[0]),synchronizeInterval:Number(e.synchronizeInterval?.[0])}}async updateTime(t){let{xml:e}=await this.getTime();void 0!==t.timeMode&&(e=e.replace(/<timeMode[^>]*>.*?<\/timeMode>/s,`<timeMode>${t.timeMode}</timeMode>`)),void 0!==t.localTime&&(e=e.replace(/<localTime[^>]*>.*?<\/localTime>\s*/s,""),e=e.replace(/(<timeMode>[^<]*<\/timeMode>)/s,`$1\n    <localTime>${t.localTime}</localTime>`)),void 0!==t.timeZone&&(e=e.replace(/<timeZone[^>]*>.*?<\/timeZone>/s,`<timeZone>${t.timeZone}</timeZone>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/time`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async updateNTPServer(t){let{xml:e}=await this.getNTPServer();void 0!==t.ipAddress&&(e=e.replace(/<ipAddress[^>]*>.*?<\/ipAddress>/s,`<ipAddress>${t.ipAddress}</ipAddress>`)),void 0!==t.portNo&&(e=e.replace(/<portNo[^>]*>.*?<\/portNo>/s,`<portNo>${t.portNo}</portNo>`)),void 0!==t.synchronizeInterval&&(e=e.replace(/<synchronizeInterval[^>]*>.*?<\/synchronizeInterval>/s,`<synchronizeInterval>${t.synchronizeInterval}</synchronizeInterval>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/time/ntpServers/1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async getMotionEventTrigger(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/VMD-1`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).EventTrigger,i=(e.EventTriggerNotificationList?.[0]?.EventTriggerNotification||[]).some((t=>"center"===t.notificationMethod?.[0]));return{xml:t.body,centerNotificationEnabled:i}}async updateMotionEventTrigger(t){let{xml:e}=await this.getMotionEventTrigger();if(void 0!==t.centerNotificationEnabled){const i=await o.default.parseStringPromise(e,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"}),r=(i.EventTrigger.EventTriggerNotificationList?.[0]?.EventTriggerNotification||[]).filter((t=>"center"!==t.notificationMethod?.[0]));t.centerNotificationEnabled&&r.push({id:["center"],notificationMethod:["center"]}),i.EventTrigger.EventTriggerNotificationList||(i.EventTrigger.EventTriggerNotificationList=[{}]),i.EventTrigger.EventTriggerNotificationList[0].EventTriggerNotification=r,delete i.EventTrigger.$.version,delete i.EventTrigger.$.xmlns,delete i.EventTrigger.eventDescription,delete i.EventTrigger.dynVideoInputChannelID,r.forEach((t=>{delete t.notificationRecurrence}));e=new o.default.Builder({headless:!1,renderOpts:{pretty:!1}}).buildObject(i)}return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Event/triggers/VMD-1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async getOSDCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).VideoOverlay;return{xml:t.body,textOverlayListSize:Number(e.TextOverlayList?.[0]?.$?.size||0),dateTimeOverlay:e.DateTimeOverlay?.[0],channelNameOverlay:e.channelNameOverlay?.[0]}}async getOSD(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).VideoOverlay;return{xml:t.body,normalizedScreenWidth:Number(e.normalizedScreenSize?.[0]?.normalizedScreenWidth?.[0]||704),normalizedScreenHeight:Number(e.normalizedScreenSize?.[0]?.normalizedScreenHeight?.[0]||576),textOverlayList:e.TextOverlayList?.[0]?.TextOverlay||[],dateTimeOverlay:e.DateTimeOverlay?.[0],channelNameOverlay:e.channelNameOverlay?.[0]}}async updateOSD(t){const e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays`,responseType:"text",headers:{"Content-Type":"application/xml"}}),i=await o.default.parseStringPromise(e.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"}),r=i.VideoOverlay;if(t.dateTimeOverlay){const e=r.DateTimeOverlay?.[0];e&&(void 0!==t.dateTimeOverlay.enabled&&(e.enabled=[String(t.dateTimeOverlay.enabled)]),void 0!==t.dateTimeOverlay.dateStyle&&(e.dateStyle=[t.dateTimeOverlay.dateStyle]),void 0!==t.dateTimeOverlay.timeStyle&&(e.timeStyle=[t.dateTimeOverlay.timeStyle]),void 0!==t.dateTimeOverlay.displayWeek&&(e.displayWeek=[String(t.dateTimeOverlay.displayWeek)]),void 0!==t.dateTimeOverlay.positionX&&(e.positionX=[String(t.dateTimeOverlay.positionX)]),void 0!==t.dateTimeOverlay.positionY&&(e.positionY=[String(t.dateTimeOverlay.positionY)]))}if(t.channelNameOverlay){const e=r.channelNameOverlay?.[0];e&&(void 0!==t.channelNameOverlay.enabled&&(e.enabled=[String(t.channelNameOverlay.enabled)]),void 0!==t.channelNameOverlay.positionX&&(e.positionX=[String(t.channelNameOverlay.positionX)]),void 0!==t.channelNameOverlay.positionY&&(e.positionY=[String(t.channelNameOverlay.positionY)]))}if(t.textOverlays){const e=r.TextOverlayList?.[0]?.TextOverlay||[];for(const i of t.textOverlays){let t=e.find((t=>t.id?.[0]===i.id));t||(t={id:[i.id],enabled:["false"],positionX:["0"],positionY:["0"],displayText:[""],isPersistentText:["true"]},e.push(t)),void 0!==i.enabled&&(t.enabled=[String(i.enabled)]),void 0!==i.displayText&&(t.displayText=[i.displayText]),void 0!==i.positionX&&(t.positionX=[String(i.positionX)]),void 0!==i.positionY&&(t.positionY=[String(i.positionY)])}r.TextOverlayList?r.TextOverlayList[0].TextOverlay=e:r.TextOverlayList=[{$:{size:"8"},TextOverlay:e}]}delete r.$.version,delete r.$.xmlns;const n=new o.default.Builder({headless:!1,renderOpts:{pretty:!1}}).buildObject(i);return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays`,responseType:"text",headers:{"Content-Type":"application/xml"},body:n})}async getPTZCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).PTZChanelCap,i=(e.PresetNameCap?.[0]?.specialNo?.[0]?.$?.opt||"").split(",").map(Number);return{xml:t.body,maxPresetNum:Number(e.maxPresetNum?.[0]||0),specialNos:i}}async getPTZPresets(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets`,responseType:"text",headers:{"Content-Type":"application/xml"}});return(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).PTZPresetList.PTZPreset||[]}async updatePTZPreset(t,e){const i=`<?xml version="1.0" encoding="UTF-8"?>\n<PTZPreset xmlns="http://www.isapi.org/ver20/XMLSchema" version="2.0">\n    <id>${t}</id>\n    <presetName>${e}</presetName>\n</PTZPreset>`;return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets/${t}`,responseType:"text",headers:{"Content-Type":"application/xml"},body:i})}async deletePTZPreset(t){return await this.request({method:"DELETE",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets/${t}`,responseType:"text",headers:{"Content-Type":"application/xml"}})}async gotoPTZPreset(t){return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets/${t}/goto`,responseType:"text",headers:{"Content-Type":"application/xml"}})}async getDeviceInfo(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/deviceInfo`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).DeviceInfo||{};return{xml:t.body,deviceName:e.deviceName?.[0],model:e.model?.[0],serialNumber:e.serialNumber?.[0],macAddress:e.macAddress?.[0],firmwareVersion:e.firmwareVersion?.[0],firmwareReleasedDate:e.firmwareReleasedDate?.[0],deviceType:e.deviceType?.[0]}}async getVideoInputChannel(){const t=String(this.channel?.[0]??1),e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/${t}`,responseType:"text",headers:{"Content-Type":"application/xml"}}),i=await o.default.parseStringPromise(e.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"});return{xml:e.body,id:i.VideoInputChannel?.id?.[0],name:i.VideoInputChannel?.name?.[0],videoFormat:i.VideoInputChannel?.videoFormat?.[0]}}async updateVideoInputChannel(t){const{xml:e}=await this.getVideoInputChannel();let i=e;i=i.includes("<name>")?i.replace(/<name>.*?<\/name>/,`<name>${t}</name>`):i.replace("</VideoInputChannel>",`  <name>${t}</name>\n</VideoInputChannel>`);const r=String(this.channel?.[0]??1);return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/${r}`,responseType:"text",headers:{"Content-Type":"application/xml"},body:i})}async updateDeviceInfo(t){let{xml:e}=await this.getDeviceInfo();return e=e.includes("<deviceName>")?e.replace(/<deviceName>.*?<\/deviceName>/,`<deviceName>${t}</deviceName>`):e.replace("</DeviceInfo>",`  <deviceName>${t}</deviceName>\n</DeviceInfo>`),await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/deviceInfo`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async getSupplementLightCapabilities(){try{const t=String(this.channel?.[0]??1),e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Image/channels/${t}/SupplementLight/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),i=(await o.default.parseStringPromise(e.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).SupplementLight,r=i?.supplementLightMode?.[0],n=("object"==typeof r?r.$.opt:"").split(",").map((t=>t.trim())).filter(Boolean),s=[];n.includes("eventIntelligence")&&s.push("Smart"),n.includes("colorVuWhiteLight")&&s.push("White"),n.includes("irLight")&&s.push("IR");const a=0===s.length?"not-supported":1===s.length&&"White"===s[0]?"white-only":1===s.length&&"IR"===s[0]?"ir-only":"smart-hybrid",u=i?.irLightBrightness?.[0],p=i?.whiteLightBrightness?.[0],c="object"==typeof u?u.$.min:"0",l="object"==typeof u?u.$.max:"100",h="object"==typeof p?p.$.min:"0",d="object"==typeof p?p.$.max:"100",m=i?.mixedLightBrightnessRegulatMode?.[0],g="object"==typeof m?m.$.opt.split(","):["auto","manual"],f=i?.EventIntelligenceModeCfg?.[0],y=f?.brightnessRegulatMode?.[0];return{modes:s,cameraType:[a],irBrightnessMin:[c],irBrightnessMax:[l],whiteBrightnessMin:[h],whiteBrightnessMax:[d],brightnessControlOptions:g,smartBrightnessControlOptions:"object"==typeof y?y.$.opt.split(","):["auto","manual"]}}catch(t){if(403===t?.statusCode||t?.message?.includes("403"))return null;throw t}}async getSupplementLight(){try{const t=String(this.channel?.[0]??1),e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Image/channels/${t}/SupplementLight`,responseType:"text",headers:{"Content-Type":"application/xml"}}),i=(await o.default.parseStringPromise(e.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).SupplementLight,r=i?.EventIntelligenceModeCfg?.[0];return{supplementLightMode:i?.supplementLightMode||["close"],mixedLightBrightnessRegulatMode:i?.mixedLightBrightnessRegulatMode||["manual"],irLightBrightness:i?.irLightBrightness,whiteLightBrightness:i?.whiteLightBrightness,eventIntelligenceConfig:r?[{brightnessRegulatMode:r.brightnessRegulatMode||["manual"],whiteLightBrightness:r.whiteLightBrightness||["100"],irLightBrightness:r.irLightBrightness||["100"]}]:void 0}}catch(t){if(403===t?.statusCode||t?.message?.includes("403"))return null;throw t}}async updateSupplementLight(t){const e=String(this.channel?.[0]??1);let i=(await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Image/channels/${e}/SupplementLight`,responseType:"text",headers:{"Content-Type":"application/xml"}})).body;if(void 0!==t.supplementLightMode&&(i=i.replace(/<supplementLightMode[^>]*>.*?<\/supplementLightMode>/s,`<supplementLightMode>${t.supplementLightMode}</supplementLightMode>`)),void 0!==t.mixedLightBrightnessRegulatMode&&(i=i.replace(/<mixedLightBrightnessRegulatMode[^>]*>.*?<\/mixedLightBrightnessRegulatMode>/s,`<mixedLightBrightnessRegulatMode>${t.mixedLightBrightnessRegulatMode}</mixedLightBrightnessRegulatMode>`)),t.eventIntelligenceConfig){const e=t.eventIntelligenceConfig,r=i.match(/(<EventIntelligenceModeCfg[^>]*>)([\s\S]*?)(<\/EventIntelligenceModeCfg>)/);if(r){let t=r[2];void 0!==e.brightnessRegulatMode&&(t=t.replace(/<brightnessRegulatMode[^>]*>.*?<\/brightnessRegulatMode>/s,`<brightnessRegulatMode>${e.brightnessRegulatMode}</brightnessRegulatMode>`)),void 0!==e.whiteLightBrightness&&(t=t.replace(/<whiteLightBrightness[^>]*>\d+<\/whiteLightBrightness>/s,`<whiteLightBrightness>${e.whiteLightBrightness}</whiteLightBrightness>`)),void 0!==e.irLightBrightness&&(t=t.replace(/<irLightBrightness[^>]*>\d+<\/irLightBrightness>/s,`<irLightBrightness>${e.irLightBrightness}</irLightBrightness>`)),i=i.replace(/(<EventIntelligenceModeCfg[^>]*>)([\s\S]*?)(<\/EventIntelligenceModeCfg>)/,`$1${t}$3`)}}if(void 0!==t.irLightBrightness&&(i=i.replace(/(<SupplementLight[^>]*>[\s\S]*?)(<irLightBrightness[^>]*>)\d+(<\/irLightBrightness>)([\s\S]*?<EventIntelligenceModeCfg)/,`$1$2${t.irLightBrightness}$3$4`)),void 0!==t.whiteLightBrightness){const e=i;i=i.replace(/(<SupplementLight[^>]*>[\s\S]*?)(<whiteLightBrightness[^>]*>)\d+(<\/whiteLightBrightness>)([\s\S]*?<EventIntelligenceModeCfg)/,`$1$2${t.whiteLightBrightness}$3$4`),i===e&&(i=i.replace(/<whiteLightBrightness[^>]*>\d+<\/whiteLightBrightness>/,`<whiteLightBrightness>${t.whiteLightBrightness}</whiteLightBrightness>`))}await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Image/channels/${e}/SupplementLight`,responseType:"text",headers:{"Content-Type":"application/xml"},body:i})}async updateOverexposeSuppress(t){const e=String(this.channel?.[0]??1),i=`http://${this.ip}/ISAPI/Image/channels/${e}/exposure`,r=`<?xml version="1.0" encoding="UTF-8"?><Exposure><ExposureType>manual</ExposureType><OverexposeSuppress><enabled>${t?"true":"false"}</enabled></OverexposeSuppress></Exposure>`;try{const t=await this.request({method:"PUT",url:i,responseType:"text",headers:{"Content-Type":"application/xml"},body:r}),e=t?.statusCode??t?.status??"unknown";"number"==typeof e&&e>=400&&this.console.warn("[SmartSupplementLight] Non success HTTP status:",e)}catch(t){this.console.warn("[SmartSupplementLight] Failed to set OverexposeSuppress, ignoring.",t)}}async getAlarmCapabilities(){const t=(await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/IO/inputs`,responseType:"text",headers:{"Content-Type":"application/xml"}})).body;return{json:await o.default.parseStringPromise(t,{explicitArray:!1,mergeAttrs:!0}),xml:t}}async getAlarm(t){const e=(await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/IO/inputs/${t}`,responseType:"text",headers:{"Content-Type":"application/xml"}})).body;return{json:(await o.default.parseStringPromise(e,{explicitArray:!0})).IOInputPort,xml:e}}async setAlarm(t){const e=`<IOInputPort><id>1</id><enabled>true</enabled><triggering>${t?"low":"high"}</triggering></IOInputPort>`,i=(await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/IO/inputs/1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})).body;let r={};try{r=await o.default.parseStringPromise(i)}catch(t){console.error("Failed to parse XML response for setAlarm:",t)}return{json:r,xml:i}}async getAlarmLinkageCapabilities(){try{const t=(await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggersCap`,responseType:"text",headers:{"Content-Type":"application/xml"}})).body,e=await o.default.parseStringPromise(t,{explicitArray:!1}),i=e.EventTriggersCap?.IOTriggerCap||{};return{supportsBeep:"true"===i.isSupportBeep,supportsWhiteLight:"true"===i.isSupportWhiteLight,supportsIO:"true"===i.isSupportIO}}catch(t){return{supportsBeep:!1,supportsWhiteLight:!1,supportsIO:!1}}}async getAlarmLinkages(){const t=(await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/IO-1`,responseType:"text",headers:{"Content-Type":"application/xml"}})).body,e=await o.default.parseStringPromise(t,{explicitArray:!1}),i=e.EventTrigger?.EventTriggerNotificationList?.EventTriggerNotification||[],r=Array.isArray(i)?i:[i],n={beep:!1,whiteLight:!1,io:!1,whiteLightDuration:5};for(const t of r){const e=t.notificationMethod;if("beep"===e&&(n.beep=!0),"whiteLight"===e){n.whiteLight=!0;const e=t.WhiteLightAction?.whiteLightDurationTime;e&&(n.whiteLightDuration=parseInt(e,10)||5)}"IO"===e&&(n.io=!0)}return n}async setAlarmLinkages(t){const e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/IO-1`,responseType:"text",headers:{"Content-Type":"application/xml"}}),i=await o.default.parseStringPromise(e.body,{explicitArray:!0}),r=i.EventTrigger,n=r?.EventTriggerNotificationList?.[0]?.EventTriggerNotification||[],s=[];for(const t of n){const e=t.notificationMethod?.[0];["beep","whiteLight","IO"].includes(e)||s.push(t)}t.beep&&s.push({id:["beep"],notificationMethod:["beep"],notificationRecurrence:["beginning"]}),t.whiteLight&&s.push({id:["whiteLight"],notificationMethod:["whiteLight"],notificationRecurrence:["beginning"],WhiteLightAction:[{whiteLightDurationTime:[t.whiteLightDuration.toString()]}]}),t.io&&s.push({id:["IO-1"],notificationMethod:["IO"],notificationRecurrence:["beginning"],outputIOPortID:["1"]}),r.EventTriggerNotificationList||(r.EventTriggerNotificationList=[{}]),r.EventTriggerNotificationList[0].EventTriggerNotification=s;const a=new o.default.Builder({xmldec:{version:"1.0",encoding:"UTF-8"},renderOpts:{pretty:!0}}).buildObject(i);this.console.log("Generated XML:",a),await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Event/triggers/IO-1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:a}),this.console.log("setAlarmLinkages completed successfully")}async getAudioAlarmCapabilities(){try{const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/AudioAlarm/capabilities?format=json`,responseType:"json"}),e=t.body?.AudioAlarmCap;if(!e)return null;const i=e.AlertAudioTypeListCap||e.audioTypeListCap||[];return{supported:!0,audioTypes:i.map((t=>({id:t.alertAudioID||t.audioID,description:t.alertAudioDescription||t.audioDescription}))),volumeRange:{min:e.audioVolume?.["@min"]||1,max:e.audioVolume?.["@max"]||100},alarmTimesRange:{min:e.alarmTimes?.["@min"]||1,max:e.alarmTimes?.["@max"]||50}}}catch(t){return null}}async getAudioAlarmSettings(){try{const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/AudioAlarm?format=json`,responseType:"json"}),e=t.body?.AudioAlarm;return e?{audioID:e.alertAudioID||e.audioID||1,audioVolume:e.audioVolume||50,alarmTimes:e.alarmTimes||5}:null}catch(t){return null}}async setAudioAlarmSettings(t){const e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/AudioAlarm?format=json`,responseType:"json"}),i={AudioAlarm:{...e.body?.AudioAlarm||{},audioID:t.audioID,alertAudioID:t.audioID,audioVolume:t.audioVolume,alarmTimes:t.alarmTimes}};await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/AudioAlarm?format=json`,responseType:"json",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})}async getWhiteLightAlarmCapabilities(){try{const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/whiteLightAlarm/capabilities?format=json`,responseType:"json"}),e=t.body?.WhiteLightAlarmCap;if(!e)return null;const i=e.frequency?.["@opt"]||"high,medium,low,normallyOn";return{supported:!0,durationRange:{min:e.durationTime?.["@min"]||1,max:e.durationTime?.["@max"]||60},frequencyOptions:i.split(",")}}catch(t){return null}}async getWhiteLightAlarmSettings(){try{const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/whiteLightAlarm?format=json`,responseType:"json"}),e=t.body?.WhiteLightAlarm;return e?{durationTime:e.durationTime||15,frequency:e.frequency||"medium"}:null}catch(t){return null}}async setWhiteLightAlarmSettings(t){const e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/whiteLightAlarm?format=json`,responseType:"json"}),i={WhiteLightAlarm:{...e.body?.WhiteLightAlarm||{},durationTime:t.durationTime,frequency:t.frequency}};await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Event/triggers/notifications/whiteLightAlarm?format=json`,responseType:"json",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})}}},4043(t,e,i){!function(t){t.parser=function(t,e){return new n(t,e)},t.SAXParser=n,t.SAXStream=s,t.createStream=function(t,e){return new s(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function n(e,i){if(!(this instanceof n))return new n(e,i);var o=this;!function(t){for(var e=0,i=r.length;e<i;e++)t[r[e]]=""}(o),o.q=o.c="",o.bufferCheckPosition=t.MAX_BUFFER_LENGTH,o.opt=i||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!e,o.noscript=!(!e&&!o.opt.noscript),o.state=O.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(l)),void 0===o.opt.unquotedAttributeValues&&(o.opt.unquotedAttributeValues=!e),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),I(o,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}),n.prototype={end:function(){A(this)},write:function(e){var i=this;if(this.error)throw this.error;if(i.closed)return _(i,"Cannot write after close. Assign an onready handler.");if(null===e)return A(i);"object"==typeof e&&(e=e.toString());var n=0,o="";for(;o=V(e,n++),i.c=o,o;)switch(i.trackPosition&&(i.position++,"\n"===o?(i.line++,i.column=0):i.column++),i.state){case O.BEGIN:if(i.state=O.BEGIN_WHITESPACE,"\ufeff"===o)continue;B(i,o);continue;case O.BEGIN_WHITESPACE:B(i,o);continue;case O.TEXT:if(i.sawRoot&&!i.closedRoot){for(var s=n-1;o&&"<"!==o&&"&"!==o;)(o=V(e,n++))&&i.trackPosition&&(i.position++,"\n"===o?(i.line++,i.column=0):i.column++);i.textNode+=e.substring(s,n-1)}"<"!==o||i.sawRoot&&i.closedRoot&&!i.strict?(f(o)||i.sawRoot&&!i.closedRoot||N(i,"Text data outside of root node."),"&"===o?i.state=O.TEXT_ENTITY:i.textNode+=o):(i.state=O.OPEN_WAKA,i.startTagPosition=i.position);continue;case O.SCRIPT:"<"===o?i.state=O.SCRIPT_ENDING:i.script+=o;continue;case O.SCRIPT_ENDING:"/"===o?i.state=O.CLOSE_TAG:(i.script+="<"+o,i.state=O.SCRIPT);continue;case O.OPEN_WAKA:if("!"===o)i.state=O.SGML_DECL,i.sgmlDecl="";else if(f(o));else if(b(h,o))i.state=O.OPEN_TAG,i.tagName=o;else if("/"===o)i.state=O.CLOSE_TAG,i.tagName="";else if("?"===o)i.state=O.PROC_INST,i.procInstName=i.procInstBody="";else{if(N(i,"Unencoded <"),i.startTagPosition+1<i.position){var p=i.position-i.startTagPosition;o=new Array(p).join(" ")+o}i.textNode+="<"+o,i.state=O.TEXT}continue;case O.SGML_DECL:if(i.sgmlDecl+o==="--"){i.state=O.COMMENT,i.comment="",i.sgmlDecl="";continue}i.doctype&&!0!==i.doctype&&i.sgmlDecl?(i.state=O.DOCTYPE_DTD,i.doctype+="<!"+i.sgmlDecl+o,i.sgmlDecl=""):(i.sgmlDecl+o).toUpperCase()===a?(D(i,"onopencdata"),i.state=O.CDATA,i.sgmlDecl="",i.cdata=""):(i.sgmlDecl+o).toUpperCase()===u?(i.state=O.DOCTYPE,(i.doctype||i.sawRoot)&&N(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):">"===o?(D(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=O.TEXT):y(o)?(i.state=O.SGML_DECL_QUOTED,i.sgmlDecl+=o):i.sgmlDecl+=o;continue;case O.SGML_DECL_QUOTED:o===i.q&&(i.state=O.SGML_DECL,i.q=""),i.sgmlDecl+=o;continue;case O.DOCTYPE:">"===o?(i.state=O.TEXT,D(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=o,"["===o?i.state=O.DOCTYPE_DTD:y(o)&&(i.state=O.DOCTYPE_QUOTED,i.q=o));continue;case O.DOCTYPE_QUOTED:i.doctype+=o,o===i.q&&(i.q="",i.state=O.DOCTYPE);continue;case O.DOCTYPE_DTD:"]"===o?(i.doctype+=o,i.state=O.DOCTYPE):"<"===o?(i.state=O.OPEN_WAKA,i.startTagPosition=i.position):y(o)?(i.doctype+=o,i.state=O.DOCTYPE_DTD_QUOTED,i.q=o):i.doctype+=o;continue;case O.DOCTYPE_DTD_QUOTED:i.doctype+=o,o===i.q&&(i.state=O.DOCTYPE_DTD,i.q="");continue;case O.COMMENT:"-"===o?i.state=O.COMMENT_ENDING:i.comment+=o;continue;case O.COMMENT_ENDING:"-"===o?(i.state=O.COMMENT_ENDED,i.comment=E(i.opt,i.comment),i.comment&&D(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+o,i.state=O.COMMENT);continue;case O.COMMENT_ENDED:">"!==o?(N(i,"Malformed comment"),i.comment+="--"+o,i.state=O.COMMENT):i.doctype&&!0!==i.doctype?i.state=O.DOCTYPE_DTD:i.state=O.TEXT;continue;case O.CDATA:"]"===o?i.state=O.CDATA_ENDING:i.cdata+=o;continue;case O.CDATA_ENDING:"]"===o?i.state=O.CDATA_ENDING_2:(i.cdata+="]"+o,i.state=O.CDATA);continue;case O.CDATA_ENDING_2:">"===o?(i.cdata&&D(i,"oncdata",i.cdata),D(i,"onclosecdata"),i.cdata="",i.state=O.TEXT):"]"===o?i.cdata+="]":(i.cdata+="]]"+o,i.state=O.CDATA);continue;case O.PROC_INST:"?"===o?i.state=O.PROC_INST_ENDING:f(o)?i.state=O.PROC_INST_BODY:i.procInstName+=o;continue;case O.PROC_INST_BODY:if(!i.procInstBody&&f(o))continue;"?"===o?i.state=O.PROC_INST_ENDING:i.procInstBody+=o;continue;case O.PROC_INST_ENDING:">"===o?(D(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=O.TEXT):(i.procInstBody+="?"+o,i.state=O.PROC_INST_BODY);continue;case O.OPEN_TAG:b(d,o)?i.tagName+=o:(L(i),">"===o?k(i):"/"===o?i.state=O.OPEN_TAG_SLASH:(f(o)||N(i,"Invalid character in tag name"),i.state=O.ATTRIB));continue;case O.OPEN_TAG_SLASH:">"===o?(k(i,!0),F(i)):(N(i,"Forward-slash in opening tag not followed by >"),i.state=O.ATTRIB);continue;case O.ATTRIB:if(f(o))continue;">"===o?k(i):"/"===o?i.state=O.OPEN_TAG_SLASH:b(h,o)?(i.attribName=o,i.attribValue="",i.state=O.ATTRIB_NAME):N(i,"Invalid attribute name");continue;case O.ATTRIB_NAME:"="===o?i.state=O.ATTRIB_VALUE:">"===o?(N(i,"Attribute without value"),i.attribValue=i.attribName,R(i),k(i)):f(o)?i.state=O.ATTRIB_NAME_SAW_WHITE:b(d,o)?i.attribName+=o:N(i,"Invalid attribute name");continue;case O.ATTRIB_NAME_SAW_WHITE:if("="===o)i.state=O.ATTRIB_VALUE;else{if(f(o))continue;N(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",D(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",">"===o?k(i):b(h,o)?(i.attribName=o,i.state=O.ATTRIB_NAME):(N(i,"Invalid attribute name"),i.state=O.ATTRIB)}continue;case O.ATTRIB_VALUE:if(f(o))continue;y(o)?(i.q=o,i.state=O.ATTRIB_VALUE_QUOTED):(i.opt.unquotedAttributeValues||_(i,"Unquoted attribute value"),i.state=O.ATTRIB_VALUE_UNQUOTED,i.attribValue=o);continue;case O.ATTRIB_VALUE_QUOTED:if(o!==i.q){"&"===o?i.state=O.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=o;continue}R(i),i.q="",i.state=O.ATTRIB_VALUE_CLOSED;continue;case O.ATTRIB_VALUE_CLOSED:f(o)?i.state=O.ATTRIB:">"===o?k(i):"/"===o?i.state=O.OPEN_TAG_SLASH:b(h,o)?(N(i,"No whitespace between attributes"),i.attribName=o,i.attribValue="",i.state=O.ATTRIB_NAME):N(i,"Invalid attribute name");continue;case O.ATTRIB_VALUE_UNQUOTED:if(!v(o)){"&"===o?i.state=O.ATTRIB_VALUE_ENTITY_U:i.attribValue+=o;continue}R(i),">"===o?k(i):i.state=O.ATTRIB;continue;case O.CLOSE_TAG:if(i.tagName)">"===o?F(i):b(d,o)?i.tagName+=o:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=O.SCRIPT):(f(o)||N(i,"Invalid tagname in closing tag"),i.state=O.CLOSE_TAG_SAW_WHITE);else{if(f(o))continue;S(h,o)?i.script?(i.script+="</"+o,i.state=O.SCRIPT):N(i,"Invalid tagname in closing tag."):i.tagName=o}continue;case O.CLOSE_TAG_SAW_WHITE:if(f(o))continue;">"===o?F(i):N(i,"Invalid characters in closing tag");continue;case O.TEXT_ENTITY:case O.ATTRIB_VALUE_ENTITY_Q:case O.ATTRIB_VALUE_ENTITY_U:var c,l;switch(i.state){case O.TEXT_ENTITY:c=O.TEXT,l="textNode";break;case O.ATTRIB_VALUE_ENTITY_Q:c=O.ATTRIB_VALUE_QUOTED,l="attribValue";break;case O.ATTRIB_VALUE_ENTITY_U:c=O.ATTRIB_VALUE_UNQUOTED,l="attribValue"}if(";"===o){var T=j(i);i.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(T)?(i.entity="",i.state=c,i.write(T)):(i[l]+=T,i.entity="",i.state=c)}else b(i.entity.length?g:m,o)?i.entity+=o:(N(i,"Invalid character in entity name"),i[l]+="&"+i.entity+o,i.entity="",i.state=c);continue;default:throw new Error(i,"Unknown state: "+i.state)}i.position>=i.bufferCheckPosition&&function(e){for(var i=Math.max(t.MAX_BUFFER_LENGTH,10),n=0,o=0,s=r.length;o<s;o++){var a=e[r[o]].length;if(a>i)switch(r[o]){case"textNode":P(e);break;case"cdata":D(e,"oncdata",e.cdata),e.cdata="";break;case"script":D(e,"onscript",e.script),e.script="";break;default:_(e,"Max buffer length exceeded: "+r[o])}n=Math.max(n,a)}var u=t.MAX_BUFFER_LENGTH-n;e.bufferCheckPosition=u+e.position}(i);return i},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;P(t=this),""!==t.cdata&&(D(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(D(t,"onscript",t.script),t.script="")}};try{e=i(2203).Stream}catch(t){e=function(){}}e||(e=function(){});var o=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function s(t,i){if(!(this instanceof s))return new s(t,i);e.apply(this),this._parser=new n(t,i),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(t){r.emit("error",t),r._parser.error=null},this._decoder=null,o.forEach((function(t){Object.defineProperty(r,"on"+t,{get:function(){return r._parser["on"+t]},set:function(e){if(!e)return r.removeAllListeners(t),r._parser["on"+t]=e,e;r.on(t,e)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(e.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=i(3193).StringDecoder;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},s.prototype.on=function(t,i){var r=this;return r._parser["on"+t]||-1===o.indexOf(t)||(r._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),r.emit.apply(r,e)}),e.prototype.on.call(r,t,i)};var a="[CDATA[",u="DOCTYPE",p="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",l={xml:p,xmlns:c},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function f(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function y(t){return'"'===t||"'"===t}function v(t){return">"===t||f(t)}function b(t,e){return t.test(e)}function S(t,e){return!b(t,e)}var T,w,C,O=0;for(var x in t.STATE={BEGIN:O++,BEGIN_WHITESPACE:O++,TEXT:O++,TEXT_ENTITY:O++,OPEN_WAKA:O++,SGML_DECL:O++,SGML_DECL_QUOTED:O++,DOCTYPE:O++,DOCTYPE_QUOTED:O++,DOCTYPE_DTD:O++,DOCTYPE_DTD_QUOTED:O++,COMMENT_STARTING:O++,COMMENT:O++,COMMENT_ENDING:O++,COMMENT_ENDED:O++,CDATA:O++,CDATA_ENDING:O++,CDATA_ENDING_2:O++,PROC_INST:O++,PROC_INST_BODY:O++,PROC_INST_ENDING:O++,OPEN_TAG:O++,OPEN_TAG_SLASH:O++,ATTRIB:O++,ATTRIB_NAME:O++,ATTRIB_NAME_SAW_WHITE:O++,ATTRIB_VALUE:O++,ATTRIB_VALUE_QUOTED:O++,ATTRIB_VALUE_CLOSED:O++,ATTRIB_VALUE_UNQUOTED:O++,ATTRIB_VALUE_ENTITY_Q:O++,ATTRIB_VALUE_ENTITY_U:O++,CLOSE_TAG:O++,CLOSE_TAG_SAW_WHITE:O++,SCRIPT:O++,SCRIPT_ENDING:O++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var i=t.ENTITIES[e],r="number"==typeof i?String.fromCharCode(i):i;t.ENTITIES[e]=r})),t.STATE)t.STATE[t.STATE[x]]=x;function I(t,e,i){t[e]&&t[e](i)}function D(t,e,i){t.textNode&&P(t),I(t,e,i)}function P(t){t.textNode=E(t.opt,t.textNode),t.textNode&&I(t,"ontext",t.textNode),t.textNode=""}function E(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function _(t,e){return P(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,I(t,"onerror",e),t}function A(t){return t.sawRoot&&!t.closedRoot&&N(t,"Unclosed root tag"),t.state!==O.BEGIN&&t.state!==O.BEGIN_WHITESPACE&&t.state!==O.TEXT&&_(t,"Unexpected end"),P(t),t.c="",t.closed=!0,I(t,"onend"),n.call(t,t.strict,t.opt),t}function N(t,e){if("object"!=typeof t||!(t instanceof n))throw new Error("bad call to strictFail");t.strict&&_(t,e)}function L(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,i=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(i.ns=e.ns),t.attribList.length=0,D(t,"onopentagstart",i)}function M(t,e){var i=t.indexOf(":")<0?["",t]:t.split(":"),r=i[0],n=i[1];return e&&"xmlns"===t&&(r="xmlns",n=""),{prefix:r,local:n}}function R(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=M(t.attribName,!0),i=e.prefix,r=e.local;if("xmlns"===i)if("xml"===r&&t.attribValue!==p)N(t,"xml: prefix must be bound to "+p+"\nActual: "+t.attribValue);else if("xmlns"===r&&t.attribValue!==c)N(t,"xmlns: prefix must be bound to "+c+"\nActual: "+t.attribValue);else{var n=t.tag,o=t.tags[t.tags.length-1]||t;n.ns===o.ns&&(n.ns=Object.create(o.ns)),n.ns[r]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,D(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function k(t,e){if(t.opt.xmlns){var i=t.tag,r=M(t.tagName);i.prefix=r.prefix,i.local=r.local,i.uri=i.ns[r.prefix]||"",i.prefix&&!i.uri&&(N(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),i.uri=r.prefix);var n=t.tags[t.tags.length-1]||t;i.ns&&n.ns!==i.ns&&Object.keys(i.ns).forEach((function(e){D(t,"onopennamespace",{prefix:e,uri:i.ns[e]})}));for(var o=0,s=t.attribList.length;o<s;o++){var a=t.attribList[o],u=a[0],p=a[1],c=M(u,!0),l=c.prefix,h=c.local,d=""===l?"":i.ns[l]||"",m={name:u,value:p,prefix:l,local:h,uri:d};l&&"xmlns"!==l&&!d&&(N(t,"Unbound namespace prefix: "+JSON.stringify(l)),m.uri=l),t.tag.attributes[u]=m,D(t,"onattribute",m)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),D(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=O.TEXT:t.state=O.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function F(t){if(!t.tagName)return N(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=O.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=O.SCRIPT);D(t,"onscript",t.script),t.script=""}var e=t.tags.length,i=t.tagName;t.strict||(i=i[t.looseCase]());for(var r=i;e--;){if(t.tags[e].name===r)break;N(t,"Unexpected close tag")}if(e<0)return N(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=O.TEXT);t.tagName=i;for(var n=t.tags.length;n-- >e;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,D(t,"onclosetag",t.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];var u=t.tags[t.tags.length-1]||t;t.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach((function(e){var i=o.ns[e];D(t,"onclosenamespace",{prefix:e,uri:i})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=O.TEXT}function j(t){var e,i=t.entity,r=i.toLowerCase(),n="";return t.ENTITIES[i]?t.ENTITIES[i]:t.ENTITIES[r]?t.ENTITIES[r]:("#"===(i=r).charAt(0)&&("x"===i.charAt(1)?(i=i.slice(2),n=(e=parseInt(i,16)).toString(16)):(i=i.slice(1),n=(e=parseInt(i,10)).toString(10))),i=i.replace(/^0+/,""),isNaN(e)||n.toLowerCase()!==i?(N(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function B(t,e){"<"===e?(t.state=O.OPEN_WAKA,t.startTagPosition=t.position):f(e)||(N(t,"Non-whitespace before first tag."),t.textNode=e,t.state=O.TEXT)}function V(t,e){var i="";return e<t.length&&(i=t.charAt(e)),i}O=t.STATE,String.fromCodePoint||(T=String.fromCharCode,w=Math.floor,C=function(){var t,e,i=[],r=-1,n=arguments.length;if(!n)return"";for(var o="";++r<n;){var s=Number(arguments[r]);if(!isFinite(s)||s<0||s>1114111||w(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?i.push(s):(t=55296+((s-=65536)>>10),e=s%1024+56320,i.push(t,e)),(r+1===n||i.length>16384)&&(o+=T.apply(null,i),i.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C)}(e)},4111(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(468),e=i(1737),t.exports=function(t){function i(t,r,n,o,s,a){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==n)throw new Error("Missing DTD attribute name. "+this.debugInfo(r));if(!o)throw new Error("Missing DTD attribute type. "+this.debugInfo(r));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(r));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(r));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(r));this.elementName=this.stringify.name(r),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(n),this.attributeType=this.stringify.dtdAttType(o),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},4130(t,e,i){(function(){var e,r,n,o={}.hasOwnProperty;n=i(9241).isObject,r=i(468),e=i(1737),t.exports=function(t){function i(t,r,o,s){var a;i.__super__.constructor.call(this,t),n(r)&&(r=(a=r).version,o=a.encoding,s=a.standalone),r||(r="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(r),null!=o&&(this.encoding=this.stringify.xmlEncoding(o)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},4171(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getHttpFetchParser=p,e.httpFetchParseIncomingMessage=c,e.httpFetch=async function(t){const e=(0,r.createHeadersArray)(t.headers);(0,r.setDefaultHttpFetchAccept)(e,t.responseType);const{once:o}=i(4434),{PassThrough:s,Readable:a}=i(2203),{http:u,https:p}=i(1783),{url:l}=t,h=l.toString().startsWith("https:")?p:u;let d,m,{body:g}=t;if(g&&!(g instanceof a)){const t=new s;t.write(Buffer.from((0,r.createStringOrBufferBody)(e,g))),t.end(),g=t}t.timeout&&(d=new AbortController,m=setTimeout((()=>d.abort()),t.timeout),t.signal?.addEventListener("abort",(()=>d.abort(t.signal?.reason))));const f=d?.signal||t.signal;f?.addEventListener("abort",(()=>v.destroy(new Error(t.signal?.reason||"abort"))));const y={};for(const[t,i]of e)y[t]?y[t].push(i):y[t]=[i];const v=h.request(l,{method:(0,r.getFetchMethod)(t),rejectUnauthorized:t.rejectUnauthorized,family:t.family,headers:y,signal:f,timeout:t.timeout});g?g.pipe(v):v.end();try{const[e]=await o(v,"response");if(void 0===t?.checkStatusCode||t?.checkStatusCode)try{const i="function"==typeof t?.checkStatusCode?t.checkStatusCode:r.checkStatus;if(!e.statusCode||!i(e.statusCode))throw new Error(`http response statusCode ${e.statusCode}`)}catch(t){throw n(e).catch((()=>{})),t}const i=new Headers;for(const[t,r]of Object.entries(e.headers))for(const e of"string"==typeof r?[r]:r)i.append(t,e);return{statusCode:e.statusCode,headers:i,body:await c(e,t.responseType)}}finally{clearTimeout(m)}};const r=i(7796);async function n(t){const e=[];t.on("data",(t=>e.push(t)));const{once:r}=i(4434);return await r(t,"end"),Buffer.concat(e)}const o={parse:async t=>(await n(t)).toString()},s={parse:async t=>JSON.parse((await n(t)).toString())},a={parse:async t=>n(t)},u={parse:async t=>t};function p(t){switch(t){case"json":return s;case"text":return o;case"readable":return u}return a}function c(t,e){return p(e).parse(t)}},4192(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScryptedMimeTypes=e.ScryptedInterface=e.MediaPlayerState=e.SecuritySystemObstruction=e.SecuritySystemMode=e.AirQuality=e.AirPurifierMode=e.AirPurifierStatus=e.ChargeState=e.LockState=e.PanTiltZoomMovement=e.ThermostatMode=e.TemperatureUnit=e.FanMode=e.HumidityMode=e.ScryptedDeviceType=e.ScryptedInterfaceDescriptors=e.ScryptedInterfaceMethod=e.ScryptedInterfaceProperty=e.DeviceBase=e.TYPES_VERSION=void 0,e.TYPES_VERSION="0.5.51";var i,r,n,o,s,a,u,p,c,l,h,d,m,g,f,y,v,b;e.DeviceBase=class{},function(t){t.id="id",t.info="info",t.interfaces="interfaces",t.mixins="mixins",t.name="name",t.nativeId="nativeId",t.pluginId="pluginId",t.providedInterfaces="providedInterfaces",t.providedName="providedName",t.providedRoom="providedRoom",t.providedType="providedType",t.providerId="providerId",t.room="room",t.type="type",t.scryptedRuntimeArguments="scryptedRuntimeArguments",t.on="on",t.brightness="brightness",t.colorTemperature="colorTemperature",t.rgb="rgb",t.hsv="hsv",t.buttons="buttons",t.sensors="sensors",t.running="running",t.paused="paused",t.docked="docked",t.temperatureSetting="temperatureSetting",t.temperature="temperature",t.temperatureUnit="temperatureUnit",t.humidity="humidity",t.resolution="resolution",t.audioVolumes="audioVolumes",t.recordingActive="recordingActive",t.ptzCapabilities="ptzCapabilities",t.lockState="lockState",t.entryOpen="entryOpen",t.batteryLevel="batteryLevel",t.chargeState="chargeState",t.online="online",t.fromMimeType="fromMimeType",t.toMimeType="toMimeType",t.converters="converters",t.binaryState="binaryState",t.tampered="tampered",t.sleeping="sleeping",t.powerDetected="powerDetected",t.audioDetected="audioDetected",t.motionDetected="motionDetected",t.ambientLight="ambientLight",t.occupied="occupied",t.flooded="flooded",t.ultraviolet="ultraviolet",t.luminance="luminance",t.position="position",t.securitySystemState="securitySystemState",t.pm10Density="pm10Density",t.pm25Density="pm25Density",t.vocDensity="vocDensity",t.noxDensity="noxDensity",t.co2ppm="co2ppm",t.airQuality="airQuality",t.airPurifierState="airPurifierState",t.filterChangeIndication="filterChangeIndication",t.filterLifeLevel="filterLifeLevel",t.humiditySetting="humiditySetting",t.fan="fan",t.applicationInfo="applicationInfo",t.chatCompletionCapabilities="chatCompletionCapabilities",t.systemDevice="systemDevice"}(i||(e.ScryptedInterfaceProperty=i={})),function(t){t.listen="listen",t.probe="probe",t.setMixins="setMixins",t.setName="setName",t.setRoom="setRoom",t.setType="setType",t.getPluginJson="getPluginJson",t.turnOff="turnOff",t.turnOn="turnOn",t.setBrightness="setBrightness",t.getTemperatureMaxK="getTemperatureMaxK",t.getTemperatureMinK="getTemperatureMinK",t.setColorTemperature="setColorTemperature",t.setRgb="setRgb",t.setHsv="setHsv",t.pressButton="pressButton",t.sendNotification="sendNotification",t.start="start",t.stop="stop",t.pause="pause",t.resume="resume",t.dock="dock",t.setTemperature="setTemperature",t.setTemperatureUnit="setTemperatureUnit",t.getPictureOptions="getPictureOptions",t.takePicture="takePicture",t.getAudioStream="getAudioStream",t.setAudioVolumes="setAudioVolumes",t.startDisplay="startDisplay",t.stopDisplay="stopDisplay",t.getVideoStream="getVideoStream",t.getVideoStreamOptions="getVideoStreamOptions",t.getPrivacyMasks="getPrivacyMasks",t.setPrivacyMasks="setPrivacyMasks",t.getVideoTextOverlays="getVideoTextOverlays",t.setVideoTextOverlay="setVideoTextOverlay",t.getRecordingStream="getRecordingStream",t.getRecordingStreamCurrentTime="getRecordingStreamCurrentTime",t.getRecordingStreamOptions="getRecordingStreamOptions",t.getRecordingStreamThumbnail="getRecordingStreamThumbnail",t.deleteRecordingStream="deleteRecordingStream",t.setRecordingActive="setRecordingActive",t.ptzCommand="ptzCommand",t.getRecordedEvents="getRecordedEvents",t.getVideoClip="getVideoClip",t.getVideoClips="getVideoClips",t.getVideoClipThumbnail="getVideoClipThumbnail",t.removeVideoClips="removeVideoClips",t.setVideoStreamOptions="setVideoStreamOptions",t.startIntercom="startIntercom",t.stopIntercom="stopIntercom",t.lock="lock",t.unlock="unlock",t.addPassword="addPassword",t.getPasswords="getPasswords",t.removePassword="removePassword",t.activate="activate",t.deactivate="deactivate",t.isReversible="isReversible",t.closeEntry="closeEntry",t.openEntry="openEntry",t.getDevice="getDevice",t.releaseDevice="releaseDevice",t.adoptDevice="adoptDevice",t.discoverDevices="discoverDevices",t.createDevice="createDevice",t.getCreateDeviceSettings="getCreateDeviceSettings",t.reboot="reboot",t.getRefreshFrequency="getRefreshFrequency",t.refresh="refresh",t.getMediaStatus="getMediaStatus",t.load="load",t.seek="seek",t.skipNext="skipNext",t.skipPrevious="skipPrevious",t.convert="convert",t.convertMedia="convertMedia",t.getSettings="getSettings",t.putSetting="putSetting",t.armSecuritySystem="armSecuritySystem",t.disarmSecuritySystem="disarmSecuritySystem",t.setAirPurifierState="setAirPurifierState",t.getReadmeMarkdown="getReadmeMarkdown",t.getOauthUrl="getOauthUrl",t.onOauthCallback="onOauthCallback",t.canMixin="canMixin",t.getMixin="getMixin",t.releaseMixin="releaseMixin",t.onRequest="onRequest",t.onConnection="onConnection",t.onPush="onPush",t.run="run",t.eval="eval",t.loadScripts="loadScripts",t.saveScript="saveScript",t.forkInterface="forkInterface",t.getDetectionInput="getDetectionInput",t.getObjectTypes="getObjectTypes",t.detectObjects="detectObjects",t.generateObjectDetections="generateObjectDetections",t.getDetectionModel="getDetectionModel",t.setHumidity="setHumidity",t.setFan="setFan",t.startRTCSignalingSession="startRTCSignalingSession",t.createRTCSignalingSession="createRTCSignalingSession",t.getScryptedUserAccessControl="getScryptedUserAccessControl",t.generateVideoFrames="generateVideoFrames",t.connectStream="connectStream",t.getTTYSettings="getTTYSettings",t.getChatCompletion="getChatCompletion",t.streamChatCompletion="streamChatCompletion",t.getTextEmbedding="getTextEmbedding",t.getImageEmbedding="getImageEmbedding",t.callLLMTool="callLLMTool",t.getLLMTools="getLLMTools"}(r||(e.ScryptedInterfaceMethod=r={})),e.ScryptedInterfaceDescriptors={ScryptedDevice:{name:"ScryptedDevice",methods:["listen","probe","setMixins","setName","setRoom","setType"],properties:["id","info","interfaces","mixins","name","nativeId","pluginId","providedInterfaces","providedName","providedRoom","providedType","providerId","room","type"]},ScryptedPlugin:{name:"ScryptedPlugin",methods:["getPluginJson"],properties:[]},ScryptedPluginRuntime:{name:"ScryptedPluginRuntime",methods:[],properties:["scryptedRuntimeArguments"]},OnOff:{name:"OnOff",methods:["turnOff","turnOn"],properties:["on"]},Brightness:{name:"Brightness",methods:["setBrightness"],properties:["brightness"]},ColorSettingTemperature:{name:"ColorSettingTemperature",methods:["getTemperatureMaxK","getTemperatureMinK","setColorTemperature"],properties:["colorTemperature"]},ColorSettingRgb:{name:"ColorSettingRgb",methods:["setRgb"],properties:["rgb"]},ColorSettingHsv:{name:"ColorSettingHsv",methods:["setHsv"],properties:["hsv"]},Buttons:{name:"Buttons",methods:[],properties:["buttons"]},PressButtons:{name:"PressButtons",methods:["pressButton"],properties:[]},Sensors:{name:"Sensors",methods:[],properties:["sensors"]},Notifier:{name:"Notifier",methods:["sendNotification"],properties:[]},StartStop:{name:"StartStop",methods:["start","stop"],properties:["running"]},Pause:{name:"Pause",methods:["pause","resume"],properties:["paused"]},Dock:{name:"Dock",methods:["dock"],properties:["docked"]},TemperatureSetting:{name:"TemperatureSetting",methods:["setTemperature"],properties:["temperatureSetting"]},Thermometer:{name:"Thermometer",methods:["setTemperatureUnit"],properties:["temperature","temperatureUnit"]},HumiditySensor:{name:"HumiditySensor",methods:[],properties:["humidity"]},Camera:{name:"Camera",methods:["getPictureOptions","takePicture"],properties:[]},Resolution:{name:"Resolution",methods:[],properties:["resolution"]},Microphone:{name:"Microphone",methods:["getAudioStream"],properties:[]},AudioVolumeControl:{name:"AudioVolumeControl",methods:["setAudioVolumes"],properties:["audioVolumes"]},Display:{name:"Display",methods:["startDisplay","stopDisplay"],properties:[]},VideoCamera:{name:"VideoCamera",methods:["getVideoStream","getVideoStreamOptions"],properties:[]},VideoCameraMask:{name:"VideoCameraMask",methods:["getPrivacyMasks","setPrivacyMasks"],properties:[]},VideoTextOverlays:{name:"VideoTextOverlays",methods:["getVideoTextOverlays","setVideoTextOverlay"],properties:[]},VideoRecorder:{name:"VideoRecorder",methods:["getRecordingStream","getRecordingStreamCurrentTime","getRecordingStreamOptions","getRecordingStreamThumbnail"],properties:["recordingActive"]},VideoRecorderManagement:{name:"VideoRecorderManagement",methods:["deleteRecordingStream","setRecordingActive"],properties:[]},PanTiltZoom:{name:"PanTiltZoom",methods:["ptzCommand"],properties:["ptzCapabilities"]},EventRecorder:{name:"EventRecorder",methods:["getRecordedEvents"],properties:[]},VideoClips:{name:"VideoClips",methods:["getVideoClip","getVideoClips","getVideoClipThumbnail","removeVideoClips"],properties:[]},VideoCameraConfiguration:{name:"VideoCameraConfiguration",methods:["setVideoStreamOptions"],properties:[]},Intercom:{name:"Intercom",methods:["startIntercom","stopIntercom"],properties:[]},Lock:{name:"Lock",methods:["lock","unlock"],properties:["lockState"]},PasswordStore:{name:"PasswordStore",methods:["addPassword","getPasswords","removePassword"],properties:[]},Scene:{name:"Scene",methods:["activate","deactivate","isReversible"],properties:[]},Entry:{name:"Entry",methods:["closeEntry","openEntry"],properties:[]},EntrySensor:{name:"EntrySensor",methods:[],properties:["entryOpen"]},DeviceProvider:{name:"DeviceProvider",methods:["getDevice","releaseDevice"],properties:[]},DeviceDiscovery:{name:"DeviceDiscovery",methods:["adoptDevice","discoverDevices"],properties:[]},DeviceCreator:{name:"DeviceCreator",methods:["createDevice","getCreateDeviceSettings"],properties:[]},Battery:{name:"Battery",methods:[],properties:["batteryLevel"]},Charger:{name:"Charger",methods:[],properties:["chargeState"]},Reboot:{name:"Reboot",methods:["reboot"],properties:[]},Refresh:{name:"Refresh",methods:["getRefreshFrequency","refresh"],properties:[]},MediaPlayer:{name:"MediaPlayer",methods:["getMediaStatus","load","seek","skipNext","skipPrevious"],properties:[]},Online:{name:"Online",methods:[],properties:["online"]},BufferConverter:{name:"BufferConverter",methods:["convert"],properties:["fromMimeType","toMimeType"]},MediaConverter:{name:"MediaConverter",methods:["convertMedia"],properties:["converters"]},Settings:{name:"Settings",methods:["getSettings","putSetting"],properties:[]},BinarySensor:{name:"BinarySensor",methods:[],properties:["binaryState"]},TamperSensor:{name:"TamperSensor",methods:[],properties:["tampered"]},Sleep:{name:"Sleep",methods:[],properties:["sleeping"]},PowerSensor:{name:"PowerSensor",methods:[],properties:["powerDetected"]},AudioSensor:{name:"AudioSensor",methods:[],properties:["audioDetected"]},MotionSensor:{name:"MotionSensor",methods:[],properties:["motionDetected"]},AmbientLightSensor:{name:"AmbientLightSensor",methods:[],properties:["ambientLight"]},OccupancySensor:{name:"OccupancySensor",methods:[],properties:["occupied"]},FloodSensor:{name:"FloodSensor",methods:[],properties:["flooded"]},UltravioletSensor:{name:"UltravioletSensor",methods:[],properties:["ultraviolet"]},LuminanceSensor:{name:"LuminanceSensor",methods:[],properties:["luminance"]},PositionSensor:{name:"PositionSensor",methods:[],properties:["position"]},SecuritySystem:{name:"SecuritySystem",methods:["armSecuritySystem","disarmSecuritySystem"],properties:["securitySystemState"]},PM10Sensor:{name:"PM10Sensor",methods:[],properties:["pm10Density"]},PM25Sensor:{name:"PM25Sensor",methods:[],properties:["pm25Density"]},VOCSensor:{name:"VOCSensor",methods:[],properties:["vocDensity"]},NOXSensor:{name:"NOXSensor",methods:[],properties:["noxDensity"]},CO2Sensor:{name:"CO2Sensor",methods:[],properties:["co2ppm"]},AirQualitySensor:{name:"AirQualitySensor",methods:[],properties:["airQuality"]},AirPurifier:{name:"AirPurifier",methods:["setAirPurifierState"],properties:["airPurifierState"]},FilterMaintenance:{name:"FilterMaintenance",methods:[],properties:["filterChangeIndication","filterLifeLevel"]},Readme:{name:"Readme",methods:["getReadmeMarkdown"],properties:[]},OauthClient:{name:"OauthClient",methods:["getOauthUrl","onOauthCallback"],properties:[]},MixinProvider:{name:"MixinProvider",methods:["canMixin","getMixin","releaseMixin"],properties:[]},HttpRequestHandler:{name:"HttpRequestHandler",methods:["onRequest"],properties:[]},EngineIOHandler:{name:"EngineIOHandler",methods:["onConnection"],properties:[]},PushHandler:{name:"PushHandler",methods:["onPush"],properties:[]},Program:{name:"Program",methods:["run"],properties:[]},Scriptable:{name:"Scriptable",methods:["eval","loadScripts","saveScript"],properties:[]},ClusterForkInterface:{name:"ClusterForkInterface",methods:["forkInterface"],properties:[]},ObjectDetector:{name:"ObjectDetector",methods:["getDetectionInput","getObjectTypes"],properties:[]},ObjectDetection:{name:"ObjectDetection",methods:["detectObjects","generateObjectDetections","getDetectionModel"],properties:[]},ObjectDetectionPreview:{name:"ObjectDetectionPreview",methods:[],properties:[]},ObjectDetectionGenerator:{name:"ObjectDetectionGenerator",methods:[],properties:[]},HumiditySetting:{name:"HumiditySetting",methods:["setHumidity"],properties:["humiditySetting"]},Fan:{name:"Fan",methods:["setFan"],properties:["fan"]},RTCSignalingChannel:{name:"RTCSignalingChannel",methods:["startRTCSignalingSession"],properties:[]},RTCSignalingClient:{name:"RTCSignalingClient",methods:["createRTCSignalingSession"],properties:[]},LauncherApplication:{name:"LauncherApplication",methods:[],properties:["applicationInfo"]},ScryptedUser:{name:"ScryptedUser",methods:["getScryptedUserAccessControl"],properties:[]},VideoFrameGenerator:{name:"VideoFrameGenerator",methods:["generateVideoFrames"],properties:[]},StreamService:{name:"StreamService",methods:["connectStream"],properties:[]},TTY:{name:"TTY",methods:[],properties:[]},TTYSettings:{name:"TTYSettings",methods:["getTTYSettings"],properties:[]},ChatCompletion:{name:"ChatCompletion",methods:["getChatCompletion","streamChatCompletion"],properties:["chatCompletionCapabilities"]},TextEmbedding:{name:"TextEmbedding",methods:["getTextEmbedding"],properties:[]},ImageEmbedding:{name:"ImageEmbedding",methods:["getImageEmbedding"],properties:[]},LLMTools:{name:"LLMTools",methods:["callLLMTool","getLLMTools"],properties:[]},ScryptedSystemDevice:{name:"ScryptedSystemDevice",methods:[],properties:["systemDevice"]},ScryptedDeviceCreator:{name:"ScryptedDeviceCreator",methods:[],properties:[]},ScryptedSettings:{name:"ScryptedSettings",methods:[],properties:[]}},function(t){t.Builtin="Builtin",t.Internal="Internal",t.Camera="Camera",t.Fan="Fan",t.Light="Light",t.Switch="Switch",t.Outlet="Outlet",t.Sensor="Sensor",t.Scene="Scene",t.Program="Program",t.Automation="Automation",t.Vacuum="Vacuum",t.Notifier="Notifier",t.Thermostat="Thermostat",t.Lock="Lock",t.PasswordControl="PasswordControl",t.Display="Display",t.SmartDisplay="SmartDisplay",t.Speaker="Speaker",t.SmartSpeaker="SmartSpeaker",t.RemoteDesktop="RemoteDesktop",t.Event="Event",t.Entry="Entry",t.Garage="Garage",t.DeviceProvider="DeviceProvider",t.DataSource="DataSource",t.API="API",t.Buttons="Buttons",t.Doorbell="Doorbell",t.Irrigation="Irrigation",t.Valve="Valve",t.Person="Person",t.SecuritySystem="SecuritySystem",t.WindowCovering="WindowCovering",t.Siren="Siren",t.AirPurifier="AirPurifier",t.Internet="Internet",t.Network="Network",t.Bridge="Bridge",t.LLM="LLM",t.Unknown="Unknown"}(n||(e.ScryptedDeviceType=n={})),function(t){t.Humidify="Humidify",t.Dehumidify="Dehumidify",t.Auto="Auto",t.Off="Off"}(o||(e.HumidityMode=o={})),function(t){t.Auto="Auto",t.Manual="Manual"}(s||(e.FanMode=s={})),function(t){t.C="C",t.F="F"}(a||(e.TemperatureUnit=a={})),function(t){t.Off="Off",t.Cool="Cool",t.Heat="Heat",t.HeatCool="HeatCool",t.Auto="Auto",t.FanOnly="FanOnly",t.Purifier="Purifier",t.Eco="Eco",t.Dry="Dry",t.On="On"}(u||(e.ThermostatMode=u={})),function(t){t.Absolute="Absolute",t.Relative="Relative",t.Continuous="Continuous",t.Preset="Preset",t.Home="Home"}(p||(e.PanTiltZoomMovement=p={})),function(t){t.Locked="Locked",t.Unlocked="Unlocked",t.Jammed="Jammed"}(c||(e.LockState=c={})),function(t){t.Trickle="trickle",t.Charging="charging",t.NotCharging="not-charging"}(l||(e.ChargeState=l={})),function(t){t.Inactive="Inactive",t.Idle="Idle",t.Active="Active",t.ActiveNightMode="ActiveNightMode"}(h||(e.AirPurifierStatus=h={})),function(t){t.Manual="Manual",t.Automatic="Automatic"}(d||(e.AirPurifierMode=d={})),function(t){t.Unknown="Unknown",t.Excellent="Excellent",t.Good="Good",t.Fair="Fair",t.Inferior="Inferior",t.Poor="Poor"}(m||(e.AirQuality=m={})),function(t){t.Disarmed="Disarmed",t.HomeArmed="HomeArmed",t.AwayArmed="AwayArmed",t.NightArmed="NightArmed"}(g||(e.SecuritySystemMode=g={})),function(t){t.Sensor="Sensor",t.Occupied="Occupied",t.Time="Time",t.Error="Error"}(f||(e.SecuritySystemObstruction=f={})),function(t){t.Idle="Idle",t.Playing="Playing",t.Paused="Paused",t.Buffering="Buffering"}(y||(e.MediaPlayerState=y={})),function(t){t.ScryptedDevice="ScryptedDevice",t.ScryptedPlugin="ScryptedPlugin",t.ScryptedPluginRuntime="ScryptedPluginRuntime",t.OnOff="OnOff",t.Brightness="Brightness",t.ColorSettingTemperature="ColorSettingTemperature",t.ColorSettingRgb="ColorSettingRgb",t.ColorSettingHsv="ColorSettingHsv",t.Buttons="Buttons",t.PressButtons="PressButtons",t.Sensors="Sensors",t.Notifier="Notifier",t.StartStop="StartStop",t.Pause="Pause",t.Dock="Dock",t.TemperatureSetting="TemperatureSetting",t.Thermometer="Thermometer",t.HumiditySensor="HumiditySensor",t.Camera="Camera",t.Resolution="Resolution",t.Microphone="Microphone",t.AudioVolumeControl="AudioVolumeControl",t.Display="Display",t.VideoCamera="VideoCamera",t.VideoCameraMask="VideoCameraMask",t.VideoTextOverlays="VideoTextOverlays",t.VideoRecorder="VideoRecorder",t.VideoRecorderManagement="VideoRecorderManagement",t.PanTiltZoom="PanTiltZoom",t.EventRecorder="EventRecorder",t.VideoClips="VideoClips",t.VideoCameraConfiguration="VideoCameraConfiguration",t.Intercom="Intercom",t.Lock="Lock",t.PasswordStore="PasswordStore",t.Scene="Scene",t.Entry="Entry",t.EntrySensor="EntrySensor",t.DeviceProvider="DeviceProvider",t.DeviceDiscovery="DeviceDiscovery",t.DeviceCreator="DeviceCreator",t.Battery="Battery",t.Charger="Charger",t.Reboot="Reboot",t.Refresh="Refresh",t.MediaPlayer="MediaPlayer",t.Online="Online",t.BufferConverter="BufferConverter",t.MediaConverter="MediaConverter",t.Settings="Settings",t.BinarySensor="BinarySensor",t.TamperSensor="TamperSensor",t.Sleep="Sleep",t.PowerSensor="PowerSensor",t.AudioSensor="AudioSensor",t.MotionSensor="MotionSensor",t.AmbientLightSensor="AmbientLightSensor",t.OccupancySensor="OccupancySensor",t.FloodSensor="FloodSensor",t.UltravioletSensor="UltravioletSensor",t.LuminanceSensor="LuminanceSensor",t.PositionSensor="PositionSensor",t.SecuritySystem="SecuritySystem",t.PM10Sensor="PM10Sensor",t.PM25Sensor="PM25Sensor",t.VOCSensor="VOCSensor",t.NOXSensor="NOXSensor",t.CO2Sensor="CO2Sensor",t.AirQualitySensor="AirQualitySensor",t.AirPurifier="AirPurifier",t.FilterMaintenance="FilterMaintenance",t.Readme="Readme",t.OauthClient="OauthClient",t.MixinProvider="MixinProvider",t.HttpRequestHandler="HttpRequestHandler",t.EngineIOHandler="EngineIOHandler",t.PushHandler="PushHandler",t.Program="Program",t.Scriptable="Scriptable",t.ClusterForkInterface="ClusterForkInterface",t.ObjectDetector="ObjectDetector",t.ObjectDetection="ObjectDetection",t.ObjectDetectionPreview="ObjectDetectionPreview",t.ObjectDetectionGenerator="ObjectDetectionGenerator",t.HumiditySetting="HumiditySetting",t.Fan="Fan",t.RTCSignalingChannel="RTCSignalingChannel",t.RTCSignalingClient="RTCSignalingClient",t.LauncherApplication="LauncherApplication",t.ScryptedUser="ScryptedUser",t.VideoFrameGenerator="VideoFrameGenerator",t.StreamService="StreamService",t.TTY="TTY",t.TTYSettings="TTYSettings",t.ChatCompletion="ChatCompletion",t.TextEmbedding="TextEmbedding",t.ImageEmbedding="ImageEmbedding",t.LLMTools="LLMTools",t.ScryptedSystemDevice="ScryptedSystemDevice",t.ScryptedDeviceCreator="ScryptedDeviceCreator",t.ScryptedSettings="ScryptedSettings"}(v||(e.ScryptedInterface=v={})),function(t){t.Url="text/x-uri",t.InsecureLocalUrl="text/x-insecure-local-uri",t.LocalUrl="text/x-local-uri",t.ServerId="text/x-server-id",t.PushEndpoint="text/x-push-endpoint",t.SchemePrefix="x-scrypted/x-scrypted-scheme-",t.MediaStreamUrl="text/x-media-url",t.MediaObject="x-scrypted/x-scrypted-media-object",t.RequestMediaObject="x-scrypted/x-scrypted-request-media-object",t.RequestMediaStream="x-scrypted/x-scrypted-request-stream",t.MediaStreamFeedback="x-scrypted/x-media-stream-feedback",t.FFmpegInput="x-scrypted/x-ffmpeg-input",t.FFmpegTranscodeStream="x-scrypted/x-ffmpeg-transcode-stream",t.RTCSignalingChannel="x-scrypted/x-scrypted-rtc-signaling-channel",t.RTCSignalingSession="x-scrypted/x-scrypted-rtc-signaling-session",t.RTCConnectionManagement="x-scrypted/x-scrypted-rtc-connection-management",t.Image="x-scrypted/x-scrypted-image"}(b||(e.ScryptedMimeTypes=b={}))},4218(t){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},4238(t,e,i){(function(){var e;e=i(1737),i(468),t.exports=function(){function t(t,i,r){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==i)throw new Error("Missing attribute name. "+this.debugInfo(i));this.name=this.stringify.name(i),this.value=this.stringify.attValue(r),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},t.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},t.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&(t.prefix===this.prefix&&(t.localName===this.localName&&t.value===this.value))},t}()}).call(this)},4247(t){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach((function(t){i[++e]=t})),i}},4248(t){t.exports=function(t,e){for(var i=-1,r=null==t?0:t.length;++i<r;)if(e(t[i],i,t))return!0;return!1}},4335(t){t.exports=function(t,e){return function(i){return t(e(i))}}},4376(t,e,i){var r;t.exports=function(){if(!r){try{r=i(6556)("follow-redirects")}catch(t){}"function"!=typeof r&&(r=function(){})}r.apply(null,arguments)}},4394(t,e,i){var r=i(2552),n=i(346);t.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==r(t)}},4434(t){"use strict";t.exports=require("events")},4509(t,e,i){var r=i(2651);t.exports=function(t){return r(this,t).has(t)}},4528(t){t.exports=function(t,e){for(var i=-1,r=e.length,n=t.length;++i<r;)t[n+i]=e[i];return t}},4664(t,e,i){var r=i(9770),n=i(3345),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(t){return null==t?[]:(t=Object(t),r(s(t),(function(e){return o.call(t,e)})))}:n;t.exports=a},4739(t,e,i){var r=i(6025);t.exports=function(t){var e=this.__data__,i=r(e,t);return i<0?void 0:e[i][1]}},4797(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},4840(t){var e="object"==typeof global&&global&&global.Object===Object&&global;t.exports=e},4894(t,e,i){var r=i(1882),n=i(294);t.exports=function(t){return null!=t&&n(t.length)&&!r(t)}},4901(t,e,i){var r=i(2552),n=i(294),o=i(346),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&n(t.length)&&!!s[r(t)]}},4923(t){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},4932(t){t.exports=function(t,e){for(var i=-1,r=null==t?0:t.length,n=Array(r);++i<r;)n[i]=e(t[i],i,t);return n}},5083(t,e,i){var r=i(1882),n=i(7296),o=i(3805),s=i(7473),a=/^\[object .+?Constructor\]$/,u=Function.prototype,p=Object.prototype,c=u.toString,l=p.hasOwnProperty,h=RegExp("^"+c.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||n(t))&&(r(t)?h:a).test(s(t))}},5175(t,e,i){t.exports=function(t){function e(t){let i,n,o,s=null;function a(...t){if(!a.enabled)return;const r=a,n=Number(new Date),o=n-(i||n);r.diff=o,r.prev=i,r.curr=n,i=n,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((i,n)=>{if("%%"===i)return"%";s++;const o=e.formatters[n];if("function"==typeof o){const e=t[s];i=o.call(r,e),t.splice(s,1),s--}return i})),e.formatArgs.call(r,t);(r.log||e.log).apply(r,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=r,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(n!==e.namespaces&&(n=e.namespaces,o=e.enabled(t)),o),set:t=>{s=t}}),"function"==typeof e.init&&e.init(a),a}function r(t,i){const r=e(this.namespace+("undefined"==typeof i?":":i)+t);return r.log=this.log,r}function n(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},e.disable=function(){const t=[...e.names.map(n),...e.skips.map(n).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let i;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),n=r.length;for(i=0;i<n;i++)r[i]&&("-"===(t=r[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let i,r;for(i=0,r=e.skips.length;i<r;i++)if(e.skips[i].test(t))return!1;for(i=0,r=e.names.length;i<r;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(2726),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((i=>{e[i]=t[i]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let i=0;for(let e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return e.colors[Math.abs(i)%e.colors.length]},e.enable(e.load()),e}},5288(t){t.exports=function(t,e){return t===e||t!=t&&e!=e}},5336(t,e,i){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const i="color: "+this.color;e.splice(1,0,i,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(r++,"%c"===t&&(n=r))})),e.splice(n,0,i)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=i(5175)(e);const{formatters:r}=t.exports;r.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},5389(t,e,i){var r=i(3663),n=i(7978),o=i(3488),s=i(6449),a=i(583);t.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==typeof t?s(t)?n(t[0],t[1]):r(t):a(t)}},5481(t,e,i){var r=i(9325)["__core-js_shared__"];t.exports=r},5527(t){var e=Object.prototype;t.exports=function(t){var i=t&&t.constructor;return t===("function"==typeof i&&i.prototype||e)}},5529(t,e,i){(function(){var e,r,n,o={}.hasOwnProperty;n=i(9241).isObject,r=i(468),e=i(1737),t.exports=function(t){function i(t,r,o,s){if(i.__super__.constructor.call(this,t),null==o)throw new Error("Missing DTD entity name. "+this.debugInfo(o));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(o));if(this.pe=!!r,this.name=this.stringify.name(o),this.type=e.EntityDeclaration,n(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(o));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(o));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(o))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return null}}),i.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},5580(t,e,i){var r=i(6110)(i(9325),"DataView");t.exports=r},5660(t){(function(){t.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}).call(this)},5692(t){"use strict";t.exports=require("https")},5749(t,e,i){var r=i(1042);t.exports=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},5861(t,e,i){var r=i(5580),n=i(8223),o=i(2804),s=i(6545),a=i(8303),u=i(2552),p=i(7473),c="[object Map]",l="[object Promise]",h="[object Set]",d="[object WeakMap]",m="[object DataView]",g=p(r),f=p(n),y=p(o),v=p(s),b=p(a),S=u;(r&&S(new r(new ArrayBuffer(1)))!=m||n&&S(new n)!=c||o&&S(o.resolve())!=l||s&&S(new s)!=h||a&&S(new a)!=d)&&(S=function(t){var e=u(t),i="[object Object]"==e?t.constructor:void 0,r=i?p(i):"";if(r)switch(r){case g:return m;case f:return c;case y:return l;case v:return h;case b:return d}return e}),t.exports=S},5892(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createAuthFetch=function(t,e){return async o=>{const s=(0,r.getFetchMethod)(o),a=(0,r.createHeadersArray)(o.headers);o.headers=a,(0,r.setDefaultHttpFetchAccept)(a,o.responseType);const u=await n(o,o.url,s);u&&!(0,r.hasHeader)(a,"Authorization")&&(0,r.setHeader)(a,"Authorization",u);const p=new AbortController;o.signal?.addEventListener("abort",(()=>p.abort(o.signal?.reason)));const c=await t({...o,signal:p.signal,checkStatusCode(t){if(401===t&&o.credential)return!0;if(void 0===o?.checkStatusCode||o?.checkStatusCode){return("function"==typeof o?.checkStatusCode?o.checkStatusCode:r.checkStatus)(t)}return!0},responseType:"readable"});if(401!==c.statusCode)return{...c,body:await e(c.body,o.responseType)};let l=c.headers.get("www-authenticate");if(!l)throw new Error("Did not find WWW-Authenticate header.");"string"==typeof l&&(l=[l]);const{BASIC:h,DIGEST:d,parseWWWAuthenticateHeader:m}=await Promise.resolve().then(i.bind(i,841)),g=l.map((t=>m(t))),f=g.find((t=>"Digest"===t.type)),y=g.find((t=>"Basic"===t.type)),v=o.credential;if(v.digest=f,v.basic=y,!f&&!y)throw new Error(`Unknown WWW-Authenticate type: ${g[0]?.type}`);const b=await n(o,o.url,s);return b&&(0,r.setHeader)(a,"Authorization",b),t(o)}};const r=i(7796);async function n(t,e,r){if(!t.credential)return;const{BASIC:n,DIGEST:o,parseWWWAuthenticateHeader:s}=await Promise.resolve().then(i.bind(i,841)),a=t.credential,{digest:u,basic:p}=a;if(u){a.count||=0,++a.count;const n=("00000000"+a.count).slice(-8),o=[...Array(24)].map((()=>Math.floor(16*Math.random()).toString(16))).join(""),s=new URL(e),p=s.pathname+s.search,{DIGEST:c,buildAuthorizationHeader:l}=await Promise.resolve().then(i.bind(i,841)),h=c.computeHash({username:t.credential.username,password:t.credential.password,method:r,uri:p,nc:n,cnonce:o,algorithm:"MD5",qop:u.data.qop,...u.data});return l(c,{username:t.credential.username,uri:p,nc:n,cnonce:o,algorithm:u.data.algorithm,qop:u.data.qop,response:h,...u.data})}if(p){const{BASIC:e,buildAuthorizationHeader:r}=await Promise.resolve().then(i.bind(i,841));return r(e,{username:t.credential.username,password:t.credential.password})}}},5911(t,e,i){var r=i(8859),n=i(4248),o=i(9219);t.exports=function(t,e,i,s,a,u){var p=1&i,c=t.length,l=e.length;if(c!=l&&!(p&&l>c))return!1;var h=u.get(t),d=u.get(e);if(h&&d)return h==e&&d==t;var m=-1,g=!0,f=2&i?new r:void 0;for(u.set(t,e),u.set(e,t);++m<c;){var y=t[m],v=e[m];if(s)var b=p?s(v,y,m,e,t,u):s(y,v,m,t,e,u);if(void 0!==b){if(b)continue;g=!1;break}if(f){if(!n(e,(function(t,e){if(!o(f,e)&&(y===t||a(y,t,i,s,u)))return f.push(e)}))){g=!1;break}}else if(y!==v&&!a(y,v,i,s,u)){g=!1;break}}return u.delete(t),u.delete(e),g}},5915(t,e,i){(function(){var e,r,n={}.hasOwnProperty;e=i(1737),r=i(7457),t.exports=function(t){function i(t,r,n){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(r),this.name=this.target,n&&(this.value=this.stringify.insValue(n))}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.clone=function(){return Object.create(this)},i.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},i}(r)}).call(this)},5950(t,e,i){var r=i(695),n=i(8984),o=i(4894);t.exports=function(t){return o(t)?r(t):n(t)}},6009(t,e,i){t=i.nmd(t);var r=i(4840),n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,s=o&&o.exports===n&&r.process,a=function(){try{var t=o&&o.require&&o.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=a},6025(t,e,i){var r=i(5288);t.exports=function(t,e){for(var i=t.length;i--;)if(r(t[i][0],e))return i;return-1}},6110(t,e,i){var r=i(5083),n=i(392);t.exports=function(t,e){var i=n(t,e);return r(i)?i:void 0}},6117(t,e,i){"use strict";var r,n=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||(r=function(t){return r=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},r(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=r(t),s=0;s<i.length;s++)"default"!==i[s]&&n(e,t,i[s]);return o(e,t),e});Object.defineProperty(e,"__esModule",{value:!0}),e.StorageSettings=void 0;const a=s(i(7562)),{systemManager:u}=a.default;e.StorageSettings=class{constructor(t,e){this.device=t,this.settings=e,this.values={},this.hasValue={};for(const t of Object.keys(e)){const i=e[t],r=()=>this.getItem(t);let n;n="clippath"!==i.type?r:()=>{try{return JSON.parse(r())}catch(t){}},Object.defineProperty(this.values,t,{get:n,set:e=>this.putSetting(t,e),enumerable:!0}),Object.defineProperty(this.hasValue,t,{get:()=>null!=this.device.storage.getItem(t),enumerable:!0})}}get keys(){const t={};for(const e of Object.keys(this.settings))t[e]=e;return t}async getSettings(){const t=await(this.options?.onGet?.()),e=[];for(const[i,r]of Object.entries(this.settings)){let n=Object.assign({},r);t?.[i]&&(n=Object.assign(n,t[i])),n.onGet&&(n=Object.assign(n,await n.onGet())),n.hide||await(this.options?.hide?.[i]?.())||(n.key=i,n.value=this.getItemInternal(i,n,!0),"function"==typeof n.deviceFilter&&(n.deviceFilter=n.deviceFilter.toString()),e.push(n),delete n.onPut,delete n.onGet,delete n.mapPut,delete n.mapGet)}return e}async putSetting(t,e){const i=this.settings[t];let r;return i&&(r=this.getItemInternal(t,i)),this.putSettingInternal(i,r,t,e)}putSettingInternal(t,e,i,r){t?.noStore||(t?.mapPut&&(r=t.mapPut(e,r)),null==r?this.device.storage.removeItem(i):"object"==typeof r?this.device.storage.setItem(i,JSON.stringify(r)):this.device.storage.setItem(i,r?.toString())),t?.onPut?.(e,r),t?.hide||this.device.onDeviceEvent(a.ScryptedInterface.Settings,void 0)}getItemInternal(t,e,i){if(!e)return this.device.storage.getItem(t);const r=function(t,e,i,r){if(null==t)return i();const n=e.multiple?"array":e.type;if("boolean"===n)return"true"===t||"false"!==t&&(i()||!1);if("number"===n){const e=parseFloat(t);return isNaN(e)?i()||0:e}if("integer"===n){const e=parseInt(t);return isNaN(e)?i()||0:e}if("array"===n){if(!t)return i()||[];try{return JSON.parse(t)}catch(t){return i()||[]}}if("device"===n)return r?t:u.getDeviceById(t)||u.getDeviceById(i());if(t&&e.json)try{return JSON.parse(t)}catch(t){return i()}return t||i()}(this.device.storage.getItem(t),e,(()=>null!=e.persistedDefaultValue?(this.putSettingInternal(e,void 0,t,e.persistedDefaultValue),e.persistedDefaultValue):e.defaultValue),i);return e.mapGet?e.mapGet(r):r}getItem(t){return this.getItemInternal(t,this.settings[t])}}},6125(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.authHttpFetch=void 0;const r=i(4171),n=i(5892);e.authHttpFetch=(0,n.createAuthFetch)(r.httpFetch,r.httpFetchParseIncomingMessage)},6185(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.convertSettingsToStorageSettings=e.generateBitrateChoices=e.HIKVISION_UTILITIES_INTERFACE=void 0,e.formatFrameRate=function(t){if(t>=100)return String(t/100);return`1/${Math.round(100/t)}`},e.parseFrameRate=function(t){if(t.includes("/")){const[e,i]=t.split("/").map(Number);return Math.round(e/i*100)}return 100*Number(t)},e.formatKeyFrameInterval=function(t,e){const i=e/100;return Math.round(t/i)},e.parseKeyFrameInterval=function(t,e){const i=e/100;return Math.round(t*i)};const r=i(6117);e.HIKVISION_UTILITIES_INTERFACE="HIKVISION_UTILITIES";e.generateBitrateChoices=(t,e)=>{const i=[],r=[32,64,128,256,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,20480,24576,32768];for(const n of r)n>=t&&n<=e&&i.push(String(n));return i.includes(String(t))||i.unshift(String(t)),i.includes(String(e))||i.push(String(e)),i};e.convertSettingsToStorageSettings=async t=>{const{device:e,dynamicSettings:i,initStorage:n}=t,o={};Object.entries(n).forEach((([t,e])=>{e.onPut&&(o[t]=e.onPut)}));const s=await new r.StorageSettings(e,n).getSettings();s.push(...i);const a={};for(const t of s){const{value:i,key:r,onPut:n,...o}=t;a[r]={...o,value:"html"===o.type?i:void 0},t.onPut&&(a[r].onPut=t.onPut.bind(e))}const u=new r.StorageSettings(e,a);return Object.entries(o).forEach((([t,e])=>{u.settings[t].onPut=e})),u}},6286(t,e,i){(function(){var e,r,n,o={}.hasOwnProperty;n=i(9241).assign,e=i(1737),i(4130),i(6376),i(2691),i(2679),i(3906),i(1268),i(2535),i(5915),i(1218),i(4111),i(7696),i(5529),i(8012),r=i(8753),t.exports=function(){function t(t){var e,i,r;for(e in t||(t={}),this.options=t,i=t.writer||{})o.call(i,e)&&(r=i[e],this["_"+e]=this[e],this[e]=r)}return t.prototype.filterOptions=function(t){var e,i,o,s,a,u,p,c;return t||(t={}),t=n({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(i=t.indent)?i:"  ",e.newline=null!=(o=t.newline)?o:"\n",e.offset=null!=(s=t.offset)?s:0,e.dontPrettyTextNodes=null!=(a=null!=(u=t.dontPrettyTextNodes)?u:t.dontprettytextnodes)?a:0,e.spaceBeforeSlash=null!=(p=null!=(c=t.spaceBeforeSlash)?c:t.spacebeforeslash)?p:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=r.None,e},t.prototype.indent=function(t,e,i){var r;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(r=(i||0)+e.offset+1)>0?new Array(r).join(e.indent):""},t.prototype.endline=function(t,e,i){return!e.pretty||e.suppressPrettyCount?"":e.newline},t.prototype.attribute=function(t,e,i){var r;return this.openAttribute(t,e,i),r=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,i),r},t.prototype.cdata=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<![CDATA[",e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+="]]>"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.comment=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"\x3c!-- ",e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+=" --\x3e"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.declaration=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<?xml",e.state=r.InsideTag,n+=' version="'+t.version+'"',null!=t.encoding&&(n+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(n+=' standalone="'+t.standalone+'"'),e.state=r.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.docType=function(t,e,i){var n,o,s,a,u;if(i||(i=0),this.openNode(t,e,i),e.state=r.OpenTag,a=this.indent(t,e,i),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,e,i),e.state=r.InsideTag,o=0,s=(u=t.children).length;o<s;o++)n=u[o],a+=this.writeChildNode(n,e,i+1);e.state=r.CloseTag,a+="]"}return e.state=r.CloseTag,a+=e.spaceBeforeSlash+">",a+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),a},t.prototype.element=function(t,i,n){var s,a,u,p,c,l,h,d,m,g,f,y,v,b;for(m in n||(n=0),g=!1,f="",this.openNode(t,i,n),i.state=r.OpenTag,f+=this.indent(t,i,n)+"<"+t.name,y=t.attribs)o.call(y,m)&&(s=y[m],f+=this.attribute(s,i,n));if(p=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(f+=">",i.state=r.CloseTag,f+="</"+t.name+">"+this.endline(t,i,n)):(i.state=r.CloseTag,f+=i.spaceBeforeSlash+"/>"+this.endline(t,i,n));else if(!i.pretty||1!==u||p.type!==e.Text&&p.type!==e.Raw||null==p.value){if(i.dontPrettyTextNodes)for(c=0,h=(v=t.children).length;c<h;c++)if(((a=v[c]).type===e.Text||a.type===e.Raw)&&null!=a.value){i.suppressPrettyCount++,g=!0;break}for(f+=">"+this.endline(t,i,n),i.state=r.InsideTag,l=0,d=(b=t.children).length;l<d;l++)a=b[l],f+=this.writeChildNode(a,i,n+1);i.state=r.CloseTag,f+=this.indent(t,i,n)+"</"+t.name+">",g&&i.suppressPrettyCount--,f+=this.endline(t,i,n),i.state=r.None}else f+=">",i.state=r.InsideTag,i.suppressPrettyCount++,g=!0,f+=this.writeChildNode(p,i,n+1),i.suppressPrettyCount--,g=!1,i.state=r.CloseTag,f+="</"+t.name+">"+this.endline(t,i,n);return this.closeNode(t,i,n),f},t.prototype.writeChildNode=function(t,i,r){switch(t.type){case e.CData:return this.cdata(t,i,r);case e.Comment:return this.comment(t,i,r);case e.Element:return this.element(t,i,r);case e.Raw:return this.raw(t,i,r);case e.Text:return this.text(t,i,r);case e.ProcessingInstruction:return this.processingInstruction(t,i,r);case e.Dummy:return"";case e.Declaration:return this.declaration(t,i,r);case e.DocType:return this.docType(t,i,r);case e.AttributeDeclaration:return this.dtdAttList(t,i,r);case e.ElementDeclaration:return this.dtdElement(t,i,r);case e.EntityDeclaration:return this.dtdEntity(t,i,r);case e.NotationDeclaration:return this.dtdNotation(t,i,r);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},t.prototype.processingInstruction=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<?",e.state=r.InsideTag,n+=t.target,t.value&&(n+=" "+t.value),e.state=r.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.raw=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i),e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.text=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i),e.state=r.InsideTag,n+=t.value,e.state=r.CloseTag,n+=this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdAttList=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!ATTLIST",e.state=r.InsideTag,n+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(n+=" "+t.defaultValueType),t.defaultValue&&(n+=' "'+t.defaultValue+'"'),e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdElement=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!ELEMENT",e.state=r.InsideTag,n+=" "+t.name+" "+t.value,e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdEntity=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!ENTITY",e.state=r.InsideTag,t.pe&&(n+=" %"),n+=" "+t.name,t.value?n+=' "'+t.value+'"':(t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.nData&&(n+=" NDATA "+t.nData)),e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.dtdNotation=function(t,e,i){var n;return this.openNode(t,e,i),e.state=r.OpenTag,n=this.indent(t,e,i)+"<!NOTATION",e.state=r.InsideTag,n+=" "+t.name,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?n+=' PUBLIC "'+t.pubID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),e.state=r.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,i),e.state=r.None,this.closeNode(t,e,i),n},t.prototype.openNode=function(t,e,i){},t.prototype.closeNode=function(t,e,i){},t.prototype.openAttribute=function(t,e,i){},t.prototype.closeAttribute=function(t,e,i){},t}()}).call(this)},6376(t,e,i){(function(){var e,r,n,o,s,a,u,p,c={}.hasOwnProperty;p=i(9241).isObject,u=i(468),e=i(1737),r=i(4111),o=i(5529),n=i(7696),s=i(8012),a=i(4797),t.exports=function(t){function i(t,r,n){var o,s,a,u,c,l;if(i.__super__.constructor.call(this,t),this.type=e.DocType,t.children)for(s=0,a=(u=t.children).length;s<a;s++)if((o=u[s]).type===e.Element){this.name=o.name;break}this.documentObject=t,p(r)&&(r=(c=r).pubID,n=c.sysID),null==n&&(n=(l=[r,n])[0],r=l[1]),null!=r&&(this.pubID=this.stringify.dtdPubID(r)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}return function(t,e){for(var i in e)c.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"entities",{get:function(){var t,i,r,n,o;for(n={},i=0,r=(o=this.children).length;i<r;i++)(t=o[i]).type!==e.EntityDeclaration||t.pe||(n[t.name]=t);return new a(n)}}),Object.defineProperty(i.prototype,"notations",{get:function(){var t,i,r,n,o;for(n={},i=0,r=(o=this.children).length;i<r;i++)(t=o[i]).type===e.NotationDeclaration&&(n[t.name]=t);return new a(n)}}),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),i.prototype.element=function(t,e){var i;return i=new n(this,t,e),this.children.push(i),this},i.prototype.attList=function(t,e,i,n,o){var s;return s=new r(this,t,e,i,n,o),this.children.push(s),this},i.prototype.entity=function(t,e){var i;return i=new o(this,!1,t,e),this.children.push(i),this},i.prototype.pEntity=function(t,e){var i;return i=new o(this,!0,t,e),this.children.push(i),this},i.prototype.notation=function(t,e){var i;return i=new s(this,t,e),this.children.push(i),this},i.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},i.prototype.ele=function(t,e){return this.element(t,e)},i.prototype.att=function(t,e,i,r,n){return this.attList(t,e,i,r,n)},i.prototype.ent=function(t,e){return this.entity(t,e)},i.prototype.pent=function(t,e){return this.pEntity(t,e)},i.prototype.not=function(t,e){return this.notation(t,e)},i.prototype.up=function(){return this.root()||this.documentObject},i.prototype.isEqualNode=function(t){return!!i.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&(t.name===this.name&&(t.publicId===this.publicId&&t.systemId===this.systemId))},i}(u)}).call(this)},6449(t){var e=Array.isArray;t.exports=e},6465(t,e){(function(){e.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},6545(t,e,i){var r=i(6110)(i(9325),"Set");t.exports=r},6556(t,e,i){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?t.exports=i(5336):t.exports=i(3482)},6649(t,e,i){var r=i(3221)();t.exports=r},6684(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}).call(this)},6712(t,e,i){(function(){"use strict";var t,r,n,o,s,a={}.hasOwnProperty;t=i(9665),r=i(6465).defaults,o=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},s=function(t){return"<![CDATA["+n(t)+"]]>"},n=function(t){return t.replace("]]>","]]]]><![CDATA[>")},e.Builder=function(){function e(t){var e,i,n;for(e in this.options={},i=r[.2])a.call(i,e)&&(n=i[e],this.options[e]=n);for(e in t)a.call(t,e)&&(n=t[e],this.options[e]=n)}return e.prototype.buildObject=function(e){var i,n,u,p,c,l;return i=this.options.attrkey,n=this.options.charkey,1===Object.keys(e).length&&this.options.rootName===r[.2].rootName?e=e[c=Object.keys(e)[0]]:c=this.options.rootName,l=this,u=function(t,e){var r,p,c,h,d,m;if("object"!=typeof e)l.options.cdata&&o(e)?t.raw(s(e)):t.txt(e);else if(Array.isArray(e)){for(h in e)if(a.call(e,h))for(d in p=e[h])c=p[d],t=u(t.ele(d),c).up()}else for(d in e)if(a.call(e,d))if(p=e[d],d===i){if("object"==typeof p)for(r in p)m=p[r],t=t.att(r,m)}else if(d===n)t=l.options.cdata&&o(p)?t.raw(s(p)):t.txt(p);else if(Array.isArray(p))for(h in p)a.call(p,h)&&(t="string"==typeof(c=p[h])?l.options.cdata&&o(c)?t.ele(d).raw(s(c)).up():t.ele(d,c).up():u(t.ele(d),c).up());else"object"==typeof p?t=u(t.ele(d),p).up():"string"==typeof p&&l.options.cdata&&o(p)?t=t.ele(d).raw(s(p)).up():(null==p&&(p=""),t=t.ele(d,p.toString()).up());return t},p=t.create(c,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),u(p,e).end(this.options.renderOpts)},e}()}).call(this)},6721(t,e,i){var r=i(1042),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return n.call(e,t)?e[t]:void 0}},6775(t,e,i){(function(){var e,r,n,o={}.hasOwnProperty;e=i(1737),n=i(6286),r=i(8753),t.exports=function(t){function i(t,e){this.stream=t,i.__super__.constructor.call(this,e)}return function(t,e){for(var i in e)o.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.endline=function(t,e,n){return t.isLastRootNode&&e.state===r.CloseTag?"":i.__super__.endline.call(this,t,e,n)},i.prototype.document=function(t,e){var i,r,n,o,s,a,u,p,c;for(r=n=0,s=(u=t.children).length;n<s;r=++n)(i=u[r]).isLastRootNode=r===t.children.length-1;for(e=this.filterOptions(e),c=[],o=0,a=(p=t.children).length;o<a;o++)i=p[o],c.push(this.writeChildNode(i,e,0));return c},i.prototype.attribute=function(t,e,r){return this.stream.write(i.__super__.attribute.call(this,t,e,r))},i.prototype.cdata=function(t,e,r){return this.stream.write(i.__super__.cdata.call(this,t,e,r))},i.prototype.comment=function(t,e,r){return this.stream.write(i.__super__.comment.call(this,t,e,r))},i.prototype.declaration=function(t,e,r){return this.stream.write(i.__super__.declaration.call(this,t,e,r))},i.prototype.docType=function(t,e,i){var n,o,s,a;if(i||(i=0),this.openNode(t,e,i),e.state=r.OpenTag,this.stream.write(this.indent(t,e,i)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,i)),e.state=r.InsideTag,o=0,s=(a=t.children).length;o<s;o++)n=a[o],this.writeChildNode(n,e,i+1);e.state=r.CloseTag,this.stream.write("]")}return e.state=r.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,i)),e.state=r.None,this.closeNode(t,e,i)},i.prototype.element=function(t,i,n){var s,a,u,p,c,l,h,d,m;for(h in n||(n=0),this.openNode(t,i,n),i.state=r.OpenTag,this.stream.write(this.indent(t,i,n)+"<"+t.name),d=t.attribs)o.call(d,h)&&(s=d[h],this.attribute(s,i,n));if(p=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))i.allowEmpty?(this.stream.write(">"),i.state=r.CloseTag,this.stream.write("</"+t.name+">")):(i.state=r.CloseTag,this.stream.write(i.spaceBeforeSlash+"/>"));else if(!i.pretty||1!==u||p.type!==e.Text&&p.type!==e.Raw||null==p.value){for(this.stream.write(">"+this.endline(t,i,n)),i.state=r.InsideTag,c=0,l=(m=t.children).length;c<l;c++)a=m[c],this.writeChildNode(a,i,n+1);i.state=r.CloseTag,this.stream.write(this.indent(t,i,n)+"</"+t.name+">")}else this.stream.write(">"),i.state=r.InsideTag,i.suppressPrettyCount++,this.writeChildNode(p,i,n+1),i.suppressPrettyCount--,i.state=r.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,i,n)),i.state=r.None,this.closeNode(t,i,n)},i.prototype.processingInstruction=function(t,e,r){return this.stream.write(i.__super__.processingInstruction.call(this,t,e,r))},i.prototype.raw=function(t,e,r){return this.stream.write(i.__super__.raw.call(this,t,e,r))},i.prototype.text=function(t,e,r){return this.stream.write(i.__super__.text.call(this,t,e,r))},i.prototype.dtdAttList=function(t,e,r){return this.stream.write(i.__super__.dtdAttList.call(this,t,e,r))},i.prototype.dtdElement=function(t,e,r){return this.stream.write(i.__super__.dtdElement.call(this,t,e,r))},i.prototype.dtdEntity=function(t,e,r){return this.stream.write(i.__super__.dtdEntity.call(this,t,e,r))},i.prototype.dtdNotation=function(t,e,r){return this.stream.write(i.__super__.dtdNotation.call(this,t,e,r))},i}(n)}).call(this)},7016(t){"use strict";t.exports=require("url")},7068(t,e,i){var r=i(7217),n=i(5911),o=i(1986),s=i(689),a=i(5861),u=i(6449),p=i(3656),c=i(7167),l="[object Arguments]",h="[object Array]",d="[object Object]",m=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,g,f,y){var v=u(t),b=u(e),S=v?h:a(t),T=b?h:a(e),w=(S=S==l?d:S)==d,C=(T=T==l?d:T)==d,O=S==T;if(O&&p(t)){if(!p(e))return!1;v=!0,w=!1}if(O&&!w)return y||(y=new r),v||c(t)?n(t,e,i,g,f,y):o(t,e,S,i,g,f,y);if(!(1&i)){var x=w&&m.call(t,"__wrapped__"),I=C&&m.call(e,"__wrapped__");if(x||I){var D=x?t.value():t,P=I?e.value():e;return y||(y=new r),f(D,P,i,g,y)}}return!!O&&(y||(y=new r),s(t,e,i,g,f,y))}},7167(t,e,i){var r=i(4901),n=i(7301),o=i(6009),s=o&&o.isTypedArray,a=s?n(s):r;t.exports=a},7197(t){t.exports=function(t,e){return function(i){return null!=i&&(i[t]===e&&(void 0!==e||t in Object(i)))}}},7217(t,e,i){var r=i(79),n=i(1420),o=i(938),s=i(3605),a=i(9817),u=i(945);function p(t){var e=this.__data__=new r(t);this.size=e.size}p.prototype.clear=n,p.prototype.delete=o,p.prototype.get=s,p.prototype.has=a,p.prototype.set=u,t.exports=p},7237(t){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},7255(t,e,i){var r=i(7422);t.exports=function(t){return function(e){return r(e,t)}}},7260(t){(function(){t.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,i){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},7296(t,e,i){var r,n=i(5481),o=(r=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},7301(t){t.exports=function(t){return function(e){return t(e)}}},7422(t,e,i){var r=i(1769),n=i(7797);t.exports=function(t,e){for(var i=0,o=(e=r(e,t)).length;null!=t&&i<o;)t=t[n(e[i++])];return i&&i==o?t:void 0}},7457(t,e,i){(function(){var e,r={}.hasOwnProperty;e=i(468),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t),this.value=""}return function(t,e){for(var i in e)r.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceData=function(t,e,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(t){return!!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},e}(e)}).call(this)},7473(t){var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},7534(t,e,i){var r=i(2552),n=i(346);t.exports=function(t){return n(t)&&"[object Arguments]"==r(t)}},7556(t,e,i){var r=i(1873),n=i(4932),o=i(6449),s=i(4394),a=r?r.prototype:void 0,u=a?a.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return n(e,t)+"";if(s(e))return u?u.call(e):"";var i=e+"";return"0"==i&&1/e==-1/0?"-0":i}},7562(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,r,n)}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||r(e,t,i)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.sdk=e.MixinDeviceBase=e.ScryptedDeviceBase=void 0,n(i(4192),e);const s=o(i(9896)),a=i(4192);i(3339);class u extends a.DeviceBase{constructor(t){super(),this.nativeId=t}get storage(){return this._storage||(this._storage=e.sdk.deviceManager.getDeviceStorage(this.nativeId)),this._storage}get log(){return this._log||(this._log=e.sdk.deviceManager.getDeviceLogger(this.nativeId)),this._log}get console(){return this._console||(this._console=e.sdk.deviceManager.getDeviceConsole(this.nativeId)),this._console}async createMediaObject(t,i){return e.sdk.mediaManager.createMediaObject(t,i,{sourceId:this.id})}getMediaObjectConsole(t){return"string"!=typeof t.sourceId?this.console:e.sdk.deviceManager.getMixinConsole(t.sourceId,this.nativeId)}_lazyLoadDeviceState(){this._deviceState||(this.nativeId?this._deviceState=e.sdk.deviceManager.getDeviceState(this.nativeId):this._deviceState=e.sdk.deviceManager.getDeviceState())}onDeviceEvent(t,i){return e.sdk.deviceManager.onDeviceEvent(this.nativeId,t,i)}}e.ScryptedDeviceBase=u;class p extends a.DeviceBase{constructor(t){super(),this._listeners=new Set,this.mixinDevice=t.mixinDevice,this.mixinDeviceInterfaces=t.mixinDeviceInterfaces,this.mixinStorageSuffix=t.mixinStorageSuffix,this._deviceState=t.mixinDeviceState,this.nativeId=e.sdk.systemManager.getDeviceById(this.id).nativeId,this.mixinProviderNativeId=t.mixinProviderNativeId,this._deviceState.__rpcproxy_traps_all_properties&&"string"==typeof this._deviceState.id&&(this._deviceState=e.sdk.deviceManager.createDeviceState(this._deviceState.id,this._deviceState.setState))}get storage(){if(!this._storage){const t=this.mixinStorageSuffix,i=this.id+(t?":"+t:"");this._storage=e.sdk.deviceManager.getMixinStorage(i,this.mixinProviderNativeId)}return this._storage}get console(){return this._console||(e.sdk.deviceManager.getMixinConsole?this._console=e.sdk.deviceManager.getMixinConsole(this.id,this.mixinProviderNativeId):this._console=e.sdk.deviceManager.getDeviceConsole(this.mixinProviderNativeId)),this._console}async createMediaObject(t,i){return e.sdk.mediaManager.createMediaObject(t,i,{sourceId:this.id})}getMediaObjectConsole(t){return"string"!=typeof t.sourceId?this.console:e.sdk.deviceManager.getMixinConsole(t.sourceId,this.mixinProviderNativeId)}onDeviceEvent(t,i){return e.sdk.deviceManager.onMixinEvent(this.id,this,t,i)}_lazyLoadDeviceState(){}manageListener(t){this._listeners.add(t)}release(){for(const t of this._listeners)t.removeListener()}}e.MixinDeviceBase=p,function(){function t(t){return function(){return this._lazyLoadDeviceState(),this._deviceState?.[t]}}function e(t){return function(e){this._lazyLoadDeviceState(),this._deviceState?this._deviceState[t]=e:console.warn("device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.")}}for(const i of Object.values(a.ScryptedInterfaceProperty))i!==a.ScryptedInterfaceProperty.nativeId&&(Object.defineProperty(u.prototype,i,{set:e(i),get:t(i)}),Object.defineProperty(p.prototype,i,{set:e(i),get:t(i)}))}(),e.sdk={};try{let t=!1;try{process.env.SCRYPTED_SDK_ES_MODULE||process.env.SCRYPTED_SDK_MODULE;const r=process.env.SCRYPTED_SDK_CJS_MODULE||process.env.SCRYPTED_SDK_MODULE;if(r)if("undefined"!=typeof require){const i=require(process.env.SCRYPTED_SDK_MODULE);Object.assign(e.sdk,i.getScryptedStatic()),t=!0}else{const n=i(3891)(r);Object.assign(e.sdk,n.getScryptedStatic()),t=!0}}catch(t){throw console.warn("failed to load sdk module",t),t}if(!t){let t;try{t=pluginRuntimeAPI}catch(t){}Object.assign(e.sdk,{log:deviceManager.getDeviceLogger(void 0),deviceManager,endpointManager,mediaManager,systemManager,pluginHostAPI,...t})}try{let t={...a.ScryptedInterfaceDescriptors};try{const e=JSON.parse(s.default.readFileSync("../sdk.json").toString()).interfaceDescriptors;e&&(t={...t,...e})}catch(t){console.warn("failed to load custom interface descriptors",t)}e.sdk.systemManager.setScryptedInterfaceDescriptors?.(a.TYPES_VERSION,t)?.catch((()=>{}))}catch(t){}}catch(t){console.error("sdk initialization error, import @scrypted/types or use @scrypted/client instead",t)}e.default=e.sdk},7670(t,e,i){var r=i(2651);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},7696(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(468),e=i(1737),t.exports=function(t){function i(t,r,n){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing DTD element name. "+this.debugInfo());n||(n="(#PCDATA)"),Array.isArray(n)&&(n="("+n.join(",")+")"),this.name=this.stringify.name(r),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(n)}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),i.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},7796(t,e){"use strict";function i(t){return t>=200&&t<=299}function r(t){if(!i(t))throw new Error(`http response statusCode ${t}`);return!0}function n(t){return t.method||(t.body?"POST":"GET")}function o(t){switch(t){case"json":return"application/json";case"text":return"text/plain"}}function s(t,e){return e=e.toLowerCase(),t.find((([t])=>t.toLowerCase()===e))}function a(t,e){e=e.toLowerCase();const i=t.filter((([t,i])=>t.toLowerCase()!==e));t.length=0,i.forEach((e=>t.push(e)))}function u(t,e,i){a(t,e),t.push([e,i])}function p(t,e){if(s(t,"Accept"))return;const i=o(e);i&&u(t,"Accept",i)}function c(t){const e=[];if(!t)return e;if(t instanceof Headers){for(const[i,r]of t.entries())e.push([i,r]);return e}if(t instanceof Array){for(const[i,r]of t)e.push([i,r]);return e}for(const i of Object.keys(t)){const r=t[i];e.push([i,r])}return e}function l(t,e){let i;return"object"==typeof e?(e=JSON.stringify(e),i="application/json"):"string"==typeof e&&(i="text/plain"),i&&!s(t,"Content-Type")&&u(t,"Content-Type",i),s(t,"Content-Length")||u(t,"Content-Length",(e=Buffer.from(e)).length.toString()),e}async function h(t,e){switch(e){case"json":return t.json();case"text":return t.text();case"readable":return t}return new Uint8Array(await t.arrayBuffer())}Object.defineProperty(e,"__esModule",{value:!0}),e.fetchStatusCodeOk=i,e.checkStatus=r,e.getFetchMethod=n,e.getHttpFetchAccept=o,e.hasHeader=s,e.removeHeader=a,e.setHeader=u,e.setDefaultHttpFetchAccept=p,e.createHeadersArray=c,e.createStringOrBufferBody=l,e.domFetchParseIncomingMessage=h,e.domFetch=async function(t){const e=c(t.headers);p(e,t.responseType);let i,o,{body:s}=t;!s||s instanceof ReadableStream||(s=l(e,s));t.timeout&&(i=new AbortController,o=setTimeout((()=>i.abort()),t.timeout),t.signal?.addEventListener("abort",(()=>i.abort(t.signal?.reason))));try{const{url:o}=t,a=await fetch(o,{method:n(t),credentials:t.withCredentials?"include":void 0,headers:e,signal:i?.signal||t.signal,body:s});if(void 0===t?.checkStatusCode||t?.checkStatusCode)try{if(!("function"==typeof t?.checkStatusCode?t.checkStatusCode:r)(a.status))throw new Error(`http response statusCode ${a.status}`)}catch(t){throw a.arrayBuffer().catch((()=>{})),t}return{statusCode:a.status,headers:a.headers,body:await h(a,t.responseType)}}finally{clearTimeout(o)}}},7797(t,e,i){var r=i(4394);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},7828(t,e,i){var r=i(9325).Uint8Array;t.exports=r},7927(t,e,i){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=i(7562),o=i(6117),s=r(i(2112)),a=i(6185);class u extends n.ScryptedDeviceBase{constructor(t){super(t),this.storageSettings=new o.StorageSettings(this,{}),this.mixinsMap={},this.init().catch(this.console.log)}async init(){}async getSettings(){return await this.storageSettings.getSettings()}putSetting(t,e){return this.storageSettings.putSetting(t,e)}async canMixin(t,e){return[n.ScryptedInterface.Camera,n.ScryptedInterface.VideoCamera].some((t=>e.includes(t)))?[a.HIKVISION_UTILITIES_INTERFACE,n.ScryptedInterface.Settings]:void 0}async getMixin(t,e,i){return new s.default({mixinDevice:t,mixinDeviceInterfaces:e,mixinDeviceState:i,mixinProviderNativeId:this.nativeId,group:"Hikvision utilities",groupKey:"hikvisionUtilities"},this)}async releaseMixin(t,e){await e.release()}}e.default=u},7978(t,e,i){var r=i(270),n=i(8156),o=i(631),s=i(8586),a=i(756),u=i(7197),p=i(7797);t.exports=function(t,e){return s(t)&&a(e)?u(p(t),e):function(i){var s=n(i,t);return void 0===s&&s===e?o(i,t):r(e,s,3)}}},8012(t,e,i){(function(){var e,r,n={}.hasOwnProperty;r=i(468),e=i(1737),t.exports=function(t){function i(t,r,n){if(i.__super__.constructor.call(this,t),null==r)throw new Error("Missing DTD notation name. "+this.debugInfo(r));if(!n.pubID&&!n.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(r));this.name=this.stringify.name(r),this.type=e.NotationDeclaration,null!=n.pubID&&(this.pubID=this.stringify.dtdPubID(n.pubID)),null!=n.sysID&&(this.sysID=this.stringify.dtdSysID(n.sysID))}return function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(i,t),Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),i.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},i}(r)}).call(this)},8077(t){t.exports=function(t,e){return null!=t&&e in Object(t)}},8096(t){t.exports=function(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}},8156(t,e,i){var r=i(7422);t.exports=function(t,e,i){var n=null==t?void 0:r(t,e);return void 0===n?i:n}},8223(t,e,i){var r=i(6110)(i(9325),"Map");t.exports=r},8303(t,e,i){var r=i(6110)(i(9325),"WeakMap");t.exports=r},8329(t,e,i){var r=i(4894);t.exports=function(t,e){return function(i,n){if(null==i)return i;if(!r(i))return t(i,n);for(var o=i.length,s=e?o:-1,a=Object(i);(e?s--:++s<o)&&!1!==n(a[s],s,a););return i}}},8586(t,e,i){var r=i(6449),n=i(4394),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!n(t))||(s.test(t)||!o.test(t)||null!=e&&t in Object(e))}},8611(t){"use strict";t.exports=require("http")},8655(t,e,i){var r=i(6025);t.exports=function(t){return r(this.__data__,t)>-1}},8753(t){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},8805(t,e,i){(function(){"use strict";var t,r,n,o,s={}.hasOwnProperty;r=i(6465),t=i(6712),n=i(1912),o=i(2114),e.defaults=r.defaults,e.processors=o,e.ValidationError=function(){function t(t){this.message=t}return function(t,e){for(var i in e)s.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(t,Error),t}(),e.Builder=t.Builder,e.Parser=n.Parser,e.parseString=n.parseString,e.parseStringPromise=n.parseStringPromise}).call(this)},8859(t,e,i){var r=i(3661),n=i(1380),o=i(1459);function s(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new r;++e<i;)this.add(t[e])}s.prototype.add=s.prototype.push=n,s.prototype.has=o,t.exports=s},8970(t,e,i){var r=i(3360),n=i(2e3)((function(t,e,i){r(t,i,e)}));t.exports=n},8984(t,e,i){var r=i(5527),n=i(3650),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return n(t);var e=[];for(var i in Object(t))o.call(t,i)&&"constructor"!=i&&e.push(i);return e}},9023(t){"use strict";t.exports=require("util")},9219(t){t.exports=function(t,e){return t.has(e)}},9241(t){(function(){var e,i,r,n,o,s,a,u=[].slice,p={}.hasOwnProperty;e=function(){var t,e,i,r,n,s;if(s=arguments[0],n=2<=arguments.length?u.call(arguments,1):[],o(Object.assign))Object.assign.apply(null,arguments);else for(t=0,i=n.length;t<i;t++)if(null!=(r=n[t]))for(e in r)p.call(r,e)&&(s[e]=r[e]);return s},o=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},s=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},r=function(t){return o(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},n=function(t){var e;if(r(t))return!t.length;for(e in t)if(p.call(t,e))return!1;return!0},a=function(t){var e,i;return s(t)&&(i=Object.getPrototypeOf(t))&&(e=i.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},i=function(t){return o(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=o,t.exports.isObject=s,t.exports.isArray=r,t.exports.isEmpty=n,t.exports.isPlainObject=a,t.exports.getValue=i}).call(this)},9325(t,e,i){var r=i(4840),n="object"==typeof self&&self&&self.Object===Object&&self,o=r||n||Function("return this")();t.exports=o},9326(t,e,i){var r=i(1769),n=i(2428),o=i(6449),s=i(361),a=i(294),u=i(7797);t.exports=function(t,e,i){for(var p=-1,c=(e=r(e,t)).length,l=!1;++p<c;){var h=u(e[p]);if(!(l=null!=t&&i(t,h)))break;t=t[h]}return l||++p!=c?l:!!(c=null==t?0:t.length)&&a(c)&&s(h,c)&&(o(t)||n(t))}},9350(t){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},9665(t,e,i){(function(){var e,r,n,o,s,a,u,p,c,l;l=i(9241),p=l.assign,c=l.isFunction,n=i(7260),o=i(1933),s=i(400),u=i(382),a=i(6775),e=i(1737),r=i(8753),t.exports.create=function(t,e,i,r){var n,s;if(null==t)throw new Error("Root element needs a name.");return r=p({},e,i,r),s=(n=new o(r)).element(t),r.headless||(n.declaration(r),null==r.pubID&&null==r.sysID||n.dtd(r)),s},t.exports.begin=function(t,e,i){var r;return c(t)&&(e=(r=[t,e])[0],i=r[1],t={}),e?new s(t,e,i):new o(t)},t.exports.stringWriter=function(t){return new u(t)},t.exports.streamWriter=function(t,e){return new a(t,e)},t.exports.implementation=new n,t.exports.nodeType=e,t.exports.writerState=r}).call(this)},9770(t){t.exports=function(t,e){for(var i=-1,r=null==t?0:t.length,n=0,o=[];++i<r;){var s=t[i];e(s,i,t)&&(o[n++]=s)}return o}},9817(t){t.exports=function(t){return this.__data__.has(t)}},9896(t){"use strict";t.exports=require("fs")},9935(t){t.exports=function(){return!1}}},e={};function i(r){var n=e[r];if(void 0!==n)return n.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var r=i(7927),n=exports="undefined"==typeof exports?{}:exports;for(var o in r)n[o]=r[o];r.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();
//# sourceMappingURL=main.nodejs.js.map