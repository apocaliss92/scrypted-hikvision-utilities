/*! For license information please see main.nodejs.js.LICENSE.txt */
(()=>{var t={7562:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||i(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.sdk=e.MixinDeviceBase=e.ScryptedDeviceBase=void 0,n(r(4192),e);const o=r(4192),s=r(3339);class a extends o.DeviceBase{constructor(t){super(),this.nativeId=t}get storage(){return this._storage||(this._storage=e.sdk.deviceManager.getDeviceStorage(this.nativeId)),this._storage}get log(){return this._log||(this._log=e.sdk.deviceManager.getDeviceLogger(this.nativeId)),this._log}get console(){return this._console||(this._console=e.sdk.deviceManager.getDeviceConsole(this.nativeId)),this._console}async createMediaObject(t,r){return e.sdk.mediaManager.createMediaObject(t,r,{sourceId:this.id})}getMediaObjectConsole(t){return"string"!=typeof t.sourceId?this.console:e.sdk.deviceManager.getMixinConsole(t.sourceId,this.nativeId)}_lazyLoadDeviceState(){this._deviceState||(this.nativeId?this._deviceState=e.sdk.deviceManager.getDeviceState(this.nativeId):this._deviceState=e.sdk.deviceManager.getDeviceState())}onDeviceEvent(t,r){return e.sdk.deviceManager.onDeviceEvent(this.nativeId,t,r)}}e.ScryptedDeviceBase=a;class u extends o.DeviceBase{constructor(t){super(),this._listeners=new Set,this.mixinDevice=t.mixinDevice,this.mixinDeviceInterfaces=t.mixinDeviceInterfaces,this.mixinStorageSuffix=t.mixinStorageSuffix,this._deviceState=t.mixinDeviceState,this.nativeId=e.sdk.systemManager.getDeviceById(this.id).nativeId,this.mixinProviderNativeId=t.mixinProviderNativeId,this._deviceState.__rpcproxy_traps_all_properties&&"string"==typeof this._deviceState.id&&(this._deviceState=e.sdk.deviceManager.createDeviceState(this._deviceState.id,this._deviceState.setState))}get storage(){if(!this._storage){const t=this.mixinStorageSuffix,r=this.id+(t?":"+t:"");this._storage=e.sdk.deviceManager.getMixinStorage(r,this.mixinProviderNativeId)}return this._storage}get console(){return this._console||(e.sdk.deviceManager.getMixinConsole?this._console=e.sdk.deviceManager.getMixinConsole(this.id,this.mixinProviderNativeId):this._console=e.sdk.deviceManager.getDeviceConsole(this.mixinProviderNativeId)),this._console}async createMediaObject(t,r){return e.sdk.mediaManager.createMediaObject(t,r,{sourceId:this.id})}getMediaObjectConsole(t){return"string"!=typeof t.sourceId?this.console:e.sdk.deviceManager.getMixinConsole(t.sourceId,this.mixinProviderNativeId)}onDeviceEvent(t,r){return e.sdk.deviceManager.onMixinEvent(this.id,this,t,r)}_lazyLoadDeviceState(){}manageListener(t){this._listeners.add(t)}release(){for(const t of this._listeners)t.removeListener()}}e.MixinDeviceBase=u,function(){function t(t){return function(){return this._lazyLoadDeviceState(),this._deviceState?.[t]}}function e(t){return function(e){this._lazyLoadDeviceState(),this._deviceState?this._deviceState[t]=e:console.warn("device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.")}}for(const r of Object.values(o.ScryptedInterfaceProperty))r!==o.ScryptedInterfaceProperty.nativeId&&(Object.defineProperty(a.prototype,r,{set:e(r),get:t(r)}),Object.defineProperty(u.prototype,r,{set:e(r),get:t(r)}))}(),e.sdk={};try{let t=!1;if(process.env.SCRYPTED_SDK_MODULE)try{{const r=(0,s.createRequire)("file:///Users/gianlucaruocco/Documents/Git/scrypted-hikvision-utilities/node_modules/@scrypted/sdk/dist/src/index.js")(process.env.SCRYPTED_SDK_MODULE);Object.assign(e.sdk,r.getScryptedStatic()),t=!0}}catch(t){console.warn("failed to load sdk module",t)}if(!t){let t;try{t=pluginRuntimeAPI}catch(t){}Object.assign(e.sdk,{log:deviceManager.getDeviceLogger(void 0),deviceManager,endpointManager,mediaManager,systemManager,pluginHostAPI,...t})}try{systemManager.setScryptedInterfaceDescriptors?.(o.TYPES_VERSION,o.ScryptedInterfaceDescriptors)?.catch((()=>{}))}catch(t){}}catch(t){console.error("sdk initialization error, import @scrypted/types or use @scrypted/client instead",t)}e.default=e.sdk},2673:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.SettingsMixinDeviceBase=void 0;const s=o(r(7562)),{deviceManager:a}=s.default;class u extends s.MixinDeviceBase{constructor(t){super(t),this.settingsGroup=t.group,this.settingsGroupKey=t.groupKey,process.nextTick((()=>a.onMixinEvent(this.id,this,s.ScryptedInterface.Settings,null)))}async getSettings(){const t=this.mixinDeviceInterfaces.includes(s.ScryptedInterface.Settings)?this.mixinDevice.getSettings():void 0,e=this.getMixinSettings(),r=[];try{const e=await t||[];r.push(...e)}catch(t){const e=this.name,i=`${e} Extension settings failed to load.`;this.console.error(i,t),r.push({key:Math.random().toString(),title:e,value:"Settings Error",group:"Errors",description:i,readonly:!0})}try{const t=await e||[];for(const e of t)e.group=e.group||this.settingsGroup,e.key=this.settingsGroupKey+":"+e.key;r.push(...t)}catch(t){const e=a.getDeviceState(this.mixinProviderNativeId).name,i=`${e} Extension settings failed to load.`;this.console.error(i,t),r.push({key:Math.random().toString(),title:e,value:"Settings Error",group:"Errors",description:i,readonly:!0})}return r}async putSetting(t,e){const r=this.settingsGroupKey+":";if(!t?.startsWith(r))return this.mixinDevice.putSetting(t,e);await this.putMixinSetting(t.substring(r.length),e)||a.onMixinEvent(this.id,this,s.ScryptedInterface.Settings,null)}async release(){await a.onMixinEvent(this.id,this,s.ScryptedInterface.Settings,null)}}e.SettingsMixinDeviceBase=u},6117:function(t,e,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){void 0===i&&(i=r),t[i]=e[r]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.StorageSettings=void 0;const s=o(r(7562)),{systemManager:a}=s.default;e.StorageSettings=class{constructor(t,e){this.device=t,this.settings=e,this.values={},this.hasValue={};for(const t of Object.keys(e)){const r=e[t],i=()=>this.getItem(t);let n;n="clippath"!==r.type?i:()=>{try{return JSON.parse(i())}catch(t){}},Object.defineProperty(this.values,t,{get:n,set:e=>this.putSetting(t,e),enumerable:!0}),Object.defineProperty(this.hasValue,t,{get:()=>null!=this.device.storage.getItem(t),enumerable:!0})}}get keys(){const t={};for(const e of Object.keys(this.settings))t[e]=e;return t}async getSettings(){const t=await(this.options?.onGet?.()),e=[];for(const[r,i]of Object.entries(this.settings)){let n=Object.assign({},i);t?.[r]&&(n=Object.assign(n,t[r])),n.onGet&&(n=Object.assign(n,await n.onGet())),n.hide||await(this.options?.hide?.[r]?.())||(n.key=r,n.value=this.getItemInternal(r,n,!0),e.push(n),delete n.onPut,delete n.onGet,delete n.mapPut,delete n.mapGet)}return e}async putSetting(t,e){const r=this.settings[t];let i;return r&&(i=this.getItemInternal(t,r)),this.putSettingInternal(r,i,t,e)}putSettingInternal(t,e,r,i){t?.noStore||(t?.mapPut&&(i=t.mapPut(e,i)),null==i?this.device.storage.removeItem(r):"object"==typeof i?this.device.storage.setItem(r,JSON.stringify(i)):this.device.storage.setItem(r,i?.toString())),t?.onPut?.(e,i),t?.hide||this.device.onDeviceEvent(s.ScryptedInterface.Settings,void 0)}getItemInternal(t,e,r){if(!e)return this.device.storage.getItem(t);const i=function(t,e,r,i){if(null==t)return r();const n=e.multiple?"array":e.type;if("boolean"===n)return"true"===t||"false"!==t&&(r()||!1);if("number"===n){const e=parseFloat(t);return isNaN(e)?r()||0:e}if("integer"===n){const e=parseInt(t);return isNaN(e)?r()||0:e}if("array"===n){if(!t)return r()||[];try{return JSON.parse(t)}catch(t){return r()||[]}}if("device"===n)return i?t:a.getDeviceById(t)||a.getDeviceById(r());if(t&&e.json)try{return JSON.parse(t)}catch(t){return r()}return t||r()}(this.device.storage.getItem(t),e,(()=>null!=e.persistedDefaultValue?(this.putSettingInternal(e,void 0,t,e.persistedDefaultValue),e.persistedDefaultValue):e.defaultValue),r);return e.mapGet?e.mapGet(i):i}getItem(t){return this.getItemInternal(t,this.settings[t])}}},4192:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScryptedMimeTypes=e.ScryptedInterface=e.MediaPlayerState=e.SecuritySystemObstruction=e.SecuritySystemMode=e.AirQuality=e.AirPurifierMode=e.AirPurifierStatus=e.ChargeState=e.LockState=e.PanTiltZoomMovement=e.ThermostatMode=e.TemperatureUnit=e.FanMode=e.HumidityMode=e.ScryptedDeviceType=e.ScryptedInterfaceDescriptors=e.ScryptedInterfaceMethod=e.ScryptedInterfaceProperty=e.DeviceBase=e.TYPES_VERSION=void 0,e.TYPES_VERSION="0.3.91";var r,i,n,o,s,a,u,c,p,l,h,d,m,f,y,g,v,b;e.DeviceBase=class{},function(t){t.id="id",t.info="info",t.interfaces="interfaces",t.mixins="mixins",t.name="name",t.nativeId="nativeId",t.pluginId="pluginId",t.providedInterfaces="providedInterfaces",t.providedName="providedName",t.providedRoom="providedRoom",t.providedType="providedType",t.providerId="providerId",t.room="room",t.type="type",t.scryptedRuntimeArguments="scryptedRuntimeArguments",t.on="on",t.brightness="brightness",t.colorTemperature="colorTemperature",t.rgb="rgb",t.hsv="hsv",t.running="running",t.paused="paused",t.docked="docked",t.temperatureSetting="temperatureSetting",t.temperature="temperature",t.temperatureUnit="temperatureUnit",t.humidity="humidity",t.audioVolumes="audioVolumes",t.recordingActive="recordingActive",t.ptzCapabilities="ptzCapabilities",t.lockState="lockState",t.entryOpen="entryOpen",t.batteryLevel="batteryLevel",t.chargeState="chargeState",t.online="online",t.fromMimeType="fromMimeType",t.toMimeType="toMimeType",t.converters="converters",t.binaryState="binaryState",t.tampered="tampered",t.powerDetected="powerDetected",t.audioDetected="audioDetected",t.motionDetected="motionDetected",t.ambientLight="ambientLight",t.occupied="occupied",t.flooded="flooded",t.ultraviolet="ultraviolet",t.luminance="luminance",t.position="position",t.securitySystemState="securitySystemState",t.pm10Density="pm10Density",t.pm25Density="pm25Density",t.vocDensity="vocDensity",t.noxDensity="noxDensity",t.co2ppm="co2ppm",t.airQuality="airQuality",t.airPurifierState="airPurifierState",t.filterChangeIndication="filterChangeIndication",t.filterLifeLevel="filterLifeLevel",t.humiditySetting="humiditySetting",t.fan="fan",t.applicationInfo="applicationInfo",t.systemDevice="systemDevice"}(r||(e.ScryptedInterfaceProperty=r={})),function(t){t.listen="listen",t.probe="probe",t.setMixins="setMixins",t.setName="setName",t.setRoom="setRoom",t.setType="setType",t.getPluginJson="getPluginJson",t.turnOff="turnOff",t.turnOn="turnOn",t.setBrightness="setBrightness",t.getTemperatureMaxK="getTemperatureMaxK",t.getTemperatureMinK="getTemperatureMinK",t.setColorTemperature="setColorTemperature",t.setRgb="setRgb",t.setHsv="setHsv",t.sendNotification="sendNotification",t.start="start",t.stop="stop",t.pause="pause",t.resume="resume",t.dock="dock",t.setTemperature="setTemperature",t.setTemperatureUnit="setTemperatureUnit",t.getPictureOptions="getPictureOptions",t.takePicture="takePicture",t.getAudioStream="getAudioStream",t.setAudioVolumes="setAudioVolumes",t.startDisplay="startDisplay",t.stopDisplay="stopDisplay",t.getVideoStream="getVideoStream",t.getVideoStreamOptions="getVideoStreamOptions",t.getPrivacyMasks="getPrivacyMasks",t.setPrivacyMasks="setPrivacyMasks",t.getRecordingStream="getRecordingStream",t.getRecordingStreamCurrentTime="getRecordingStreamCurrentTime",t.getRecordingStreamOptions="getRecordingStreamOptions",t.getRecordingStreamThumbnail="getRecordingStreamThumbnail",t.deleteRecordingStream="deleteRecordingStream",t.setRecordingActive="setRecordingActive",t.ptzCommand="ptzCommand",t.getRecordedEvents="getRecordedEvents",t.getVideoClip="getVideoClip",t.getVideoClips="getVideoClips",t.getVideoClipThumbnail="getVideoClipThumbnail",t.removeVideoClips="removeVideoClips",t.setVideoStreamOptions="setVideoStreamOptions",t.startIntercom="startIntercom",t.stopIntercom="stopIntercom",t.lock="lock",t.unlock="unlock",t.addPassword="addPassword",t.getPasswords="getPasswords",t.removePassword="removePassword",t.activate="activate",t.deactivate="deactivate",t.isReversible="isReversible",t.closeEntry="closeEntry",t.openEntry="openEntry",t.getDevice="getDevice",t.releaseDevice="releaseDevice",t.adoptDevice="adoptDevice",t.discoverDevices="discoverDevices",t.createDevice="createDevice",t.getCreateDeviceSettings="getCreateDeviceSettings",t.reboot="reboot",t.getRefreshFrequency="getRefreshFrequency",t.refresh="refresh",t.getMediaStatus="getMediaStatus",t.load="load",t.seek="seek",t.skipNext="skipNext",t.skipPrevious="skipPrevious",t.convert="convert",t.convertMedia="convertMedia",t.getSettings="getSettings",t.putSetting="putSetting",t.armSecuritySystem="armSecuritySystem",t.disarmSecuritySystem="disarmSecuritySystem",t.setAirPurifierState="setAirPurifierState",t.getReadmeMarkdown="getReadmeMarkdown",t.getOauthUrl="getOauthUrl",t.onOauthCallback="onOauthCallback",t.canMixin="canMixin",t.getMixin="getMixin",t.releaseMixin="releaseMixin",t.onRequest="onRequest",t.onConnection="onConnection",t.onPush="onPush",t.run="run",t.eval="eval",t.loadScripts="loadScripts",t.saveScript="saveScript",t.forkInterface="forkInterface",t.trackObjects="trackObjects",t.getDetectionInput="getDetectionInput",t.getObjectTypes="getObjectTypes",t.detectObjects="detectObjects",t.generateObjectDetections="generateObjectDetections",t.getDetectionModel="getDetectionModel",t.setHumidity="setHumidity",t.setFan="setFan",t.startRTCSignalingSession="startRTCSignalingSession",t.createRTCSignalingSession="createRTCSignalingSession",t.getScryptedUserAccessControl="getScryptedUserAccessControl",t.generateVideoFrames="generateVideoFrames",t.connectStream="connectStream",t.getTTYSettings="getTTYSettings"}(i||(e.ScryptedInterfaceMethod=i={})),e.ScryptedInterfaceDescriptors={ScryptedDevice:{name:"ScryptedDevice",methods:["listen","probe","setMixins","setName","setRoom","setType"],properties:["id","info","interfaces","mixins","name","nativeId","pluginId","providedInterfaces","providedName","providedRoom","providedType","providerId","room","type"]},ScryptedPlugin:{name:"ScryptedPlugin",methods:["getPluginJson"],properties:[]},ScryptedPluginRuntime:{name:"ScryptedPluginRuntime",methods:[],properties:["scryptedRuntimeArguments"]},OnOff:{name:"OnOff",methods:["turnOff","turnOn"],properties:["on"]},Brightness:{name:"Brightness",methods:["setBrightness"],properties:["brightness"]},ColorSettingTemperature:{name:"ColorSettingTemperature",methods:["getTemperatureMaxK","getTemperatureMinK","setColorTemperature"],properties:["colorTemperature"]},ColorSettingRgb:{name:"ColorSettingRgb",methods:["setRgb"],properties:["rgb"]},ColorSettingHsv:{name:"ColorSettingHsv",methods:["setHsv"],properties:["hsv"]},Notifier:{name:"Notifier",methods:["sendNotification"],properties:[]},StartStop:{name:"StartStop",methods:["start","stop"],properties:["running"]},Pause:{name:"Pause",methods:["pause","resume"],properties:["paused"]},Dock:{name:"Dock",methods:["dock"],properties:["docked"]},TemperatureSetting:{name:"TemperatureSetting",methods:["setTemperature"],properties:["temperatureSetting"]},Thermometer:{name:"Thermometer",methods:["setTemperatureUnit"],properties:["temperature","temperatureUnit"]},HumiditySensor:{name:"HumiditySensor",methods:[],properties:["humidity"]},Camera:{name:"Camera",methods:["getPictureOptions","takePicture"],properties:[]},Microphone:{name:"Microphone",methods:["getAudioStream"],properties:[]},AudioVolumeControl:{name:"AudioVolumeControl",methods:["setAudioVolumes"],properties:["audioVolumes"]},Display:{name:"Display",methods:["startDisplay","stopDisplay"],properties:[]},VideoCamera:{name:"VideoCamera",methods:["getVideoStream","getVideoStreamOptions"],properties:[]},VideoCameraMask:{name:"VideoCameraMask",methods:["getPrivacyMasks","setPrivacyMasks"],properties:[]},VideoRecorder:{name:"VideoRecorder",methods:["getRecordingStream","getRecordingStreamCurrentTime","getRecordingStreamOptions","getRecordingStreamThumbnail"],properties:["recordingActive"]},VideoRecorderManagement:{name:"VideoRecorderManagement",methods:["deleteRecordingStream","setRecordingActive"],properties:[]},PanTiltZoom:{name:"PanTiltZoom",methods:["ptzCommand"],properties:["ptzCapabilities"]},EventRecorder:{name:"EventRecorder",methods:["getRecordedEvents"],properties:[]},VideoClips:{name:"VideoClips",methods:["getVideoClip","getVideoClips","getVideoClipThumbnail","removeVideoClips"],properties:[]},VideoCameraConfiguration:{name:"VideoCameraConfiguration",methods:["setVideoStreamOptions"],properties:[]},Intercom:{name:"Intercom",methods:["startIntercom","stopIntercom"],properties:[]},Lock:{name:"Lock",methods:["lock","unlock"],properties:["lockState"]},PasswordStore:{name:"PasswordStore",methods:["addPassword","getPasswords","removePassword"],properties:[]},Scene:{name:"Scene",methods:["activate","deactivate","isReversible"],properties:[]},Entry:{name:"Entry",methods:["closeEntry","openEntry"],properties:[]},EntrySensor:{name:"EntrySensor",methods:[],properties:["entryOpen"]},DeviceProvider:{name:"DeviceProvider",methods:["getDevice","releaseDevice"],properties:[]},DeviceDiscovery:{name:"DeviceDiscovery",methods:["adoptDevice","discoverDevices"],properties:[]},DeviceCreator:{name:"DeviceCreator",methods:["createDevice","getCreateDeviceSettings"],properties:[]},Battery:{name:"Battery",methods:[],properties:["batteryLevel"]},Charger:{name:"Charger",methods:[],properties:["chargeState"]},Reboot:{name:"Reboot",methods:["reboot"],properties:[]},Refresh:{name:"Refresh",methods:["getRefreshFrequency","refresh"],properties:[]},MediaPlayer:{name:"MediaPlayer",methods:["getMediaStatus","load","seek","skipNext","skipPrevious"],properties:[]},Online:{name:"Online",methods:[],properties:["online"]},BufferConverter:{name:"BufferConverter",methods:["convert"],properties:["fromMimeType","toMimeType"]},MediaConverter:{name:"MediaConverter",methods:["convertMedia"],properties:["converters"]},Settings:{name:"Settings",methods:["getSettings","putSetting"],properties:[]},BinarySensor:{name:"BinarySensor",methods:[],properties:["binaryState"]},TamperSensor:{name:"TamperSensor",methods:[],properties:["tampered"]},PowerSensor:{name:"PowerSensor",methods:[],properties:["powerDetected"]},AudioSensor:{name:"AudioSensor",methods:[],properties:["audioDetected"]},MotionSensor:{name:"MotionSensor",methods:[],properties:["motionDetected"]},AmbientLightSensor:{name:"AmbientLightSensor",methods:[],properties:["ambientLight"]},OccupancySensor:{name:"OccupancySensor",methods:[],properties:["occupied"]},FloodSensor:{name:"FloodSensor",methods:[],properties:["flooded"]},UltravioletSensor:{name:"UltravioletSensor",methods:[],properties:["ultraviolet"]},LuminanceSensor:{name:"LuminanceSensor",methods:[],properties:["luminance"]},PositionSensor:{name:"PositionSensor",methods:[],properties:["position"]},SecuritySystem:{name:"SecuritySystem",methods:["armSecuritySystem","disarmSecuritySystem"],properties:["securitySystemState"]},PM10Sensor:{name:"PM10Sensor",methods:[],properties:["pm10Density"]},PM25Sensor:{name:"PM25Sensor",methods:[],properties:["pm25Density"]},VOCSensor:{name:"VOCSensor",methods:[],properties:["vocDensity"]},NOXSensor:{name:"NOXSensor",methods:[],properties:["noxDensity"]},CO2Sensor:{name:"CO2Sensor",methods:[],properties:["co2ppm"]},AirQualitySensor:{name:"AirQualitySensor",methods:[],properties:["airQuality"]},AirPurifier:{name:"AirPurifier",methods:["setAirPurifierState"],properties:["airPurifierState"]},FilterMaintenance:{name:"FilterMaintenance",methods:[],properties:["filterChangeIndication","filterLifeLevel"]},Readme:{name:"Readme",methods:["getReadmeMarkdown"],properties:[]},OauthClient:{name:"OauthClient",methods:["getOauthUrl","onOauthCallback"],properties:[]},MixinProvider:{name:"MixinProvider",methods:["canMixin","getMixin","releaseMixin"],properties:[]},HttpRequestHandler:{name:"HttpRequestHandler",methods:["onRequest"],properties:[]},EngineIOHandler:{name:"EngineIOHandler",methods:["onConnection"],properties:[]},PushHandler:{name:"PushHandler",methods:["onPush"],properties:[]},Program:{name:"Program",methods:["run"],properties:[]},Scriptable:{name:"Scriptable",methods:["eval","loadScripts","saveScript"],properties:[]},ClusterForkInterface:{name:"ClusterForkInterface",methods:["forkInterface"],properties:[]},ObjectTracker:{name:"ObjectTracker",methods:["trackObjects"],properties:[]},ObjectDetector:{name:"ObjectDetector",methods:["getDetectionInput","getObjectTypes"],properties:[]},ObjectDetection:{name:"ObjectDetection",methods:["detectObjects","generateObjectDetections","getDetectionModel"],properties:[]},ObjectDetectionPreview:{name:"ObjectDetectionPreview",methods:[],properties:[]},ObjectDetectionGenerator:{name:"ObjectDetectionGenerator",methods:[],properties:[]},HumiditySetting:{name:"HumiditySetting",methods:["setHumidity"],properties:["humiditySetting"]},Fan:{name:"Fan",methods:["setFan"],properties:["fan"]},RTCSignalingChannel:{name:"RTCSignalingChannel",methods:["startRTCSignalingSession"],properties:[]},RTCSignalingClient:{name:"RTCSignalingClient",methods:["createRTCSignalingSession"],properties:[]},LauncherApplication:{name:"LauncherApplication",methods:[],properties:["applicationInfo"]},ScryptedUser:{name:"ScryptedUser",methods:["getScryptedUserAccessControl"],properties:[]},VideoFrameGenerator:{name:"VideoFrameGenerator",methods:["generateVideoFrames"],properties:[]},StreamService:{name:"StreamService",methods:["connectStream"],properties:[]},TTY:{name:"TTY",methods:[],properties:[]},TTYSettings:{name:"TTYSettings",methods:["getTTYSettings"],properties:[]},ScryptedSystemDevice:{name:"ScryptedSystemDevice",methods:[],properties:["systemDevice"]},ScryptedDeviceCreator:{name:"ScryptedDeviceCreator",methods:[],properties:[]},ScryptedSettings:{name:"ScryptedSettings",methods:[],properties:[]}},function(t){t.Builtin="Builtin",t.Camera="Camera",t.Fan="Fan",t.Light="Light",t.Switch="Switch",t.Outlet="Outlet",t.Sensor="Sensor",t.Scene="Scene",t.Program="Program",t.Automation="Automation",t.Vacuum="Vacuum",t.Notifier="Notifier",t.Thermostat="Thermostat",t.Lock="Lock",t.PasswordControl="PasswordControl",t.Display="Display",t.SmartDisplay="SmartDisplay",t.Speaker="Speaker",t.SmartSpeaker="SmartSpeaker",t.Event="Event",t.Entry="Entry",t.Garage="Garage",t.DeviceProvider="DeviceProvider",t.DataSource="DataSource",t.API="API",t.Doorbell="Doorbell",t.Irrigation="Irrigation",t.Valve="Valve",t.Person="Person",t.SecuritySystem="SecuritySystem",t.WindowCovering="WindowCovering",t.Siren="Siren",t.AirPurifier="AirPurifier",t.Unknown="Unknown"}(n||(e.ScryptedDeviceType=n={})),function(t){t.Humidify="Humidify",t.Dehumidify="Dehumidify",t.Auto="Auto",t.Off="Off"}(o||(e.HumidityMode=o={})),function(t){t.Auto="Auto",t.Manual="Manual"}(s||(e.FanMode=s={})),function(t){t.C="C",t.F="F"}(a||(e.TemperatureUnit=a={})),function(t){t.Off="Off",t.Cool="Cool",t.Heat="Heat",t.HeatCool="HeatCool",t.Auto="Auto",t.FanOnly="FanOnly",t.Purifier="Purifier",t.Eco="Eco",t.Dry="Dry",t.On="On"}(u||(e.ThermostatMode=u={})),function(t){t.Absolute="Absolute",t.Relative="Relative",t.Continuous="Continuous",t.Preset="Preset",t.Home="Home"}(c||(e.PanTiltZoomMovement=c={})),function(t){t.Locked="Locked",t.Unlocked="Unlocked",t.Jammed="Jammed"}(p||(e.LockState=p={})),function(t){t.Trickle="trickle",t.Charging="charging",t.NotCharging="not-charging"}(l||(e.ChargeState=l={})),function(t){t.Inactive="Inactive",t.Idle="Idle",t.Active="Active",t.ActiveNightMode="ActiveNightMode"}(h||(e.AirPurifierStatus=h={})),function(t){t.Manual="Manual",t.Automatic="Automatic"}(d||(e.AirPurifierMode=d={})),function(t){t.Unknown="Unknown",t.Excellent="Excellent",t.Good="Good",t.Fair="Fair",t.Inferior="Inferior",t.Poor="Poor"}(m||(e.AirQuality=m={})),function(t){t.Disarmed="Disarmed",t.HomeArmed="HomeArmed",t.AwayArmed="AwayArmed",t.NightArmed="NightArmed"}(f||(e.SecuritySystemMode=f={})),function(t){t.Sensor="Sensor",t.Occupied="Occupied",t.Time="Time",t.Error="Error"}(y||(e.SecuritySystemObstruction=y={})),function(t){t.Idle="Idle",t.Playing="Playing",t.Paused="Paused",t.Buffering="Buffering"}(g||(e.MediaPlayerState=g={})),function(t){t.ScryptedDevice="ScryptedDevice",t.ScryptedPlugin="ScryptedPlugin",t.ScryptedPluginRuntime="ScryptedPluginRuntime",t.OnOff="OnOff",t.Brightness="Brightness",t.ColorSettingTemperature="ColorSettingTemperature",t.ColorSettingRgb="ColorSettingRgb",t.ColorSettingHsv="ColorSettingHsv",t.Notifier="Notifier",t.StartStop="StartStop",t.Pause="Pause",t.Dock="Dock",t.TemperatureSetting="TemperatureSetting",t.Thermometer="Thermometer",t.HumiditySensor="HumiditySensor",t.Camera="Camera",t.Microphone="Microphone",t.AudioVolumeControl="AudioVolumeControl",t.Display="Display",t.VideoCamera="VideoCamera",t.VideoCameraMask="VideoCameraMask",t.VideoRecorder="VideoRecorder",t.VideoRecorderManagement="VideoRecorderManagement",t.PanTiltZoom="PanTiltZoom",t.EventRecorder="EventRecorder",t.VideoClips="VideoClips",t.VideoCameraConfiguration="VideoCameraConfiguration",t.Intercom="Intercom",t.Lock="Lock",t.PasswordStore="PasswordStore",t.Scene="Scene",t.Entry="Entry",t.EntrySensor="EntrySensor",t.DeviceProvider="DeviceProvider",t.DeviceDiscovery="DeviceDiscovery",t.DeviceCreator="DeviceCreator",t.Battery="Battery",t.Charger="Charger",t.Reboot="Reboot",t.Refresh="Refresh",t.MediaPlayer="MediaPlayer",t.Online="Online",t.BufferConverter="BufferConverter",t.MediaConverter="MediaConverter",t.Settings="Settings",t.BinarySensor="BinarySensor",t.TamperSensor="TamperSensor",t.PowerSensor="PowerSensor",t.AudioSensor="AudioSensor",t.MotionSensor="MotionSensor",t.AmbientLightSensor="AmbientLightSensor",t.OccupancySensor="OccupancySensor",t.FloodSensor="FloodSensor",t.UltravioletSensor="UltravioletSensor",t.LuminanceSensor="LuminanceSensor",t.PositionSensor="PositionSensor",t.SecuritySystem="SecuritySystem",t.PM10Sensor="PM10Sensor",t.PM25Sensor="PM25Sensor",t.VOCSensor="VOCSensor",t.NOXSensor="NOXSensor",t.CO2Sensor="CO2Sensor",t.AirQualitySensor="AirQualitySensor",t.AirPurifier="AirPurifier",t.FilterMaintenance="FilterMaintenance",t.Readme="Readme",t.OauthClient="OauthClient",t.MixinProvider="MixinProvider",t.HttpRequestHandler="HttpRequestHandler",t.EngineIOHandler="EngineIOHandler",t.PushHandler="PushHandler",t.Program="Program",t.Scriptable="Scriptable",t.ClusterForkInterface="ClusterForkInterface",t.ObjectTracker="ObjectTracker",t.ObjectDetector="ObjectDetector",t.ObjectDetection="ObjectDetection",t.ObjectDetectionPreview="ObjectDetectionPreview",t.ObjectDetectionGenerator="ObjectDetectionGenerator",t.HumiditySetting="HumiditySetting",t.Fan="Fan",t.RTCSignalingChannel="RTCSignalingChannel",t.RTCSignalingClient="RTCSignalingClient",t.LauncherApplication="LauncherApplication",t.ScryptedUser="ScryptedUser",t.VideoFrameGenerator="VideoFrameGenerator",t.StreamService="StreamService",t.TTY="TTY",t.TTYSettings="TTYSettings",t.ScryptedSystemDevice="ScryptedSystemDevice",t.ScryptedDeviceCreator="ScryptedDeviceCreator",t.ScryptedSettings="ScryptedSettings"}(v||(e.ScryptedInterface=v={})),function(t){t.Url="text/x-uri",t.InsecureLocalUrl="text/x-insecure-local-uri",t.LocalUrl="text/x-local-uri",t.ServerId="text/x-server-id",t.PushEndpoint="text/x-push-endpoint",t.SchemePrefix="x-scrypted/x-scrypted-scheme-",t.MediaStreamUrl="text/x-media-url",t.MediaObject="x-scrypted/x-scrypted-media-object",t.RequestMediaObject="x-scrypted/x-scrypted-request-media-object",t.RequestMediaStream="x-scrypted/x-scrypted-request-stream",t.MediaStreamFeedback="x-scrypted/x-media-stream-feedback",t.FFmpegInput="x-scrypted/x-ffmpeg-input",t.FFmpegTranscodeStream="x-scrypted/x-ffmpeg-transcode-stream",t.RTCSignalingChannel="x-scrypted/x-scrypted-rtc-signaling-channel",t.RTCSignalingSession="x-scrypted/x-scrypted-rtc-signaling-session",t.RTCConnectionManagement="x-scrypted/x-scrypted-rtc-connection-management",t.Image="x-scrypted/x-scrypted-image"}(b||(e.ScryptedMimeTypes=b={}))},5580:(t,e,r)=>{var i=r(6110)(r(9325),"DataView");t.exports=i},1549:(t,e,r)=>{var i=r(2032),n=r(3862),o=r(6721),s=r(2749),a=r(5749);function u(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=n,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,t.exports=u},79:(t,e,r)=>{var i=r(3702),n=r(80),o=r(4739),s=r(8655),a=r(1175);function u(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=n,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,t.exports=u},8223:(t,e,r)=>{var i=r(6110)(r(9325),"Map");t.exports=i},3661:(t,e,r)=>{var i=r(3040),n=r(7670),o=r(289),s=r(4509),a=r(2949);function u(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=n,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,t.exports=u},2804:(t,e,r)=>{var i=r(6110)(r(9325),"Promise");t.exports=i},6545:(t,e,r)=>{var i=r(6110)(r(9325),"Set");t.exports=i},8859:(t,e,r)=>{var i=r(3661),n=r(1380),o=r(1459);function s(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new i;++e<r;)this.add(t[e])}s.prototype.add=s.prototype.push=n,s.prototype.has=o,t.exports=s},7217:(t,e,r)=>{var i=r(79),n=r(1420),o=r(938),s=r(3605),a=r(9817),u=r(945);function c(t){var e=this.__data__=new i(t);this.size=e.size}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=u,t.exports=c},1873:(t,e,r)=>{var i=r(9325).Symbol;t.exports=i},7828:(t,e,r)=>{var i=r(9325).Uint8Array;t.exports=i},8303:(t,e,r)=>{var i=r(6110)(r(9325),"WeakMap");t.exports=i},3945:t=>{t.exports=function(t,e,r,i){for(var n=-1,o=null==t?0:t.length;++n<o;){var s=t[n];e(i,s,r(s),t)}return i}},9770:t=>{t.exports=function(t,e){for(var r=-1,i=null==t?0:t.length,n=0,o=[];++r<i;){var s=t[r];e(s,r,t)&&(o[n++]=s)}return o}},695:(t,e,r)=>{var i=r(8096),n=r(2428),o=r(6449),s=r(3656),a=r(361),u=r(7167),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=o(t),p=!r&&n(t),l=!r&&!p&&s(t),h=!r&&!p&&!l&&u(t),d=r||p||l||h,m=d?i(t.length,String):[],f=m.length;for(var y in t)!e&&!c.call(t,y)||d&&("length"==y||l&&("offset"==y||"parent"==y)||h&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||a(y,f))||m.push(y);return m}},4932:t=>{t.exports=function(t,e){for(var r=-1,i=null==t?0:t.length,n=Array(i);++r<i;)n[r]=e(t[r],r,t);return n}},4528:t=>{t.exports=function(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}},4248:t=>{t.exports=function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}},6025:(t,e,r)=>{var i=r(5288);t.exports=function(t,e){for(var r=t.length;r--;)if(i(t[r][0],e))return r;return-1}},2429:(t,e,r)=>{var i=r(909);t.exports=function(t,e,r,n){return i(t,(function(t,i,o){e(n,t,r(t),o)})),n}},3360:(t,e,r)=>{var i=r(3243);t.exports=function(t,e,r){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}},909:(t,e,r)=>{var i=r(641),n=r(8329)(i);t.exports=n},6649:(t,e,r)=>{var i=r(3221)();t.exports=i},641:(t,e,r)=>{var i=r(6649),n=r(5950);t.exports=function(t,e){return t&&i(t,e,n)}},7422:(t,e,r)=>{var i=r(1769),n=r(7797);t.exports=function(t,e){for(var r=0,o=(e=i(e,t)).length;null!=t&&r<o;)t=t[n(e[r++])];return r&&r==o?t:void 0}},2199:(t,e,r)=>{var i=r(4528),n=r(6449);t.exports=function(t,e,r){var o=e(t);return n(t)?o:i(o,r(t))}},2552:(t,e,r)=>{var i=r(1873),n=r(659),o=r(9350),s=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?n(t):o(t)}},8077:t=>{t.exports=function(t,e){return null!=t&&e in Object(t)}},7534:(t,e,r)=>{var i=r(2552),n=r(346);t.exports=function(t){return n(t)&&"[object Arguments]"==i(t)}},270:(t,e,r)=>{var i=r(7068),n=r(346);t.exports=function t(e,r,o,s,a){return e===r||(null==e||null==r||!n(e)&&!n(r)?e!=e&&r!=r:i(e,r,o,s,t,a))}},7068:(t,e,r)=>{var i=r(7217),n=r(5911),o=r(1986),s=r(689),a=r(5861),u=r(6449),c=r(3656),p=r(7167),l="[object Arguments]",h="[object Array]",d="[object Object]",m=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,f,y,g){var v=u(t),b=u(e),S=v?h:a(t),T=b?h:a(e),w=(S=S==l?d:S)==d,C=(T=T==l?d:T)==d,O=S==T;if(O&&c(t)){if(!c(e))return!1;v=!0,w=!1}if(O&&!w)return g||(g=new i),v||p(t)?n(t,e,r,f,y,g):o(t,e,S,r,f,y,g);if(!(1&r)){var D=w&&m.call(t,"__wrapped__"),x=C&&m.call(e,"__wrapped__");if(D||x){var _=D?t.value():t,P=x?e.value():e;return g||(g=new i),y(_,P,r,f,g)}}return!!O&&(g||(g=new i),s(t,e,r,f,y,g))}},1799:(t,e,r)=>{var i=r(7217),n=r(270);t.exports=function(t,e,r,o){var s=r.length,a=s,u=!o;if(null==t)return!a;for(t=Object(t);s--;){var c=r[s];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++s<a;){var p=(c=r[s])[0],l=t[p],h=c[1];if(u&&c[2]){if(void 0===l&&!(p in t))return!1}else{var d=new i;if(o)var m=o(l,h,p,t,e,d);if(!(void 0===m?n(h,l,3,o,d):m))return!1}}return!0}},5083:(t,e,r)=>{var i=r(1882),n=r(7296),o=r(3805),s=r(7473),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,p=u.toString,l=c.hasOwnProperty,h=RegExp("^"+p.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||n(t))&&(i(t)?h:a).test(s(t))}},4901:(t,e,r)=>{var i=r(2552),n=r(294),o=r(346),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&n(t.length)&&!!s[i(t)]}},5389:(t,e,r)=>{var i=r(3663),n=r(7978),o=r(3488),s=r(6449),a=r(583);t.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==typeof t?s(t)?n(t[0],t[1]):i(t):a(t)}},8984:(t,e,r)=>{var i=r(5527),n=r(3650),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return n(t);var e=[];for(var r in Object(t))o.call(t,r)&&"constructor"!=r&&e.push(r);return e}},3663:(t,e,r)=>{var i=r(1799),n=r(776),o=r(7197);t.exports=function(t){var e=n(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(r){return r===t||i(r,t,e)}}},7978:(t,e,r)=>{var i=r(270),n=r(8156),o=r(631),s=r(8586),a=r(756),u=r(7197),c=r(7797);t.exports=function(t,e){return s(t)&&a(e)?u(c(t),e):function(r){var s=n(r,t);return void 0===s&&s===e?o(r,t):i(e,s,3)}}},7237:t=>{t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},7255:(t,e,r)=>{var i=r(7422);t.exports=function(t){return function(e){return i(e,t)}}},8096:t=>{t.exports=function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}},7556:(t,e,r)=>{var i=r(1873),n=r(4932),o=r(6449),s=r(4394),a=i?i.prototype:void 0,u=a?a.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return n(e,t)+"";if(s(e))return u?u.call(e):"";var r=e+"";return"0"==r&&1/e==-1/0?"-0":r}},7301:t=>{t.exports=function(t){return function(e){return t(e)}}},9219:t=>{t.exports=function(t,e){return t.has(e)}},1769:(t,e,r)=>{var i=r(6449),n=r(8586),o=r(1802),s=r(3222);t.exports=function(t,e){return i(t)?t:n(t,e)?[t]:o(s(t))}},5481:(t,e,r)=>{var i=r(9325)["__core-js_shared__"];t.exports=i},2e3:(t,e,r)=>{var i=r(3945),n=r(2429),o=r(5389),s=r(6449);t.exports=function(t,e){return function(r,a){var u=s(r)?i:n,c=e?e():{};return u(r,t,o(a,2),c)}}},8329:(t,e,r)=>{var i=r(4894);t.exports=function(t,e){return function(r,n){if(null==r)return r;if(!i(r))return t(r,n);for(var o=r.length,s=e?o:-1,a=Object(r);(e?s--:++s<o)&&!1!==n(a[s],s,a););return r}}},3221:t=>{t.exports=function(t){return function(e,r,i){for(var n=-1,o=Object(e),s=i(e),a=s.length;a--;){var u=s[t?a:++n];if(!1===r(o[u],u,o))break}return e}}},3243:(t,e,r)=>{var i=r(6110),n=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=n},5911:(t,e,r)=>{var i=r(8859),n=r(4248),o=r(9219);t.exports=function(t,e,r,s,a,u){var c=1&r,p=t.length,l=e.length;if(p!=l&&!(c&&l>p))return!1;var h=u.get(t),d=u.get(e);if(h&&d)return h==e&&d==t;var m=-1,f=!0,y=2&r?new i:void 0;for(u.set(t,e),u.set(e,t);++m<p;){var g=t[m],v=e[m];if(s)var b=c?s(v,g,m,e,t,u):s(g,v,m,t,e,u);if(void 0!==b){if(b)continue;f=!1;break}if(y){if(!n(e,(function(t,e){if(!o(y,e)&&(g===t||a(g,t,r,s,u)))return y.push(e)}))){f=!1;break}}else if(g!==v&&!a(g,v,r,s,u)){f=!1;break}}return u.delete(t),u.delete(e),f}},1986:(t,e,r)=>{var i=r(1873),n=r(7828),o=r(5288),s=r(5911),a=r(317),u=r(4247),c=i?i.prototype:void 0,p=c?c.valueOf:void 0;t.exports=function(t,e,r,i,c,l,h){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!l(new n(t),new n(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var d=a;case"[object Set]":var m=1&i;if(d||(d=u),t.size!=e.size&&!m)return!1;var f=h.get(t);if(f)return f==e;i|=2,h.set(t,e);var y=s(d(t),d(e),i,c,l,h);return h.delete(t),y;case"[object Symbol]":if(p)return p.call(t)==p.call(e)}return!1}},689:(t,e,r)=>{var i=r(2),n=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,o,s,a){var u=1&r,c=i(t),p=c.length;if(p!=i(e).length&&!u)return!1;for(var l=p;l--;){var h=c[l];if(!(u?h in e:n.call(e,h)))return!1}var d=a.get(t),m=a.get(e);if(d&&m)return d==e&&m==t;var f=!0;a.set(t,e),a.set(e,t);for(var y=u;++l<p;){var g=t[h=c[l]],v=e[h];if(o)var b=u?o(v,g,h,e,t,a):o(g,v,h,t,e,a);if(!(void 0===b?g===v||s(g,v,r,o,a):b)){f=!1;break}y||(y="constructor"==h)}if(f&&!y){var S=t.constructor,T=e.constructor;S==T||!("constructor"in t)||!("constructor"in e)||"function"==typeof S&&S instanceof S&&"function"==typeof T&&T instanceof T||(f=!1)}return a.delete(t),a.delete(e),f}},4840:t=>{var e="object"==typeof global&&global&&global.Object===Object&&global;t.exports=e},2:(t,e,r)=>{var i=r(2199),n=r(4664),o=r(5950);t.exports=function(t){return i(t,o,n)}},2651:(t,e,r)=>{var i=r(4218);t.exports=function(t,e){var r=t.__data__;return i(e)?r["string"==typeof e?"string":"hash"]:r.map}},776:(t,e,r)=>{var i=r(756),n=r(5950);t.exports=function(t){for(var e=n(t),r=e.length;r--;){var o=e[r],s=t[o];e[r]=[o,s,i(s)]}return e}},6110:(t,e,r)=>{var i=r(5083),n=r(392);t.exports=function(t,e){var r=n(t,e);return i(r)?r:void 0}},659:(t,e,r)=>{var i=r(1873),n=Object.prototype,o=n.hasOwnProperty,s=n.toString,a=i?i.toStringTag:void 0;t.exports=function(t){var e=o.call(t,a),r=t[a];try{t[a]=void 0;var i=!0}catch(t){}var n=s.call(t);return i&&(e?t[a]=r:delete t[a]),n}},4664:(t,e,r)=>{var i=r(9770),n=r(3345),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(t){return null==t?[]:(t=Object(t),i(s(t),(function(e){return o.call(t,e)})))}:n;t.exports=a},5861:(t,e,r)=>{var i=r(5580),n=r(8223),o=r(2804),s=r(6545),a=r(8303),u=r(2552),c=r(7473),p="[object Map]",l="[object Promise]",h="[object Set]",d="[object WeakMap]",m="[object DataView]",f=c(i),y=c(n),g=c(o),v=c(s),b=c(a),S=u;(i&&S(new i(new ArrayBuffer(1)))!=m||n&&S(new n)!=p||o&&S(o.resolve())!=l||s&&S(new s)!=h||a&&S(new a)!=d)&&(S=function(t){var e=u(t),r="[object Object]"==e?t.constructor:void 0,i=r?c(r):"";if(i)switch(i){case f:return m;case y:return p;case g:return l;case v:return h;case b:return d}return e}),t.exports=S},392:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},9326:(t,e,r)=>{var i=r(1769),n=r(2428),o=r(6449),s=r(361),a=r(294),u=r(7797);t.exports=function(t,e,r){for(var c=-1,p=(e=i(e,t)).length,l=!1;++c<p;){var h=u(e[c]);if(!(l=null!=t&&r(t,h)))break;t=t[h]}return l||++c!=p?l:!!(p=null==t?0:t.length)&&a(p)&&s(h,p)&&(o(t)||n(t))}},2032:(t,e,r)=>{var i=r(1042);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},3862:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},6721:(t,e,r)=>{var i=r(1042),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return n.call(e,t)?e[t]:void 0}},2749:(t,e,r)=>{var i=r(1042),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:n.call(e,t)}},5749:(t,e,r)=>{var i=r(1042);t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},361:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,r){var i=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==i||"symbol"!=i&&e.test(t))&&t>-1&&t%1==0&&t<r}},8586:(t,e,r)=>{var i=r(6449),n=r(4394),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!n(t))||(s.test(t)||!o.test(t)||null!=e&&t in Object(e))}},4218:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},7296:(t,e,r)=>{var i,n=r(5481),o=(i=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!o&&o in t}},5527:t=>{var e=Object.prototype;t.exports=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||e)}},756:(t,e,r)=>{var i=r(3805);t.exports=function(t){return t==t&&!i(t)}},3702:t=>{t.exports=function(){this.__data__=[],this.size=0}},80:(t,e,r)=>{var i=r(6025),n=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=i(e,t);return!(r<0)&&(r==e.length-1?e.pop():n.call(e,r,1),--this.size,!0)}},4739:(t,e,r)=>{var i=r(6025);t.exports=function(t){var e=this.__data__,r=i(e,t);return r<0?void 0:e[r][1]}},8655:(t,e,r)=>{var i=r(6025);t.exports=function(t){return i(this.__data__,t)>-1}},1175:(t,e,r)=>{var i=r(6025);t.exports=function(t,e){var r=this.__data__,n=i(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}},3040:(t,e,r)=>{var i=r(1549),n=r(79),o=r(8223);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(o||n),string:new i}}},7670:(t,e,r)=>{var i=r(2651);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},289:(t,e,r)=>{var i=r(2651);t.exports=function(t){return i(this,t).get(t)}},4509:(t,e,r)=>{var i=r(2651);t.exports=function(t){return i(this,t).has(t)}},2949:(t,e,r)=>{var i=r(2651);t.exports=function(t,e){var r=i(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}},317:t=>{t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,i){r[++e]=[i,t]})),r}},7197:t=>{t.exports=function(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}},2224:(t,e,r)=>{var i=r(104);t.exports=function(t){var e=i(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}},1042:(t,e,r)=>{var i=r(6110)(Object,"create");t.exports=i},3650:(t,e,r)=>{var i=r(4335)(Object.keys,Object);t.exports=i},6009:(t,e,r)=>{t=r.nmd(t);var i=r(4840),n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,s=o&&o.exports===n&&i.process,a=function(){try{var t=o&&o.require&&o.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=a},9350:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},4335:t=>{t.exports=function(t,e){return function(r){return t(e(r))}}},9325:(t,e,r)=>{var i=r(4840),n="object"==typeof self&&self&&self.Object===Object&&self,o=i||n||Function("return this")();t.exports=o},1380:t=>{t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},1459:t=>{t.exports=function(t){return this.__data__.has(t)}},4247:t=>{t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}},1420:(t,e,r)=>{var i=r(79);t.exports=function(){this.__data__=new i,this.size=0}},938:t=>{t.exports=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}},3605:t=>{t.exports=function(t){return this.__data__.get(t)}},9817:t=>{t.exports=function(t){return this.__data__.has(t)}},945:(t,e,r)=>{var i=r(79),n=r(8223),o=r(3661);t.exports=function(t,e){var r=this.__data__;if(r instanceof i){var s=r.__data__;if(!n||s.length<199)return s.push([t,e]),this.size=++r.size,this;r=this.__data__=new o(s)}return r.set(t,e),this.size=r.size,this}},1802:(t,e,r)=>{var i=r(2224),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=i((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,(function(t,r,i,n){e.push(i?n.replace(o,"$1"):r||t)})),e}));t.exports=s},7797:(t,e,r)=>{var i=r(4394);t.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},7473:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},5288:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},8156:(t,e,r)=>{var i=r(7422);t.exports=function(t,e,r){var n=null==t?void 0:i(t,e);return void 0===n?r:n}},631:(t,e,r)=>{var i=r(8077),n=r(9326);t.exports=function(t,e){return null!=t&&n(t,e,i)}},3488:t=>{t.exports=function(t){return t}},2428:(t,e,r)=>{var i=r(7534),n=r(346),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,u=i(function(){return arguments}())?i:function(t){return n(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=u},6449:t=>{var e=Array.isArray;t.exports=e},4894:(t,e,r)=>{var i=r(1882),n=r(294);t.exports=function(t){return null!=t&&n(t.length)&&!i(t)}},3656:(t,e,r)=>{t=r.nmd(t);var i=r(9325),n=r(9935),o=e&&!e.nodeType&&e,s=o&&t&&!t.nodeType&&t,a=s&&s.exports===o?i.Buffer:void 0,u=(a?a.isBuffer:void 0)||n;t.exports=u},1882:(t,e,r)=>{var i=r(2552),n=r(3805);t.exports=function(t){if(!n(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},294:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},3805:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},346:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},4394:(t,e,r)=>{var i=r(2552),n=r(346);t.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==i(t)}},7167:(t,e,r)=>{var i=r(4901),n=r(7301),o=r(6009),s=o&&o.isTypedArray,a=s?n(s):i;t.exports=a},8970:(t,e,r)=>{var i=r(3360),n=r(2e3)((function(t,e,r){i(t,r,e)}));t.exports=n},5950:(t,e,r)=>{var i=r(695),n=r(8984),o=r(4894);t.exports=function(t){return o(t)?i(t):n(t)}},104:(t,e,r)=>{var i=r(3661);function n(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var i=arguments,n=e?e.apply(this,i):i[0],o=r.cache;if(o.has(n))return o.get(n);var s=t.apply(this,i);return r.cache=o.set(n,s)||o,s};return r.cache=new(n.Cache||i),r}n.Cache=i,t.exports=n},583:(t,e,r)=>{var i=r(7237),n=r(7255),o=r(8586),s=r(7797);t.exports=function(t){return o(t)?i(s(t)):n(t)}},3345:t=>{t.exports=function(){return[]}},9935:t=>{t.exports=function(){return!1}},3222:(t,e,r)=>{var i=r(7556);t.exports=function(t){return null==t?"":i(t)}},4043:(t,e,r)=>{!function(t){t.parser=function(t,e){return new n(t,e)},t.SAXParser=n,t.SAXStream=s,t.createStream=function(t,e){return new s(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function n(e,r){if(!(this instanceof n))return new n(e,r);var o=this;!function(t){for(var e=0,r=i.length;e<r;e++)t[i[e]]=""}(o),o.q=o.c="",o.bufferCheckPosition=t.MAX_BUFFER_LENGTH,o.opt=r||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!e,o.noscript=!(!e&&!o.opt.noscript),o.state=O.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(l)),void 0===o.opt.unquotedAttributeValues&&(o.opt.unquotedAttributeValues=!e),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),x(o,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e}),n.prototype={end:function(){N(this)},write:function(e){var r=this;if(this.error)throw this.error;if(r.closed)return I(r,"Cannot write after close. Assign an onready handler.");if(null===e)return N(r);"object"==typeof e&&(e=e.toString());var n=0,o="";for(;o=$(e,n++),r.c=o,o;)switch(r.trackPosition&&(r.position++,"\n"===o?(r.line++,r.column=0):r.column++),r.state){case O.BEGIN:if(r.state=O.BEGIN_WHITESPACE,"\ufeff"===o)continue;V(r,o);continue;case O.BEGIN_WHITESPACE:V(r,o);continue;case O.TEXT:if(r.sawRoot&&!r.closedRoot){for(var s=n-1;o&&"<"!==o&&"&"!==o;)(o=$(e,n++))&&r.trackPosition&&(r.position++,"\n"===o?(r.line++,r.column=0):r.column++);r.textNode+=e.substring(s,n-1)}"<"!==o||r.sawRoot&&r.closedRoot&&!r.strict?(y(o)||r.sawRoot&&!r.closedRoot||A(r,"Text data outside of root node."),"&"===o?r.state=O.TEXT_ENTITY:r.textNode+=o):(r.state=O.OPEN_WAKA,r.startTagPosition=r.position);continue;case O.SCRIPT:"<"===o?r.state=O.SCRIPT_ENDING:r.script+=o;continue;case O.SCRIPT_ENDING:"/"===o?r.state=O.CLOSE_TAG:(r.script+="<"+o,r.state=O.SCRIPT);continue;case O.OPEN_WAKA:if("!"===o)r.state=O.SGML_DECL,r.sgmlDecl="";else if(y(o));else if(b(h,o))r.state=O.OPEN_TAG,r.tagName=o;else if("/"===o)r.state=O.CLOSE_TAG,r.tagName="";else if("?"===o)r.state=O.PROC_INST,r.procInstName=r.procInstBody="";else{if(A(r,"Unencoded <"),r.startTagPosition+1<r.position){var c=r.position-r.startTagPosition;o=new Array(c).join(" ")+o}r.textNode+="<"+o,r.state=O.TEXT}continue;case O.SGML_DECL:if(r.sgmlDecl+o==="--"){r.state=O.COMMENT,r.comment="",r.sgmlDecl="";continue}r.doctype&&!0!==r.doctype&&r.sgmlDecl?(r.state=O.DOCTYPE_DTD,r.doctype+="<!"+r.sgmlDecl+o,r.sgmlDecl=""):(r.sgmlDecl+o).toUpperCase()===a?(_(r,"onopencdata"),r.state=O.CDATA,r.sgmlDecl="",r.cdata=""):(r.sgmlDecl+o).toUpperCase()===u?(r.state=O.DOCTYPE,(r.doctype||r.sawRoot)&&A(r,"Inappropriately located doctype declaration"),r.doctype="",r.sgmlDecl=""):">"===o?(_(r,"onsgmldeclaration",r.sgmlDecl),r.sgmlDecl="",r.state=O.TEXT):g(o)?(r.state=O.SGML_DECL_QUOTED,r.sgmlDecl+=o):r.sgmlDecl+=o;continue;case O.SGML_DECL_QUOTED:o===r.q&&(r.state=O.SGML_DECL,r.q=""),r.sgmlDecl+=o;continue;case O.DOCTYPE:">"===o?(r.state=O.TEXT,_(r,"ondoctype",r.doctype),r.doctype=!0):(r.doctype+=o,"["===o?r.state=O.DOCTYPE_DTD:g(o)&&(r.state=O.DOCTYPE_QUOTED,r.q=o));continue;case O.DOCTYPE_QUOTED:r.doctype+=o,o===r.q&&(r.q="",r.state=O.DOCTYPE);continue;case O.DOCTYPE_DTD:"]"===o?(r.doctype+=o,r.state=O.DOCTYPE):"<"===o?(r.state=O.OPEN_WAKA,r.startTagPosition=r.position):g(o)?(r.doctype+=o,r.state=O.DOCTYPE_DTD_QUOTED,r.q=o):r.doctype+=o;continue;case O.DOCTYPE_DTD_QUOTED:r.doctype+=o,o===r.q&&(r.state=O.DOCTYPE_DTD,r.q="");continue;case O.COMMENT:"-"===o?r.state=O.COMMENT_ENDING:r.comment+=o;continue;case O.COMMENT_ENDING:"-"===o?(r.state=O.COMMENT_ENDED,r.comment=E(r.opt,r.comment),r.comment&&_(r,"oncomment",r.comment),r.comment=""):(r.comment+="-"+o,r.state=O.COMMENT);continue;case O.COMMENT_ENDED:">"!==o?(A(r,"Malformed comment"),r.comment+="--"+o,r.state=O.COMMENT):r.doctype&&!0!==r.doctype?r.state=O.DOCTYPE_DTD:r.state=O.TEXT;continue;case O.CDATA:"]"===o?r.state=O.CDATA_ENDING:r.cdata+=o;continue;case O.CDATA_ENDING:"]"===o?r.state=O.CDATA_ENDING_2:(r.cdata+="]"+o,r.state=O.CDATA);continue;case O.CDATA_ENDING_2:">"===o?(r.cdata&&_(r,"oncdata",r.cdata),_(r,"onclosecdata"),r.cdata="",r.state=O.TEXT):"]"===o?r.cdata+="]":(r.cdata+="]]"+o,r.state=O.CDATA);continue;case O.PROC_INST:"?"===o?r.state=O.PROC_INST_ENDING:y(o)?r.state=O.PROC_INST_BODY:r.procInstName+=o;continue;case O.PROC_INST_BODY:if(!r.procInstBody&&y(o))continue;"?"===o?r.state=O.PROC_INST_ENDING:r.procInstBody+=o;continue;case O.PROC_INST_ENDING:">"===o?(_(r,"onprocessinginstruction",{name:r.procInstName,body:r.procInstBody}),r.procInstName=r.procInstBody="",r.state=O.TEXT):(r.procInstBody+="?"+o,r.state=O.PROC_INST_BODY);continue;case O.OPEN_TAG:b(d,o)?r.tagName+=o:(M(r),">"===o?k(r):"/"===o?r.state=O.OPEN_TAG_SLASH:(y(o)||A(r,"Invalid character in tag name"),r.state=O.ATTRIB));continue;case O.OPEN_TAG_SLASH:">"===o?(k(r,!0),j(r)):(A(r,"Forward-slash in opening tag not followed by >"),r.state=O.ATTRIB);continue;case O.ATTRIB:if(y(o))continue;">"===o?k(r):"/"===o?r.state=O.OPEN_TAG_SLASH:b(h,o)?(r.attribName=o,r.attribValue="",r.state=O.ATTRIB_NAME):A(r,"Invalid attribute name");continue;case O.ATTRIB_NAME:"="===o?r.state=O.ATTRIB_VALUE:">"===o?(A(r,"Attribute without value"),r.attribValue=r.attribName,F(r),k(r)):y(o)?r.state=O.ATTRIB_NAME_SAW_WHITE:b(d,o)?r.attribName+=o:A(r,"Invalid attribute name");continue;case O.ATTRIB_NAME_SAW_WHITE:if("="===o)r.state=O.ATTRIB_VALUE;else{if(y(o))continue;A(r,"Attribute without value"),r.tag.attributes[r.attribName]="",r.attribValue="",_(r,"onattribute",{name:r.attribName,value:""}),r.attribName="",">"===o?k(r):b(h,o)?(r.attribName=o,r.state=O.ATTRIB_NAME):(A(r,"Invalid attribute name"),r.state=O.ATTRIB)}continue;case O.ATTRIB_VALUE:if(y(o))continue;g(o)?(r.q=o,r.state=O.ATTRIB_VALUE_QUOTED):(r.opt.unquotedAttributeValues||I(r,"Unquoted attribute value"),r.state=O.ATTRIB_VALUE_UNQUOTED,r.attribValue=o);continue;case O.ATTRIB_VALUE_QUOTED:if(o!==r.q){"&"===o?r.state=O.ATTRIB_VALUE_ENTITY_Q:r.attribValue+=o;continue}F(r),r.q="",r.state=O.ATTRIB_VALUE_CLOSED;continue;case O.ATTRIB_VALUE_CLOSED:y(o)?r.state=O.ATTRIB:">"===o?k(r):"/"===o?r.state=O.OPEN_TAG_SLASH:b(h,o)?(A(r,"No whitespace between attributes"),r.attribName=o,r.attribValue="",r.state=O.ATTRIB_NAME):A(r,"Invalid attribute name");continue;case O.ATTRIB_VALUE_UNQUOTED:if(!v(o)){"&"===o?r.state=O.ATTRIB_VALUE_ENTITY_U:r.attribValue+=o;continue}F(r),">"===o?k(r):r.state=O.ATTRIB;continue;case O.CLOSE_TAG:if(r.tagName)">"===o?j(r):b(d,o)?r.tagName+=o:r.script?(r.script+="</"+r.tagName,r.tagName="",r.state=O.SCRIPT):(y(o)||A(r,"Invalid tagname in closing tag"),r.state=O.CLOSE_TAG_SAW_WHITE);else{if(y(o))continue;S(h,o)?r.script?(r.script+="</"+o,r.state=O.SCRIPT):A(r,"Invalid tagname in closing tag."):r.tagName=o}continue;case O.CLOSE_TAG_SAW_WHITE:if(y(o))continue;">"===o?j(r):A(r,"Invalid characters in closing tag");continue;case O.TEXT_ENTITY:case O.ATTRIB_VALUE_ENTITY_Q:case O.ATTRIB_VALUE_ENTITY_U:var p,l;switch(r.state){case O.TEXT_ENTITY:p=O.TEXT,l="textNode";break;case O.ATTRIB_VALUE_ENTITY_Q:p=O.ATTRIB_VALUE_QUOTED,l="attribValue";break;case O.ATTRIB_VALUE_ENTITY_U:p=O.ATTRIB_VALUE_UNQUOTED,l="attribValue"}if(";"===o){var T=L(r);r.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(T)?(r.entity="",r.state=p,r.write(T)):(r[l]+=T,r.entity="",r.state=p)}else b(r.entity.length?f:m,o)?r.entity+=o:(A(r,"Invalid character in entity name"),r[l]+="&"+r.entity+o,r.entity="",r.state=p);continue;default:throw new Error(r,"Unknown state: "+r.state)}r.position>=r.bufferCheckPosition&&function(e){for(var r=Math.max(t.MAX_BUFFER_LENGTH,10),n=0,o=0,s=i.length;o<s;o++){var a=e[i[o]].length;if(a>r)switch(i[o]){case"textNode":P(e);break;case"cdata":_(e,"oncdata",e.cdata),e.cdata="";break;case"script":_(e,"onscript",e.script),e.script="";break;default:I(e,"Max buffer length exceeded: "+i[o])}n=Math.max(n,a)}var u=t.MAX_BUFFER_LENGTH-n;e.bufferCheckPosition=u+e.position}(r);return r},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;P(t=this),""!==t.cdata&&(_(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(_(t,"onscript",t.script),t.script="")}};try{e=r(2203).Stream}catch(t){e=function(){}}e||(e=function(){});var o=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function s(t,r){if(!(this instanceof s))return new s(t,r);e.apply(this),this._parser=new n(t,r),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(t){i.emit("error",t),i._parser.error=null},this._decoder=null,o.forEach((function(t){Object.defineProperty(i,"on"+t,{get:function(){return i._parser["on"+t]},set:function(e){if(!e)return i.removeAllListeners(t),i._parser["on"+t]=e,e;i.on(t,e)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(e.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=r(3193).StringDecoder;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},s.prototype.on=function(t,r){var i=this;return i._parser["on"+t]||-1===o.indexOf(t)||(i._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),i.emit.apply(i,e)}),e.prototype.on.call(i,t,r)};var a="[CDATA[",u="DOCTYPE",c="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/2000/xmlns/",l={xml:c,xmlns:p},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function y(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function g(t){return'"'===t||"'"===t}function v(t){return">"===t||y(t)}function b(t,e){return t.test(e)}function S(t,e){return!b(t,e)}var T,w,C,O=0;for(var D in t.STATE={BEGIN:O++,BEGIN_WHITESPACE:O++,TEXT:O++,TEXT_ENTITY:O++,OPEN_WAKA:O++,SGML_DECL:O++,SGML_DECL_QUOTED:O++,DOCTYPE:O++,DOCTYPE_QUOTED:O++,DOCTYPE_DTD:O++,DOCTYPE_DTD_QUOTED:O++,COMMENT_STARTING:O++,COMMENT:O++,COMMENT_ENDING:O++,COMMENT_ENDED:O++,CDATA:O++,CDATA_ENDING:O++,CDATA_ENDING_2:O++,PROC_INST:O++,PROC_INST_BODY:O++,PROC_INST_ENDING:O++,OPEN_TAG:O++,OPEN_TAG_SLASH:O++,ATTRIB:O++,ATTRIB_NAME:O++,ATTRIB_NAME_SAW_WHITE:O++,ATTRIB_VALUE:O++,ATTRIB_VALUE_QUOTED:O++,ATTRIB_VALUE_CLOSED:O++,ATTRIB_VALUE_UNQUOTED:O++,ATTRIB_VALUE_ENTITY_Q:O++,ATTRIB_VALUE_ENTITY_U:O++,CLOSE_TAG:O++,CLOSE_TAG_SAW_WHITE:O++,SCRIPT:O++,SCRIPT_ENDING:O++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var r=t.ENTITIES[e],i="number"==typeof r?String.fromCharCode(r):r;t.ENTITIES[e]=i})),t.STATE)t.STATE[t.STATE[D]]=D;function x(t,e,r){t[e]&&t[e](r)}function _(t,e,r){t.textNode&&P(t),x(t,e,r)}function P(t){t.textNode=E(t.opt,t.textNode),t.textNode&&x(t,"ontext",t.textNode),t.textNode=""}function E(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function I(t,e){return P(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,x(t,"onerror",e),t}function N(t){return t.sawRoot&&!t.closedRoot&&A(t,"Unclosed root tag"),t.state!==O.BEGIN&&t.state!==O.BEGIN_WHITESPACE&&t.state!==O.TEXT&&I(t,"Unexpected end"),P(t),t.c="",t.closed=!0,x(t,"onend"),n.call(t,t.strict,t.opt),t}function A(t,e){if("object"!=typeof t||!(t instanceof n))throw new Error("bad call to strictFail");t.strict&&I(t,e)}function M(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,r=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(r.ns=e.ns),t.attribList.length=0,_(t,"onopentagstart",r)}function R(t,e){var r=t.indexOf(":")<0?["",t]:t.split(":"),i=r[0],n=r[1];return e&&"xmlns"===t&&(i="xmlns",n=""),{prefix:i,local:n}}function F(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=R(t.attribName,!0),r=e.prefix,i=e.local;if("xmlns"===r)if("xml"===i&&t.attribValue!==c)A(t,"xml: prefix must be bound to "+c+"\nActual: "+t.attribValue);else if("xmlns"===i&&t.attribValue!==p)A(t,"xmlns: prefix must be bound to "+p+"\nActual: "+t.attribValue);else{var n=t.tag,o=t.tags[t.tags.length-1]||t;n.ns===o.ns&&(n.ns=Object.create(o.ns)),n.ns[i]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,_(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function k(t,e){if(t.opt.xmlns){var r=t.tag,i=R(t.tagName);r.prefix=i.prefix,r.local=i.local,r.uri=r.ns[i.prefix]||"",r.prefix&&!r.uri&&(A(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),r.uri=i.prefix);var n=t.tags[t.tags.length-1]||t;r.ns&&n.ns!==r.ns&&Object.keys(r.ns).forEach((function(e){_(t,"onopennamespace",{prefix:e,uri:r.ns[e]})}));for(var o=0,s=t.attribList.length;o<s;o++){var a=t.attribList[o],u=a[0],c=a[1],p=R(u,!0),l=p.prefix,h=p.local,d=""===l?"":r.ns[l]||"",m={name:u,value:c,prefix:l,local:h,uri:d};l&&"xmlns"!==l&&!d&&(A(t,"Unbound namespace prefix: "+JSON.stringify(l)),m.uri=l),t.tag.attributes[u]=m,_(t,"onattribute",m)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),_(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=O.TEXT:t.state=O.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function j(t){if(!t.tagName)return A(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=O.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=O.SCRIPT);_(t,"onscript",t.script),t.script=""}var e=t.tags.length,r=t.tagName;t.strict||(r=r[t.looseCase]());for(var i=r;e--;){if(t.tags[e].name===i)break;A(t,"Unexpected close tag")}if(e<0)return A(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=O.TEXT);t.tagName=r;for(var n=t.tags.length;n-- >e;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,_(t,"onclosetag",t.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];var u=t.tags[t.tags.length-1]||t;t.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach((function(e){var r=o.ns[e];_(t,"onclosenamespace",{prefix:e,uri:r})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=O.TEXT}function L(t){var e,r=t.entity,i=r.toLowerCase(),n="";return t.ENTITIES[r]?t.ENTITIES[r]:t.ENTITIES[i]?t.ENTITIES[i]:("#"===(r=i).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),n=(e=parseInt(r,16)).toString(16)):(r=r.slice(1),n=(e=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(e)||n.toLowerCase()!==r?(A(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function V(t,e){"<"===e?(t.state=O.OPEN_WAKA,t.startTagPosition=t.position):y(e)||(A(t,"Non-whitespace before first tag."),t.textNode=e,t.state=O.TEXT)}function $(t,e){var r="";return e<t.length&&(r=t.charAt(e)),r}O=t.STATE,String.fromCodePoint||(T=String.fromCharCode,w=Math.floor,C=function(){var t,e,r=[],i=-1,n=arguments.length;if(!n)return"";for(var o="";++i<n;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||w(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(t=55296+((s-=65536)>>10),e=s%1024+56320,r.push(t,e)),(i+1===n||r.length>16384)&&(o+=T.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C)}(e)},2112:function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(2673),o=r(6117),s=i(r(8970)),a=r(3985),u=r(6185);class c extends n.SettingsMixinDeviceBase{constructor(t,e){super(t),this.plugin=e,this.streamCaps=[],this.motionCaps=null,this.audioCaps=null,this.timeCaps=null,this.osdCaps=null,this.ptzCaps=null,this.ptzPresets=[],this.deviceInfo=null,this.suppressOnPut=!1,this.initStorage={},this.storageSettings=new o.StorageSettings(this,this.initStorage),this.plugin.mixinsMap[this.id]=this,setTimeout((async()=>!this.killed&&await this.init()),2e3)}async init(){await this.fetchMotionCapabilities(),await this.fetchStreamCapabilities(),await this.fetchAudioCapabilities(),await this.fetchTimeCapabilities(),await this.fetchOSDCapabilities(),await this.fetchPTZCapabilities(),await this.fetchDeviceInfo(),await this.refreshSettings(),await this.refreshSettings()}async updateMotionCapabilities(){await this.fetchMotionCapabilities(),this.setMotionSettingsValues()}async updateStreamCapabilities(){await this.fetchStreamCapabilities(),this.setStreamSettingsValues(this.streamCaps)}async updateAudioCapabilities(){await this.fetchAudioCapabilities(),this.setAudioSettingsValues()}async updateTimeCapabilities(){await this.fetchTimeCapabilities(),this.setTimeSettingsValues()}async updateOSDCapabilities(){await this.fetchOSDCapabilities(),this.setOSDSettingsValues()}async updatePTZCapabilities(){await this.fetchPTZCapabilities(),this.setPTZSettingsValues()}async fetchMotionCapabilities(){const t=await this.getClient();this.motionCaps=await t.getMotionCapabilities();const e=await t.getMotionEventTrigger();this.motionCaps.centerNotificationEnabled=e.centerNotificationEnabled}async fetchAudioCapabilities(){const t=await this.getClient();this.audioCaps=await t.getTwoWayAudioCapabilities()}async fetchTimeCapabilities(){const t=await this.getClient();this.timeCaps=await t.getTimeCapabilities()}async fetchOSDCapabilities(){const t=await this.getClient(),e=await t.getOSDCapabilities(),r=await t.getOSD(),i=await t.getVideoInputChannel();this.osdCaps={...e,...r,videoInputName:i.name}}async fetchDeviceInfo(){const t=await this.getClient();this.deviceInfo=await t.getDeviceInfo()}async fetchPTZCapabilities(){const t=await this.getClient();try{this.ptzCaps=await t.getPTZCapabilities(),this.ptzPresets=await t.getPTZPresets()}catch(t){this.console.log("PTZ not supported or error fetching capabilities",t),this.ptzCaps=null,this.ptzPresets=[]}}generateMotionSettings(){const t=[];return this.motionCaps?(t.push({key:"motionEnabled",title:"Motion Enabled",subgroup:"Motion",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateMotionDetection({enabled:e})}}),t.push({key:"motionSensitivity",title:"Motion Sensitivity",subgroup:"Motion",type:"string",choices:this.motionCaps.sensitivityOptions,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateMotionDetection({motionSensitivity:e})}}),t.push({key:"motionCenterNotification",title:"Send to Notification Center",description:"Enable notifications to surveillance center",subgroup:"Motion",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateMotionEventTrigger({centerNotificationEnabled:e})}}),t.push({key:"motionRefetch",title:"Refetch",subgroup:"Motion",type:"button",onPut:async()=>{await this.updateMotionCapabilities()}}),t):t}generateStreamSettings(t){const e=[];for(const r of t){const t=r.id,i=r.capabilities;e.push({key:`${t}:name`,title:"Stream name",description:`${t}`,subgroup:"Stream",type:"html"});const n=i.resolutions.map((t=>`${t.width}x${t.height}`));e.push({key:`${t}:videoResolution`,title:`Resolution (Stream ${t})`,subgroup:"Stream",type:"string",choices:n,immediate:!0,onPut:async(e,r)=>{if(e!==r&&void 0!==e){const[e,i]=r.split("x").map(Number);await this.updateStreamingChannel(t,{videoResolutionWidth:e,videoResolutionHeight:i})}}});const o=i.allFrameRates.map((t=>t.label));e.push({key:`${t}:maxFrameRate`,title:`FPS (Stream ${t})`,subgroup:"Stream",type:"string",choices:o,immediate:!0,onPut:async(e,r)=>{if(e!==r&&void 0!==e){const e=i.allFrameRates.find((t=>t.label===r))?.value;e&&await this.updateStreamingChannel(t,{maxFrameRate:e})}}}),e.push({key:`${t}:videoQualityControlType`,title:`Quality Control (Stream ${t})`,subgroup:"Stream",type:"string",choices:i.qualityControlTypes,immediate:!0}),e.push({key:`${t}:bitrate`,title:`Bitrate kbps (Stream ${t})`,subgroup:"Stream",type:"string",choices:[],immediate:!0});const s=i.videoCodecs.map((t=>t.type));e.push({key:`${t}:videoCodecType`,title:`Video Codec (Stream ${t})`,subgroup:"Stream",type:"string",choices:s,immediate:!0});const a=r.video,u=(r.audio,a.maxFrameRate/100),c=Math.ceil(a.govLengthMin/u),p=Math.floor(a.govLengthMax/u),l=[];for(let t=c;t<=p;t++)l.push(String(t));e.push({key:`${t}:govLength`,title:`I-Frame Interval (Stream ${t})`,description:`Min: ${c}s, Max: ${p}s (GOP)`,subgroup:"Stream",type:"string",choices:l,immediate:!0,onPut:async(e,r)=>{if(e!==r&&void 0!==e){const e=Math.round(Number(r)*u);await this.updateStreamingChannel(t,{govLength:e})}}});const h=["Minimum (1)","Very Low (20)","Low (40)","Medium (60)","High (80)","Maximum (100)"];e.push({key:`${t}:fixedQuality`,title:`Fixed Quality (Stream ${t})`,subgroup:"Stream",type:"string",choices:h,immediate:!0,onPut:async(e,r)=>{if(e!==r&&void 0!==e){const e=r.match(/\((\d+)\)/),i=Number(e?e[1]:r);this.console.log(`Setting fixedQuality for stream ${t}: ${r} -> ${i}`),await this.updateStreamingChannel(t,{fixedQuality:i})}}}),e.push({key:`${t}:audioEnabled`,title:`Audio Enabled (Stream ${t})`,subgroup:"Stream",type:"boolean",immediate:!0,onPut:async(e,r)=>{e!==r&&void 0!==e&&await this.updateStreamingChannel(t,{audioEnabled:r})}}),"H.265"===a.videoCodecType&&e.push({key:`${t}:smartCodecEnabled`,title:`H.265+ Smart Codec (Stream ${t})`,description:"Enable H.265+ for better compression",subgroup:"Stream",type:"boolean",immediate:!0,onPut:async(e,r)=>{e!==r&&void 0!==e&&await this.updateStreamingChannel(t,{smartCodecEnabled:r})}})}return e.push({key:"streamsRefetch",title:"Refetch",subgroup:"Stream",type:"button",onPut:async()=>{await this.updateStreamCapabilities()}}),e}generateAudioSettings(){const t=[];if(!this.audioCaps)return t;t.push({key:"audioCodec",title:"Audio Codec",subgroup:"Audio",type:"string",choices:this.audioCaps.audioCodecs,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({audioCompressionType:e})}});const e=[];for(let t=this.audioCaps.speakerVolumeMin;t<=this.audioCaps.speakerVolumeMax;t+=10)e.push(String(t));return e.includes(String(this.audioCaps.speakerVolumeMax))||e.push(String(this.audioCaps.speakerVolumeMax)),t.push({key:"speakerVolume",title:"Speaker Volume",description:`Range: ${this.audioCaps.speakerVolumeMin}-${this.audioCaps.speakerVolumeMax}`,subgroup:"Audio",type:"string",choices:e,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({speakerVolume:Number(e)})}}),this.audioCaps.supportsNoiseReduction&&t.push({key:"noiseReduction",title:"Noise Reduction",subgroup:"Audio",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({noiseReduction:e})}}),t.push({key:"audioInputType",title:"Audio Input Type",subgroup:"Audio",type:"string",choices:this.audioCaps.audioInputTypes,immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateAudio({audioInputType:e})}}),t.push({key:"audioRefetch",title:"Refetch",subgroup:"Audio",type:"button",onPut:async()=>{await this.updateAudioCapabilities()}}),t}generateTimeSettings(){const t=[];if(!this.timeCaps)return t;const e=this.storageSettings.values.timeMode;if(t.push({key:"timeMode",title:"Time Mode",subgroup:"Time",type:"string",choices:this.timeCaps.timeModes||[],immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){if("manual"===e){const t=(new Date).toISOString().slice(0,19);await this.updateTime({timeMode:e,localTime:t})}else await this.updateTime({timeMode:e});await this.updateTimeCapabilities(),await this.refreshSettings()}}}),"NTP"===e){t.push({key:"ntpServer",title:"NTP Server IP",description:"IP address of NTP server",subgroup:"Time",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateNTPServer({ipAddress:e})}}),t.push({key:"ntpPort",title:"NTP Server Port",description:"Port number of NTP server",subgroup:"Time",type:"number",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateNTPServer({portNo:e})}});const e=[];for(let t=1;t<=36;t++)e.push(`${t} hour${t>1?"s":""}`);t.push({key:"ntpSyncInterval",title:"NTP Sync Interval",description:"How often to sync with NTP server",subgroup:"Time",type:"string",choices:e,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=e.match(/^(\d+) hour/);if(t){const e=60*Number(t[1]);await this.updateNTPServer({synchronizeInterval:e})}}}})}t.push({key:"timeZone",title:"Time Zone",description:"Select timezone offset from UTC",subgroup:"Time",type:"string",choices:["UTC-12:00:00","UTC-11:00:00","UTC-10:00:00","UTC-9:00:00","UTC-8:00:00","UTC-7:00:00","UTC-6:00:00","UTC-5:00:00","UTC-4:00:00","UTC-3:00:00","UTC-2:00:00","UTC-1:00:00","UTC+0:00:00","UTC+1:00:00","UTC+2:00:00","UTC+3:00:00","UTC+4:00:00","UTC+5:00:00","UTC+6:00:00","UTC+7:00:00","UTC+8:00:00","UTC+9:00:00","UTC+10:00:00","UTC+11:00:00","UTC+12:00:00"],immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=e.match(/UTC([+-])(\d+):00:00/);if(t){const e=`CST${"+"===t[1]?"-":"+"}${t[2]}:00:00`,r="DST01:00:00,M3.5.0/02:00:00,M10.5.0/03:00:00",i=!0===this.storageSettings.values.daylightSaving?`${e}${r}`:e;await this.updateTime({timeZone:i})}}}});return t.push({key:"daylightSaving",title:"Daylight Saving Time",description:"Enable DST (Ora Legale)",subgroup:"Time",type:"boolean",immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=(this.storageSettings.values.timeZone||"UTC+1:00:00").match(/UTC([+-])(\d+):00:00/);if(t){const r=`CST${"+"===t[1]?"-":"+"}${t[2]}:00:00`,i=e?`${r}DST01:00:00,M3.5.0/02:00:00,M10.5.0/03:00:00`:r;await this.updateTime({timeZone:i})}}}}),t.push({key:"timeRefetch",title:"Refetch",subgroup:"Time",type:"button",onPut:async()=>{await this.updateTimeCapabilities()}}),t}getOSDPositionPresets(t,e){const r=60,i=220;return{"Top Left 1":{x:0,y:e-0},"Top Left 2":{x:0,y:e-0-r},"Top Left 3":{x:0,y:e-0-120},"Top Right 1":{x:t-i-0,y:e-0},"Top Right 2":{x:t-i-0,y:e-0-r},"Top Right 3":{x:t-i-0,y:e-0-120},"Bottom Left 1":{x:0,y:0},"Bottom Left 2":{x:0,y:60},"Bottom Left 3":{x:0,y:120},"Bottom Right 1":{x:t-i-0,y:0},"Bottom Right 2":{x:t-i-0,y:60},"Bottom Right 3":{x:t-i-0,y:120}}}generateOSDSettings(){const t=[];if(!this.osdCaps)return t;const e=this.osdCaps.normalizedScreenWidth||704,r=this.osdCaps.normalizedScreenHeight||576,i=this.getOSDPositionPresets(e,r),n=Object.keys(i);t.push({key:"osdDateTimeEnabled",title:"Show Date/Time",subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{enabled:e}})}}),this.storageSettings.values.osdDateTimeEnabled&&(t.push({key:"osdDateStyle",title:"Date Format",subgroup:"OSD",type:"string",choices:["YYYY-MM-DD","MM-DD-YYYY","DD-MM-YYYY"],immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{dateStyle:e}})}}),t.push({key:"osdTimeStyle",title:"Time Format",subgroup:"OSD",type:"string",choices:["12hour","24hour"],immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{timeStyle:e}})}}),t.push({key:"osdDisplayWeek",title:"Show Week Day",subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{displayWeek:e}})}}),t.push({key:"osdDateTimePositionPreset",title:"Date/Time Position Preset",subgroup:"OSD",type:"string",choices:n,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=i[e];if(t){this.suppressOnPut=!0;try{this.storageSettings.values.osdDateTimeX=t.x,this.storageSettings.values.osdDateTimeY=t.y,await this.updateOSD({dateTimeOverlay:{positionX:t.x,positionY:t.y}}),this.osdCaps&&this.osdCaps.dateTimeOverlay&&(this.osdCaps.dateTimeOverlay.positionX=[String(t.x)],this.osdCaps.dateTimeOverlay.positionY=[String(t.y)])}finally{this.suppressOnPut=!1}await this.refreshSettings()}}}}),t.push({key:"osdDateTimeX",title:"Date/Time X Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{positionX:e}})}}),t.push({key:"osdDateTimeY",title:"Date/Time Y Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({dateTimeOverlay:{positionY:e}})}})),t.push({key:"osdChannelNameEnabled",title:"Show Channel Name",subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&(await this.updateOSD({channelNameOverlay:{enabled:e}}),await this.updateOSDCapabilities(),await this.refreshSettings())}}),this.storageSettings.values.osdChannelNameEnabled&&(t.push({key:"osdChannelName",title:"Channel Name",description:"Updates the video input channel name which is used as channel name overlay",subgroup:"OSD",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&(await this.updateVideoInputChannel(e),this.osdCaps&&(this.osdCaps.videoInputName=e))}}),t.push({key:"osdChannelNamePositionPreset",title:"Channel Name Position Preset",subgroup:"OSD",type:"string",choices:n,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=i[e];if(t){this.suppressOnPut=!0;try{this.storageSettings.values.osdChannelNameX=t.x,this.storageSettings.values.osdChannelNameY=t.y,await this.updateOSD({channelNameOverlay:{positionX:t.x,positionY:t.y}}),this.osdCaps&&this.osdCaps.channelNameOverlay&&(this.osdCaps.channelNameOverlay.positionX=[String(t.x)],this.osdCaps.channelNameOverlay.positionY=[String(t.y)])}finally{this.suppressOnPut=!1}await this.refreshSettings()}}}}),t.push({key:"osdChannelNameX",title:"Channel Name X Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({channelNameOverlay:{positionX:e}})}}),t.push({key:"osdChannelNameY",title:"Channel Name Y Position",subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({channelNameOverlay:{positionY:e}})}}));const o=this.osdCaps.textOverlayListSize||8;for(let e=1;e<=o;e++){const r=String(e);t.push({key:`osdText${r}Enabled`,title:`Text Overlay ${r} Enabled`,subgroup:"OSD",type:"boolean",immediate:!0,onPut:async(t,e)=>{t!==e&&void 0!==t&&(await this.updateOSD({textOverlays:[{id:r,enabled:e}]}),await this.updateOSDCapabilities(),await this.refreshSettings())}}),this.storageSettings.values[`osdText${r}Enabled`]&&(t.push({key:`osdText${r}Content`,title:`Text Overlay ${r} Content`,subgroup:"OSD",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updateOSD({textOverlays:[{id:r,displayText:e}]})}}),t.push({key:`osdText${r}PositionPreset`,title:`Text Overlay ${r} Position Preset`,subgroup:"OSD",type:"string",choices:n,immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){const t=i[e];if(t){this.suppressOnPut=!0;try{if(this.storageSettings.values[`osdText${r}X`]=t.x,this.storageSettings.values[`osdText${r}Y`]=t.y,await this.updateOSD({textOverlays:[{id:r,positionX:t.x,positionY:t.y}]}),this.osdCaps&&this.osdCaps.textOverlayList){const e=this.osdCaps.textOverlayList.find((t=>t.id?.[0]===r));e&&(e.positionX=[String(t.x)],e.positionY=[String(t.y)])}}finally{this.suppressOnPut=!1}await this.refreshSettings()}}}}),t.push({key:`osdText${r}X`,title:`Text Overlay ${r} X`,subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({textOverlays:[{id:r,positionX:e}]})}}),t.push({key:`osdText${r}Y`,title:`Text Overlay ${r} Y`,subgroup:"OSD",type:"number",immediate:!1,onPut:async(t,e)=>{this.suppressOnPut||t!==e&&void 0!==t&&await this.updateOSD({textOverlays:[{id:r,positionY:e}]})}}))}return t.push({key:"refetchOSD",title:"Refetch OSD Settings",subgroup:"OSD",type:"button",onPut:async()=>{await this.updateOSDCapabilities(),await this.refreshSettings()}}),t}generatePTZSettings(){const t=[];if(!this.ptzCaps)return t;const e=this.ptzCaps.specialNos||[],r=Math.min(this.ptzCaps.maxPresetNum||32,32);for(let i=1;i<=r;i++){if(e.includes(i))continue;const r=String(i);t.push({key:`ptzPreset${r}Enabled`,title:`Preset ${r} Enabled`,subgroup:"PTZ",type:"boolean",immediate:!0,onPut:async(t,e)=>{if(t!==e&&void 0!==t){if(e){const t=this.storageSettings.values[`ptzPreset${r}Name`]||`Preset ${r}`;await this.updatePTZPreset(r,t)}else await this.deletePTZPreset(r);await this.updatePTZCapabilities(),await this.refreshSettings()}}}),this.storageSettings.values[`ptzPreset${r}Enabled`]&&(t.push({key:`ptzPreset${r}Name`,title:`Preset ${r} Name`,description:"Updating name also sets preset to CURRENT position",subgroup:"PTZ",type:"string",immediate:!1,onPut:async(t,e)=>{t!==e&&void 0!==t&&await this.updatePTZPreset(r,e)}}),t.push({key:`ptzPreset${r}Go`,title:`Go to Preset ${r}`,subgroup:"PTZ",type:"button",onPut:async()=>{await this.gotoPTZPreset(r)}}))}return t.push({key:"refetchPTZ",title:"Refetch PTZ Settings",subgroup:"PTZ",type:"button",onPut:async()=>{await this.updatePTZCapabilities(),await this.refreshSettings()}}),t}generateInfoSettings(){const t=[];if(!this.deviceInfo)return t;const e=[{key:"deviceName",title:"Device Name"},{key:"model",title:"Model"},{key:"serialNumber",title:"Serial Number"},{key:"firmwareVersion",title:"Firmware Version"},{key:"firmwareReleasedDate",title:"Firmware Date"},{key:"macAddress",title:"MAC Address"},{key:"deviceType",title:"Device Type"}];for(const r of e)"deviceName"===r.key?t.push({key:`info_${r.key}`,title:r.title,subgroup:"Info",type:"string",immediate:!1,onPut:async(t,e)=>{const r=await this.getClient();await r.updateDeviceInfo(e),this.deviceInfo&&(this.deviceInfo.deviceName=e)}}):t.push({key:`info_${r.key}`,title:r.title,subgroup:"Info",type:"string",readonly:!0});return t}setMotionSettingsValues(){this.motionCaps&&(this.storageSettings.values.motionEnabled=this.motionCaps.enabled,this.storageSettings.values.motionSensitivity=String(this.motionCaps.sensitivityLevel),this.storageSettings.values.motionCenterNotification=this.motionCaps.centerNotificationEnabled)}setStreamSettingsValues(t){for(const e of t){const t=e.id,r=e.video;this.storageSettings.values[`${t}:videoResolution`]=`${r.videoResolutionWidth}x${r.videoResolutionHeight}`,this.storageSettings.values[`${t}:maxFrameRate`]=r.maxFrameRateUI,this.storageSettings.values[`${t}:videoQualityControlType`]=r.videoQualityControlType;const i="VBR"===r.videoQualityControlType?r.vbrUpperCap:r.constantBitRate,n="VBR"===r.videoQualityControlType?r.vbrUpperCapMin:r.constantBitRateMin,o="VBR"===r.videoQualityControlType?r.vbrUpperCapMax:r.constantBitRateMax,s=(0,u.generateBitrateChoices)(n,o);this.storageSettings.settings[`${t}:bitrate`].choices=s,this.storageSettings.values[`${t}:bitrate`]=String(i),this.storageSettings.values[`${t}:videoCodecType`]=r.videoCodecType,this.storageSettings.values[`${t}:govLength`]=String(r.govLengthUI);const a={1:"Minimum (1)",20:"Very Low (20)",40:"Low (40)",60:"Medium (60)",80:"High (80)",100:"Maximum (100)"}[r.fixedQuality]||`Custom (${r.fixedQuality})`;this.storageSettings.values[`${t}:fixedQuality`]=a;const c=e.audio;this.storageSettings.values[`${t}:audioEnabled`]=c.enabled,"H.265"===r.videoCodecType&&(this.storageSettings.values[`${t}:smartCodecEnabled`]=r.smartCodecEnabled)}}async fetchStreamCapabilities(){const t=await this.getClient();this.streamCaps=await t.getStreamingCapabilities()}async setAudioSettingsValues(){const t=await this.getClient(),e=await t.getTwoWayAudio();e&&(this.storageSettings.values.audioCodec=e.audioCompressionType,this.storageSettings.values.speakerVolume=String(e.speakerVolume),this.storageSettings.values.noiseReduction=e.noiseReduction,this.storageSettings.values.audioInputType=e.audioInputType)}async setTimeSettingsValues(){const t=await this.getClient(),e=await t.getTime(),r=await t.getNTPServer();if(!e)return;if(this.storageSettings.values.timeMode=e.timeMode,"NTP"===e.timeMode&&r){this.storageSettings.values.ntpServer=r.ipAddress,this.storageSettings.values.ntpPort=r.portNo;const t=r.synchronizeInterval,e=Math.round(t/60);this.storageSettings.values.ntpSyncInterval=`${e} hour${e>1?"s":""}`}if(e.timeZone){const t=e.timeZone.split("DST")[0].match(/CST([+-])(\d+):00:00/);if(t){const e="-"===t[1]?"+":"-",r=t[2];this.storageSettings.values.timeZone=`UTC${e}${r}:00:00`}}const i=e.timeZone?.includes("DST");this.storageSettings.values.daylightSaving=i}setOSDSettingsValues(){if(!this.osdCaps)return;const{dateTimeOverlay:t,channelNameOverlay:e,textOverlayList:r}=this.osdCaps;if(t&&(this.storageSettings.values.osdDateTimeEnabled="true"===t.enabled?.[0],this.storageSettings.values.osdDateStyle=t.dateStyle?.[0],this.storageSettings.values.osdTimeStyle=t.timeStyle?.[0],this.storageSettings.values.osdDisplayWeek="true"===t.displayWeek?.[0],this.storageSettings.values.osdDateTimeX=Number(t.positionX?.[0]||0),this.storageSettings.values.osdDateTimeY=Number(t.positionY?.[0]||0)),e&&(this.storageSettings.values.osdChannelNameEnabled="true"===e.enabled?.[0],this.storageSettings.values.osdChannelName=this.osdCaps.videoInputName||"",this.storageSettings.values.osdChannelNameX=Number(e.positionX?.[0]||0),this.storageSettings.values.osdChannelNameY=Number(e.positionY?.[0]||0)),r)for(const t of r){const e=t.id?.[0];e&&(this.storageSettings.values[`osdText${e}Enabled`]="true"===t.enabled?.[0],this.storageSettings.values[`osdText${e}Content`]=t.displayText?.[0]||"",this.storageSettings.values[`osdText${e}X`]=Number(t.positionX?.[0]),this.storageSettings.values[`osdText${e}Y`]=Number(t.positionY?.[0]))}}setPTZSettingsValues(){if(this.ptzPresets)for(const t of this.ptzPresets){const e=t.id?.[0];e&&(this.storageSettings.values[`ptzPreset${e}Enabled`]=!0,this.storageSettings.values[`ptzPreset${e}Name`]=t.presetName?.[0]||`Preset ${e}`)}}setInfoSettingsValues(){if(!this.deviceInfo)return;const t=["deviceName","model","serialNumber","firmwareVersion","firmwareReleasedDate","macAddress","deviceType"];for(const e of t)this.storageSettings.values[`info_${e}`]=this.deviceInfo[e]||""}async updateStreamingChannel(t,e){const r=await this.getClient();this.console.log(`Updating stream ${t} with params:`,JSON.stringify(e,null,2)),await r.updateStreamingChannel({channelId:t,...e})}async updateAudio(t){const e=await this.getClient();this.console.log("Updating audio with params:",JSON.stringify(t,null,2)),await e.updateTwoWayAudio(t)}async updateTime(t){const e=await this.getClient();this.console.log("Updating time with params:",JSON.stringify(t,null,2)),await e.updateTime(t)}async updateNTPServer(t){const e=await this.getClient();this.console.log("Updating NTP server with params:",JSON.stringify(t,null,2)),await e.updateNTPServer(t)}async updateOSD(t){const e=await this.getClient();this.console.log("Updating OSD with params:",JSON.stringify(t,null,2)),await e.updateOSD(t)}async updateVideoInputChannel(t){const e=await this.getClient();this.console.log(`Updating video input channel name to: ${t}`),await e.updateVideoInputChannel(t)}async updatePTZPreset(t,e){const r=await this.getClient();this.console.log(`Updating PTZ preset ${t} with name: ${e}`),await r.updatePTZPreset(t,e)}async deletePTZPreset(t){const e=await this.getClient();this.console.log(`Deleting PTZ preset ${t}`),await e.deletePTZPreset(t)}async gotoPTZPreset(t){const e=await this.getClient();this.console.log(`Going to PTZ preset ${t}`),await e.gotoPTZPreset(t)}async updateMotionDetection({enabled:t,motionSensitivity:e}){const r=await this.getClient(),i={enabled:t,motionSensitivity:e};this.console.log("Updating motion detection with params:",i),await r.updateMotionDetection(i)}async updateMotionEventTrigger({centerNotificationEnabled:t}){const e=await this.getClient();this.console.log("Updating motion event trigger with params:",{centerNotificationEnabled:t}),await e.updateMotionEventTrigger({centerNotificationEnabled:t})}async release(){this.killed=!0}async getDeviceProperties(){const t=await this.mixinDevice.getSettings(),e=(0,s.default)(t,(t=>t.key)),r=e.username?.value,i=e.password?.value,n=e.ip?.value;return{username:r,password:i,httpAddress:`${n}:${e.httpPort?.value||80}`,channel:e.rtspChannel?.value??"101",host:n}}async getClient(){if(!this.client){const{channel:t,httpAddress:e,username:r,password:i}=await this.getDeviceProperties();this.client=new a.HikvisionCameraAPI(e,r,i,t,this.console)}return this.client}async refreshSettings(){const t=[],e=this.generateInfoSettings();t.push(...e);const r=this.generateMotionSettings();t.push(...r);const i=this.generateStreamSettings(this.streamCaps);t.push(...i);const n=this.generateAudioSettings();t.push(...n);const o=this.generateTimeSettings();t.push(...o);const s=this.generateOSDSettings();t.push(...s);const a=this.generatePTZSettings();t.push(...a),this.storageSettings=await(0,u.convertSettingsToStorageSettings)({device:this,dynamicSettings:t,initStorage:this.initStorage}),this.setMotionSettingsValues(),this.setStreamSettingsValues(this.streamCaps),this.setAudioSettingsValues(),this.setTimeSettingsValues(),this.setOSDSettingsValues(),this.setPTZSettingsValues(),this.setInfoSettingsValues()}async getMixinSettings(){try{return this.storageSettings.getSettings()}catch(t){return this.console.error("Error in getMixinSettings",t),[]}}async putSetting(t,e){const[r,...i]=t.split(":");r===this.settingsGroupKey?this.storageSettings.putSetting(i.join(":"),e):super.putSetting(t,e)}async putMixinSetting(t,e){this.storageSettings.putSetting(t,e)}}e.default=c},3985:function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.HikvisionCameraAPI=void 0;const n=r(6125),o=i(r(8805)),s=r(6185);e.HikvisionCameraAPI=class{constructor(t,e,r,i,n){this.ip=t,this.console=n,this.channel="101",this.credential={username:e,password:r},i&&(this.channel=i)}async request(t,e){return await(0,n.authHttpFetch)({..."string"==typeof t||t instanceof URL?{url:t}:t,rejectUnauthorized:!1,credential:this.credential,body:"string"==typeof t||t instanceof URL?e:t?.body})}async getMotionCapabilities(){const t=String(this.channel?.[0]??1),e=await this.request({method:"GET",url:`http://${this.ip}//ISAPI/System/Video/inputs/channels/${t}/motionDetection/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),r=(await o.default.parseStringPromise(e.body)).MotionDetection,i="true"===r.enabled[0]?._,n=r.MotionDetectionLayout[0]?.sensitivityLevel[0],s=Number(n?.$?.min??"0"),a=Number(n?.$?.max??"100"),u=Number(n?.$?.step??"20"),c=[String(s)];for(let t=s+u;t<=a;t+=u)c.push(String(t));const p=Number(n?._??"0");return{xml:e.body,enabled:i,sensitivityLevel:p,sensitivityOptions:c}}async updateMotionDetection(t){const{enabled:e,motionSensitivity:r}=t,i=String(this.channel?.[0]??1);let{xml:n}=await this.getMotionCapabilities();void 0!==e&&(n=n.replace(/<enabled[^>]*>.*?<\/enabled>/s,`<enabled>${e}</enabled>`)),void 0!==r&&(n=n.replace(/<sensitivityLevel[^>]*>.*?<\/sensitivityLevel>/s,`<sensitivityLevel>${r}</sensitivityLevel>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/${i}/motionDetection`,responseType:"text",headers:{"Content-Type":"application/xml"},body:n})}async getStreamingChannels(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Streaming/channels`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"}),r=e.StreamingChannelList?.StreamingChannel?.map((t=>{const e=t.Video?.[0],r=t=>t?"string"==typeof t?{value:Number(t),min:32,max:16384}:{value:Number(t._||0),min:Number(t.$.min||32),max:Number(t.$.max||16384)}:{value:0,min:32,max:16384},i=r(e?.constantBitRate?.[0]),n=r(e?.vbrUpperCap?.[0]),o=e?.GovLength?.[0],a=(u=o)?"string"==typeof u?{value:Number(u),min:1,max:400}:{value:Number(u._||0),min:Number(u.$.min||1),max:Number(u.$.max||400)}:{value:0,min:1,max:400};var u;const c=t.Audio?.[0];return{id:t.id?.[0],channelName:t.channelName?.[0],enabled:"true"===t.enabled?.[0],audio:{enabled:"true"===c?.enabled?.[0],audioInputChannelID:Number(c?.audioInputChannelID?.[0]),audioCompressionType:c?.audioCompressionType?.[0]},video:{enabled:"true"===e?.enabled?.[0],videoCodecType:e?.videoCodecType?.[0],videoResolutionWidth:Number(e?.videoResolutionWidth?.[0]),videoResolutionHeight:Number(e?.videoResolutionHeight?.[0]),maxFrameRate:Number(e?.maxFrameRate?.[0]),maxFrameRateUI:(0,s.formatFrameRate)(Number(e?.maxFrameRate?.[0])),videoQualityControlType:e?.videoQualityControlType?.[0],constantBitRate:i.value,constantBitRateMin:i.min,constantBitRateMax:i.max,vbrUpperCap:n.value,vbrUpperCapMin:n.min,vbrUpperCapMax:n.max,fixedQuality:Number(e?.fixedQuality?.[0]),govLength:a.value,govLengthMin:a.min,govLengthMax:a.max,govLengthUI:(0,s.formatKeyFrameInterval)(a.value,Number(e?.maxFrameRate?.[0])),smoothing:Number(e?.smoothing?.[0]),H264Profile:e?.H264Profile?.[0],H265Profile:e?.H265Profile?.[0],smartCodecEnabled:"true"===e?.SmartCodec?.[0]?.enabled?.[0]}}}))||[];return{xml:t.body,json:e,channels:r}}async updateStreamingChannel(t){const{channelId:e,videoCodecType:r,videoResolutionWidth:i,videoResolutionHeight:n,maxFrameRate:o,vbrUpperCap:s,constantBitRate:a,govLength:u,fixedQuality:c,videoQualityControlType:p,smoothing:l,H264Profile:h,H265Profile:d,audioEnabled:m,smartCodecEnabled:f}=t;let{xml:y}=await this.getStreamingChannels();const g=e||this.channel,v=new RegExp(`(<StreamingChannel[^>]*>[\\s\\S]*?<id>${g}<\\/id>[\\s\\S]*?<\\/StreamingChannel>)`,"g");y=y.replace(v,(t=>{let e=t;return void 0!==r&&(e=e.replace(/<videoCodecType[^>]*>.*?<\/videoCodecType>/s,`<videoCodecType>${r}</videoCodecType>`)),void 0!==i&&(e=e.replace(/<videoResolutionWidth[^>]*>.*?<\/videoResolutionWidth>/s,`<videoResolutionWidth>${i}</videoResolutionWidth>`)),void 0!==n&&(e=e.replace(/<videoResolutionHeight[^>]*>.*?<\/videoResolutionHeight>/s,`<videoResolutionHeight>${n}</videoResolutionHeight>`)),void 0!==o&&(e=e.replace(/<maxFrameRate[^>]*>.*?<\/maxFrameRate>/s,`<maxFrameRate>${o}</maxFrameRate>`)),void 0!==s&&(e=e.replace(/<vbrUpperCap[^>]*>.*?<\/vbrUpperCap>/s,`<vbrUpperCap>${s}</vbrUpperCap>`)),void 0!==a&&(e=e.replace(/<constantBitRate[^>]*>.*?<\/constantBitRate>/s,`<constantBitRate>${a}</constantBitRate>`)),void 0!==u&&(e=e.replace(/<GovLength(\s+[^>]*)?>.*?<\/GovLength>/s,((t,e)=>`<GovLength${e||""}>${u}</GovLength>`))),void 0!==c&&(e=e.replace(/<fixedQuality[^>]*>.*?<\/fixedQuality>/s,`<fixedQuality>${c}</fixedQuality>`)),void 0!==p&&(e=e.replace(/<videoQualityControlType[^>]*>.*?<\/videoQualityControlType>/s,`<videoQualityControlType>${p}</videoQualityControlType>`)),void 0!==l&&(e=e.replace(/<smoothing[^>]*>.*?<\/smoothing>/s,`<smoothing>${l}</smoothing>`)),void 0!==h&&(e=e.replace(/<H264Profile[^>]*>.*?<\/H264Profile>/s,`<H264Profile>${h}</H264Profile>`)),void 0!==d&&(e=e.replace(/<H265Profile[^>]*>.*?<\/H265Profile>/s,`<H265Profile>${d}</H265Profile>`)),void 0!==m&&(e=e.replace(/<Audio[^>]*>([\s\S]*?)<enabled[^>]*>.*?<\/enabled>([\s\S]*?)<\/Audio>/s,((t,e,r)=>`<Audio${e.match(/^[^>]*/)?.[0]||""}>${e.replace(/^[^>]*/,"")}<enabled>${m}</enabled>${r}</Audio>`))),void 0!==f&&(e=e.replace(/<SmartCodec[^>]*>([\s\S]*?)<enabled[^>]*>.*?<\/enabled>([\s\S]*?)<\/SmartCodec>/s,((t,e,r)=>`<SmartCodec${e.match(/^[^>]*/)?.[0]||""}>${e.replace(/^[^>]*/,"")}<enabled>${f}</enabled>${r}</SmartCodec>`))),e}));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Streaming/channels/${g}`,responseType:"text",headers:{"Content-Type":"application/xml"},body:y})}async getStreamingChannelCapabilities(t){const e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Streaming/channels/${t}/dynamicCap`,responseType:"text",headers:{"Content-Type":"application/xml"}}),r=(await o.default.parseStringPromise(e.body)).DynamicCap,i=r.ResolutionAvailableDscriptorList?.[0]?.ResolutionAvailableDscriptor?.map((t=>({width:Number(t.videoResolutionWidth?.[0]),height:Number(t.videoResolutionHeight?.[0]),frameRates:t.supportedFrameRate?.[0]?.split(",").map((t=>{const e=Number(t);return{value:e,label:(0,s.formatFrameRate)(e)}}))||[]})))||[],n=r.CodecParamDscriptorList?.[0]?.CodecParamDscriptor?.map((t=>({type:t.videoCodecType?.[0],supportProfile:"true"===t.isSupportProfile?.[0],supportSVC:"true"===t.isSupportSVC?.[0],cbrSupported:"true"===t.CBRCap?.[0]?.isSupportSmooth?.[0],vbrSupported:"true"===t.VBRCap?.[0]?.isSupportSmooth?.[0],smartCodecCap:t.SmartCodecCap?.[0]?{readOnlyParams:t.SmartCodecCap[0].readOnlyParams?.[0]?.$?.opt?.split(",")||[],constantBitrateSupport:t.SmartCodecCap[0].BitrateType?.[0]?.Constant?.[0]?.support?.[0]?.$?.opt?.split(",")||[],variableBitrateSupport:t.SmartCodecCap[0].BitrateType?.[0]?.Variable?.[0]?.support?.[0]?.$?.opt?.split(",")||[]}:void 0})))||[],a=[...new Set(i.flatMap((t=>t.frameRates.map((t=>t.value)))))].sort(((t,e)=>e-t)).map((t=>({value:t,label:(0,s.formatFrameRate)(t)}))),u=[];return n.forEach((t=>{t.vbrSupported&&!u.includes("VBR")&&u.push("VBR"),t.cbrSupported&&!u.includes("CBR")&&u.push("CBR")})),{resolutions:i,videoCodecs:n,allFrameRates:a,qualityControlTypes:u}}async getStreamingCapabilities(){const{channels:t}=await this.getStreamingChannels();return await Promise.all(t.map((async t=>{const e=await this.getStreamingChannelCapabilities(t.id);return{...t,capabilities:e}})))}async getTwoWayAudioCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/TwoWayAudio/channels/1/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).TwoWayAudioChannel,r=e.audioCompressionType?.[0],i="object"==typeof r?r.$.opt.split(","):[],n=e.audioInputType?.[0],s="object"==typeof n?n.$.opt.split(","):[],a=e.speakerVolume?.[0];return{audioCodecs:i,audioInputTypes:s,speakerVolumeMin:"object"==typeof a?Number(a.$.min):0,speakerVolumeMax:"object"==typeof a?Number(a.$.max):100,supportsNoiseReduction:e.noisereduce?.[0]?.$.opt?.includes("true")||!1}}async getTwoWayAudio(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/TwoWayAudio/channels/1`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).TwoWayAudioChannel;return{xml:t.body,enabled:"true"===e.enabled?.[0],audioCompressionType:e.audioCompressionType?.[0],speakerVolume:Number(e.speakerVolume?.[0]),noiseReduction:"true"===e.noisereduce?.[0],audioInputType:e.audioInputType?.[0]}}async updateTwoWayAudio(t){let{xml:e}=await this.getTwoWayAudio();void 0!==t.audioCompressionType&&(e=e.replace(/<audioCompressionType[^>]*>.*?<\/audioCompressionType>/s,`<audioCompressionType>${t.audioCompressionType}</audioCompressionType>`)),void 0!==t.speakerVolume&&(e=e.replace(/<speakerVolume[^>]*>.*?<\/speakerVolume>/s,`<speakerVolume>${t.speakerVolume}</speakerVolume>`)),void 0!==t.noiseReduction&&(e=e.replace(/<noisereduce[^>]*>.*?<\/noisereduce>/s,`<noisereduce>${t.noiseReduction}</noisereduce>`)),void 0!==t.audioInputType&&(e=e.replace(/<audioInputType[^>]*>.*?<\/audioInputType>/s,`<audioInputType>${t.audioInputType}</audioInputType>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/TwoWayAudio/channels/1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async getTimeCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/time/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).Time,r=e.timeMode?.[0];return{timeModes:"object"==typeof r?r.$.opt.split(","):[]}}async getTime(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/time`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).Time;return{xml:t.body,timeMode:e.timeMode?.[0],localTime:e.localTime?.[0],timeZone:e.timeZone?.[0]}}async getNTPServer(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/time/ntpServers/1`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).NTPServer;return{xml:t.body,ipAddress:e.ipAddress?.[0],portNo:Number(e.portNo?.[0]),synchronizeInterval:Number(e.synchronizeInterval?.[0])}}async updateTime(t){let{xml:e}=await this.getTime();void 0!==t.timeMode&&(e=e.replace(/<timeMode[^>]*>.*?<\/timeMode>/s,`<timeMode>${t.timeMode}</timeMode>`)),void 0!==t.localTime&&(e=e.replace(/<localTime[^>]*>.*?<\/localTime>\s*/s,""),e=e.replace(/(<timeMode>[^<]*<\/timeMode>)/s,`$1\n    <localTime>${t.localTime}</localTime>`)),void 0!==t.timeZone&&(e=e.replace(/<timeZone[^>]*>.*?<\/timeZone>/s,`<timeZone>${t.timeZone}</timeZone>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/time`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async updateNTPServer(t){let{xml:e}=await this.getNTPServer();void 0!==t.ipAddress&&(e=e.replace(/<ipAddress[^>]*>.*?<\/ipAddress>/s,`<ipAddress>${t.ipAddress}</ipAddress>`)),void 0!==t.portNo&&(e=e.replace(/<portNo[^>]*>.*?<\/portNo>/s,`<portNo>${t.portNo}</portNo>`)),void 0!==t.synchronizeInterval&&(e=e.replace(/<synchronizeInterval[^>]*>.*?<\/synchronizeInterval>/s,`<synchronizeInterval>${t.synchronizeInterval}</synchronizeInterval>`));return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/time/ntpServers/1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async getMotionEventTrigger(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/Event/triggers/VMD-1`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).EventTrigger,r=(e.EventTriggerNotificationList?.[0]?.EventTriggerNotification||[]).some((t=>"center"===t.notificationMethod?.[0]));return{xml:t.body,centerNotificationEnabled:r}}async updateMotionEventTrigger(t){let{xml:e}=await this.getMotionEventTrigger();if(void 0!==t.centerNotificationEnabled){const r=await o.default.parseStringPromise(e,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"}),i=(r.EventTrigger.EventTriggerNotificationList?.[0]?.EventTriggerNotification||[]).filter((t=>"center"!==t.notificationMethod?.[0]));t.centerNotificationEnabled&&i.push({id:["center"],notificationMethod:["center"]}),r.EventTrigger.EventTriggerNotificationList||(r.EventTrigger.EventTriggerNotificationList=[{}]),r.EventTrigger.EventTriggerNotificationList[0].EventTriggerNotification=i,delete r.EventTrigger.$.version,delete r.EventTrigger.$.xmlns,delete r.EventTrigger.eventDescription,delete r.EventTrigger.dynVideoInputChannelID,i.forEach((t=>{delete t.notificationRecurrence}));e=new o.default.Builder({headless:!1,renderOpts:{pretty:!1}}).buildObject(r)}return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/Event/triggers/VMD-1`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}async getOSDCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).VideoOverlay;return{xml:t.body,textOverlayListSize:Number(e.TextOverlayList?.[0]?.$?.size||0),dateTimeOverlay:e.DateTimeOverlay?.[0],channelNameOverlay:e.channelNameOverlay?.[0]}}async getOSD(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).VideoOverlay;return{xml:t.body,normalizedScreenWidth:Number(e.normalizedScreenSize?.[0]?.normalizedScreenWidth?.[0]||704),normalizedScreenHeight:Number(e.normalizedScreenSize?.[0]?.normalizedScreenHeight?.[0]||576),textOverlayList:e.TextOverlayList?.[0]?.TextOverlay||[],dateTimeOverlay:e.DateTimeOverlay?.[0],channelNameOverlay:e.channelNameOverlay?.[0]}}async updateOSD(t){const e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays`,responseType:"text",headers:{"Content-Type":"application/xml"}}),r=await o.default.parseStringPromise(e.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"}),i=r.VideoOverlay;if(t.dateTimeOverlay){const e=i.DateTimeOverlay?.[0];e&&(void 0!==t.dateTimeOverlay.enabled&&(e.enabled=[String(t.dateTimeOverlay.enabled)]),void 0!==t.dateTimeOverlay.dateStyle&&(e.dateStyle=[t.dateTimeOverlay.dateStyle]),void 0!==t.dateTimeOverlay.timeStyle&&(e.timeStyle=[t.dateTimeOverlay.timeStyle]),void 0!==t.dateTimeOverlay.displayWeek&&(e.displayWeek=[String(t.dateTimeOverlay.displayWeek)]),void 0!==t.dateTimeOverlay.positionX&&(e.positionX=[String(t.dateTimeOverlay.positionX)]),void 0!==t.dateTimeOverlay.positionY&&(e.positionY=[String(t.dateTimeOverlay.positionY)]))}if(t.channelNameOverlay){const e=i.channelNameOverlay?.[0];e&&(void 0!==t.channelNameOverlay.enabled&&(e.enabled=[String(t.channelNameOverlay.enabled)]),void 0!==t.channelNameOverlay.positionX&&(e.positionX=[String(t.channelNameOverlay.positionX)]),void 0!==t.channelNameOverlay.positionY&&(e.positionY=[String(t.channelNameOverlay.positionY)]))}if(t.textOverlays){const e=i.TextOverlayList?.[0]?.TextOverlay||[];for(const r of t.textOverlays){let t=e.find((t=>t.id?.[0]===r.id));t||(t={id:[r.id],enabled:["false"],positionX:["0"],positionY:["0"],displayText:[""],isPersistentText:["true"]},e.push(t)),void 0!==r.enabled&&(t.enabled=[String(r.enabled)]),void 0!==r.displayText&&(t.displayText=[r.displayText]),void 0!==r.positionX&&(t.positionX=[String(r.positionX)]),void 0!==r.positionY&&(t.positionY=[String(r.positionY)])}i.TextOverlayList?i.TextOverlayList[0].TextOverlay=e:i.TextOverlayList=[{$:{size:"8"},TextOverlay:e}]}delete i.$.version,delete i.$.xmlns;const n=new o.default.Builder({headless:!1,renderOpts:{pretty:!1}}).buildObject(r);return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/1/overlays`,responseType:"text",headers:{"Content-Type":"application/xml"},body:n})}async getPTZCapabilities(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/capabilities`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).PTZChanelCap,r=(e.PresetNameCap?.[0]?.specialNo?.[0]?.$?.opt||"").split(",").map(Number);return{xml:t.body,maxPresetNum:Number(e.maxPresetNum?.[0]||0),specialNos:r}}async getPTZPresets(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets`,responseType:"text",headers:{"Content-Type":"application/xml"}});return(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).PTZPresetList.PTZPreset||[]}async updatePTZPreset(t,e){const r=`<?xml version="1.0" encoding="UTF-8"?>\n<PTZPreset xmlns="http://www.isapi.org/ver20/XMLSchema" version="2.0">\n    <id>${t}</id>\n    <presetName>${e}</presetName>\n</PTZPreset>`;return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets/${t}`,responseType:"text",headers:{"Content-Type":"application/xml"},body:r})}async deletePTZPreset(t){return await this.request({method:"DELETE",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets/${t}`,responseType:"text",headers:{"Content-Type":"application/xml"}})}async gotoPTZPreset(t){return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/PTZCtrl/channels/1/presets/${t}/goto`,responseType:"text",headers:{"Content-Type":"application/xml"}})}async getDeviceInfo(){const t=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/deviceInfo`,responseType:"text",headers:{"Content-Type":"application/xml"}}),e=(await o.default.parseStringPromise(t.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"})).DeviceInfo||{};return{xml:t.body,deviceName:e.deviceName?.[0],model:e.model?.[0],serialNumber:e.serialNumber?.[0],macAddress:e.macAddress?.[0],firmwareVersion:e.firmwareVersion?.[0],firmwareReleasedDate:e.firmwareReleasedDate?.[0],deviceType:e.deviceType?.[0]}}async getVideoInputChannel(){const t=String(this.channel?.[0]??1),e=await this.request({method:"GET",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/${t}`,responseType:"text",headers:{"Content-Type":"application/xml"}}),r=await o.default.parseStringPromise(e.body,{explicitArray:!0,mergeAttrs:!1,attrkey:"$",charkey:"_"});return{xml:e.body,id:r.VideoInputChannel?.id?.[0],name:r.VideoInputChannel?.name?.[0],videoFormat:r.VideoInputChannel?.videoFormat?.[0]}}async updateVideoInputChannel(t){const{xml:e}=await this.getVideoInputChannel();let r=e;r=r.includes("<name>")?r.replace(/<name>.*?<\/name>/,`<name>${t}</name>`):r.replace("</VideoInputChannel>",`  <name>${t}</name>\n</VideoInputChannel>`);const i=String(this.channel?.[0]??1);return await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/Video/inputs/channels/${i}`,responseType:"text",headers:{"Content-Type":"application/xml"},body:r})}async updateDeviceInfo(t){let{xml:e}=await this.getDeviceInfo();return e=e.includes("<deviceName>")?e.replace(/<deviceName>.*?<\/deviceName>/,`<deviceName>${t}</deviceName>`):e.replace("</DeviceInfo>",`  <deviceName>${t}</deviceName>\n</DeviceInfo>`),await this.request({method:"PUT",url:`http://${this.ip}/ISAPI/System/deviceInfo`,responseType:"text",headers:{"Content-Type":"application/xml"},body:e})}}},7927:function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=r(7562),o=r(6117),s=i(r(2112)),a=r(6185);class u extends n.ScryptedDeviceBase{constructor(t){super(t),this.storageSettings=new o.StorageSettings(this,{}),this.mixinsMap={},this.init().catch(this.console.log)}async init(){}async getSettings(){return await this.storageSettings.getSettings()}putSetting(t,e){return this.storageSettings.putSetting(t,e)}async canMixin(t,e){return[n.ScryptedInterface.Camera,n.ScryptedInterface.VideoCamera].some((t=>e.includes(t)))?[a.HIKVISION_UTILITIES_INTERFACE,n.ScryptedInterface.Settings]:void 0}async getMixin(t,e,r){return new s.default({mixinDevice:t,mixinDeviceInterfaces:e,mixinDeviceState:r,mixinProviderNativeId:this.nativeId,group:"Hikvision utilities",groupKey:"hikvisionUtilities"},this)}async releaseMixin(t,e){await e.release()}}e.default=u},6185:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.convertSettingsToStorageSettings=e.generateBitrateChoices=e.HIKVISION_UTILITIES_INTERFACE=void 0,e.formatFrameRate=function(t){if(t>=100)return String(t/100);return`1/${Math.round(100/t)}`},e.parseFrameRate=function(t){if(t.includes("/")){const[e,r]=t.split("/").map(Number);return Math.round(e/r*100)}return 100*Number(t)},e.formatKeyFrameInterval=function(t,e){const r=e/100;return Math.round(t/r)},e.parseKeyFrameInterval=function(t,e){const r=e/100;return Math.round(t*r)};const i=r(6117);e.HIKVISION_UTILITIES_INTERFACE="HIKVISION_UTILITIES";e.generateBitrateChoices=(t,e)=>{const r=[],i=[32,64,128,256,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,20480,24576,32768];for(const n of i)n>=t&&n<=e&&r.push(String(n));return r.includes(String(t))||r.unshift(String(t)),r.includes(String(e))||r.push(String(e)),r};e.convertSettingsToStorageSettings=async t=>{const{device:e,dynamicSettings:r,initStorage:n}=t,o={};Object.entries(n).forEach((([t,e])=>{e.onPut&&(o[t]=e.onPut)}));const s=await new i.StorageSettings(e,n).getSettings();s.push(...r);const a={};for(const t of s){const{value:r,key:i,onPut:n,...o}=t;a[i]={...o,value:"html"===o.type?r:void 0},t.onPut&&(a[i].onPut=t.onPut.bind(e))}const u=new i.StorageSettings(e,a);return Object.entries(o).forEach((([t,e])=>{u.settings[t].onPut=e})),u}},6125:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.authHttpFetch=void 0;const i=r(4171),n=r(5892);e.authHttpFetch=(0,n.createAuthFetch)(i.httpFetch,i.httpFetchParseIncomingMessage)},5892:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createAuthFetch=function(t,e){return async o=>{const s=(0,i.getFetchMethod)(o),a=(0,i.createHeadersArray)(o.headers);o.headers=a,(0,i.setDefaultHttpFetchAccept)(a,o.responseType);const u=await n(o,o.url,s);u&&!(0,i.hasHeader)(a,"Authorization")&&(0,i.setHeader)(a,"Authorization",u);const c=new AbortController;o.signal?.addEventListener("abort",(()=>c.abort(o.signal?.reason)));const p=await t({...o,signal:c.signal,checkStatusCode(t){if(401===t&&o.credential)return!0;if(void 0===o?.checkStatusCode||o?.checkStatusCode){return("function"==typeof o?.checkStatusCode?o.checkStatusCode:i.checkStatus)(t)}return!0},responseType:"readable"});if(401!==p.statusCode)return{...p,body:await e(p.body,o.responseType)};let l=p.headers.get("www-authenticate");if(!l)throw new Error("Did not find WWW-Authenticate header.");"string"==typeof l&&(l=[l]);const{BASIC:h,DIGEST:d,parseWWWAuthenticateHeader:m}=await Promise.resolve().then(r.bind(r,841)),f=l.map((t=>m(t))),y=f.find((t=>"Digest"===t.type)),g=f.find((t=>"Basic"===t.type)),v=o.credential;if(v.digest=y,v.basic=g,!y&&!g)throw new Error(`Unknown WWW-Authenticate type: ${f[0]?.type}`);const b=await n(o,o.url,s);return b&&(0,i.setHeader)(a,"Authorization",b),t(o)}};const i=r(7796);async function n(t,e,i){if(!t.credential)return;const{BASIC:n,DIGEST:o,parseWWWAuthenticateHeader:s}=await Promise.resolve().then(r.bind(r,841)),a=t.credential,{digest:u,basic:c}=a;if(u){a.count||=0,++a.count;const n=("00000000"+a.count).slice(-8),o=[...Array(24)].map((()=>Math.floor(16*Math.random()).toString(16))).join(""),s=new URL(e),c=s.pathname+s.search,{DIGEST:p,buildAuthorizationHeader:l}=await Promise.resolve().then(r.bind(r,841)),h=p.computeHash({username:t.credential.username,password:t.credential.password,method:i,uri:c,nc:n,cnonce:o,algorithm:"MD5",qop:u.data.qop,...u.data});return l(p,{username:t.credential.username,uri:c,nc:n,cnonce:o,algorithm:u.data.algorithm,qop:u.data.qop,response:h,...u.data})}if(c){const{BASIC:e,buildAuthorizationHeader:i}=await Promise.resolve().then(r.bind(r,841));return i(e,{username:t.credential.username,password:t.credential.password})}}},4171:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getHttpFetchParser=c,e.httpFetchParseIncomingMessage=p,e.httpFetch=async function(t){const e=(0,i.createHeadersArray)(t.headers);(0,i.setDefaultHttpFetchAccept)(e,t.responseType);const{once:o}=r(4434),{PassThrough:s,Readable:a}=r(2203),{http:u,https:c}=r(1783),{url:l}=t,h=l.toString().startsWith("https:")?c:u;let d,m,{body:f}=t;if(f&&!(f instanceof a)){const t=new s;t.write(Buffer.from((0,i.createStringOrBufferBody)(e,f))),t.end(),f=t}t.timeout&&(d=new AbortController,m=setTimeout((()=>d.abort()),t.timeout),t.signal?.addEventListener("abort",(()=>d.abort(t.signal?.reason))));const y=d?.signal||t.signal;y?.addEventListener("abort",(()=>v.destroy(new Error(t.signal?.reason||"abort"))));const g={};for(const[t,r]of e)g[t]?g[t].push(r):g[t]=[r];const v=h.request(l,{method:(0,i.getFetchMethod)(t),rejectUnauthorized:t.rejectUnauthorized,family:t.family,headers:g,signal:y,timeout:t.timeout});f?f.pipe(v):v.end();try{const[e]=await o(v,"response");if(void 0===t?.checkStatusCode||t?.checkStatusCode)try{const r="function"==typeof t?.checkStatusCode?t.checkStatusCode:i.checkStatus;if(!e.statusCode||!r(e.statusCode))throw new Error(`http response statusCode ${e.statusCode}`)}catch(t){throw n(e).catch((()=>{})),t}const r=new Headers;for(const[t,i]of Object.entries(e.headers))for(const e of"string"==typeof i?[i]:i)r.append(t,e);return{statusCode:e.statusCode,headers:r,body:await p(e,t.responseType)}}finally{clearTimeout(m)}};const i=r(7796);async function n(t){const e=[];t.on("data",(t=>e.push(t)));const{once:i}=r(4434);return await i(t,"end"),Buffer.concat(e)}const o={parse:async t=>(await n(t)).toString()},s={parse:async t=>JSON.parse((await n(t)).toString())},a={parse:async t=>n(t)},u={parse:async t=>t};function c(t){switch(t){case"json":return s;case"text":return o;case"readable":return u}return a}function p(t,e){return c(e).parse(t)}},7796:(t,e)=>{"use strict";function r(t){return t>=200&&t<=299}function i(t){if(!r(t))throw new Error(`http response statusCode ${t}`);return!0}function n(t){return t.method||(t.body?"POST":"GET")}function o(t){switch(t){case"json":return"application/json";case"text":return"text/plain"}}function s(t,e){return e=e.toLowerCase(),t.find((([t])=>t.toLowerCase()===e))}function a(t,e){e=e.toLowerCase();const r=t.filter((([t,r])=>t.toLowerCase()!==e));t.length=0,r.forEach((e=>t.push(e)))}function u(t,e,r){a(t,e),t.push([e,r])}function c(t,e){if(s(t,"Accept"))return;const r=o(e);r&&u(t,"Accept",r)}function p(t){const e=[];if(!t)return e;if(t instanceof Headers){for(const[r,i]of t.entries())e.push([r,i]);return e}if(t instanceof Array){for(const[r,i]of t)e.push([r,i]);return e}for(const r of Object.keys(t)){const i=t[r];e.push([r,i])}return e}function l(t,e){let r;return"object"==typeof e?(e=JSON.stringify(e),r="application/json"):"string"==typeof e&&(r="text/plain"),r&&!s(t,"Content-Type")&&u(t,"Content-Type",r),s(t,"Content-Length")||u(t,"Content-Length",(e=Buffer.from(e)).length.toString()),e}async function h(t,e){switch(e){case"json":return t.json();case"text":return t.text();case"readable":return t}return new Uint8Array(await t.arrayBuffer())}Object.defineProperty(e,"__esModule",{value:!0}),e.fetchStatusCodeOk=r,e.checkStatus=i,e.getFetchMethod=n,e.getHttpFetchAccept=o,e.hasHeader=s,e.removeHeader=a,e.setHeader=u,e.setDefaultHttpFetchAccept=c,e.createHeadersArray=p,e.createStringOrBufferBody=l,e.domFetchParseIncomingMessage=h,e.domFetch=async function(t){const e=p(t.headers);c(e,t.responseType);let r,o,{body:s}=t;!s||s instanceof ReadableStream||(s=l(e,s));t.timeout&&(r=new AbortController,o=setTimeout((()=>r.abort()),t.timeout),t.signal?.addEventListener("abort",(()=>r.abort(t.signal?.reason))));try{const{url:o}=t,a=await fetch(o,{method:n(t),credentials:t.withCredentials?"include":void 0,headers:e,signal:r?.signal||t.signal,body:s});if(void 0===t?.checkStatusCode||t?.checkStatusCode)try{if(!("function"==typeof t?.checkStatusCode?t.checkStatusCode:i)(a.status))throw new Error(`http response statusCode ${a.status}`)}catch(t){throw a.arrayBuffer().catch((()=>{})),t}return{statusCode:a.status,headers:a.headers,body:await h(a,t.responseType)}}finally{clearTimeout(o)}}},3177:function(t,e){(function(){"use strict";e.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},6712:function(t,e,r){(function(){"use strict";var t,i,n,o,s,a={}.hasOwnProperty;t=r(9665),i=r(6465).defaults,o=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},s=function(t){return"<![CDATA["+n(t)+"]]>"},n=function(t){return t.replace("]]>","]]]]><![CDATA[>")},e.Builder=function(){function e(t){var e,r,n;for(e in this.options={},r=i[.2])a.call(r,e)&&(n=r[e],this.options[e]=n);for(e in t)a.call(t,e)&&(n=t[e],this.options[e]=n)}return e.prototype.buildObject=function(e){var r,n,u,c,p,l;return r=this.options.attrkey,n=this.options.charkey,1===Object.keys(e).length&&this.options.rootName===i[.2].rootName?e=e[p=Object.keys(e)[0]]:p=this.options.rootName,l=this,u=function(t,e){var i,c,p,h,d,m;if("object"!=typeof e)l.options.cdata&&o(e)?t.raw(s(e)):t.txt(e);else if(Array.isArray(e)){for(h in e)if(a.call(e,h))for(d in c=e[h])p=c[d],t=u(t.ele(d),p).up()}else for(d in e)if(a.call(e,d))if(c=e[d],d===r){if("object"==typeof c)for(i in c)m=c[i],t=t.att(i,m)}else if(d===n)t=l.options.cdata&&o(c)?t.raw(s(c)):t.txt(c);else if(Array.isArray(c))for(h in c)a.call(c,h)&&(t="string"==typeof(p=c[h])?l.options.cdata&&o(p)?t.ele(d).raw(s(p)).up():t.ele(d,p).up():u(t.ele(d),p).up());else"object"==typeof c?t=u(t.ele(d),c).up():"string"==typeof c&&l.options.cdata&&o(c)?t=t.ele(d).raw(s(c)).up():(null==c&&(c=""),t=t.ele(d,c.toString()).up());return t},c=t.create(p,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),u(c,e).end(this.options.renderOpts)},e}()}).call(this)},6465:function(t,e){(function(){e.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},1912:function(t,e,r){(function(){"use strict";var t,i,n,o,s,a,u,c,p,l=function(t,e){return function(){return t.apply(e,arguments)}},h={}.hasOwnProperty;c=r(4043),o=r(4434),t=r(3177),u=r(2114),p=r(3557).setImmediate,i=r(6465).defaults,s=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},a=function(t,e,r){var i,n;for(i=0,n=t.length;i<n;i++)e=(0,t[i])(e,r);return e},n=function(t,e,r){var i;return(i=Object.create(null)).value=r,i.writable=!0,i.enumerable=!0,i.configurable=!0,Object.defineProperty(t,e,i)},e.Parser=function(r){function o(t){var r,n,o;if(this.parseStringPromise=l(this.parseStringPromise,this),this.parseString=l(this.parseString,this),this.reset=l(this.reset,this),this.assignOrPush=l(this.assignOrPush,this),this.processAsync=l(this.processAsync,this),!(this instanceof e.Parser))return new e.Parser(t);for(r in this.options={},n=i[.2])h.call(n,r)&&(o=n[r],this.options[r]=o);for(r in t)h.call(t,r)&&(o=t[r],this.options[r]=o);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(u.normalize)),this.reset()}return function(t,e){for(var r in e)h.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(o,r),o.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),p(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},o.prototype.assignOrPush=function(t,e,r){return e in t?(t[e]instanceof Array||n(t,e,[t[e]]),t[e].push(r)):this.options.explicitArray?n(t,e,[r]):n(t,e,r)},o.prototype.reset=function(){var t,e,r,i,o;return this.removeAllListeners(),this.saxParser=c.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(o=this,function(t){if(o.saxParser.resume(),!o.saxParser.errThrown)return o.saxParser.errThrown=!0,o.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,i=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(r){return function(o){var s,u,c,p,l;if((c={})[e]="",!r.options.ignoreAttrs)for(s in l=o.attributes)h.call(l,s)&&(t in c||r.options.mergeAttrs||(c[t]={}),u=r.options.attrValueProcessors?a(r.options.attrValueProcessors,o.attributes[s],s):o.attributes[s],p=r.options.attrNameProcessors?a(r.options.attrNameProcessors,s):s,r.options.mergeAttrs?r.assignOrPush(c,p,u):n(c[t],p,u));return c["#name"]=r.options.tagNameProcessors?a(r.options.tagNameProcessors,o.name):o.name,r.options.xmlns&&(c[r.options.xmlnskey]={uri:o.uri,local:o.local}),i.push(c)}}(this),this.saxParser.onclosetag=function(t){return function(){var r,o,u,c,p,l,d,m,f,y;if(l=i.pop(),p=l["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete l["#name"],!0===l.cdata&&(r=l.cdata,delete l.cdata),f=i[i.length-1],l[e].match(/^\s*$/)&&!r?(o=l[e],delete l[e]):(t.options.trim&&(l[e]=l[e].trim()),t.options.normalize&&(l[e]=l[e].replace(/\s{2,}/g," ").trim()),l[e]=t.options.valueProcessors?a(t.options.valueProcessors,l[e],p):l[e],1===Object.keys(l).length&&e in l&&!t.EXPLICIT_CHARKEY&&(l=l[e])),s(l)&&(l="function"==typeof t.options.emptyTag?t.options.emptyTag():""!==t.options.emptyTag?t.options.emptyTag:o),null!=t.options.validator&&(y="/"+function(){var t,e,r;for(r=[],t=0,e=i.length;t<e;t++)c=i[t],r.push(c["#name"]);return r}().concat(p).join("/"),function(){var e;try{return l=t.options.validator(y,f&&f[p],l)}catch(r){return e=r,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof l)if(t.options.preserveChildrenOrder){if(f){for(u in f[t.options.childkey]=f[t.options.childkey]||[],d={},l)h.call(l,u)&&n(d,u,l[u]);f[t.options.childkey].push(d),delete l["#name"],1===Object.keys(l).length&&e in l&&!t.EXPLICIT_CHARKEY&&(l=l[e])}}else c={},t.options.attrkey in l&&(c[t.options.attrkey]=l[t.options.attrkey],delete l[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in l&&(c[t.options.charkey]=l[t.options.charkey],delete l[t.options.charkey]),Object.getOwnPropertyNames(l).length>0&&(c[t.options.childkey]=l),l=c;return i.length>0?t.assignOrPush(f,p,l):(t.options.explicitRoot&&(m=l,n(l={},p,m)),t.resultObject=l,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),r=function(t){return function(r){var n,o;if(o=i[i.length-1])return o[e]+=r,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==r.replace(/\\n/g,"").trim())&&(o[t.options.childkey]=o[t.options.childkey]||[],(n={"#name":"__text__"})[e]=r,t.options.normalize&&(n[e]=n[e].replace(/\s{2,}/g," ").trim()),o[t.options.childkey].push(n)),o}}(this),this.saxParser.ontext=r,this.saxParser.oncdata=function(t){var e;if(e=r(t))return e.cdata=!0}},o.prototype.parseString=function(e,r){var i;null!=r&&"function"==typeof r&&(this.on("end",(function(t){return this.reset(),r(null,t)})),this.on("error",(function(t){return this.reset(),r(t)})));try{return""===(e=e.toString()).trim()?(this.emit("end",null),!0):(e=t.stripBOM(e),this.options.async?(this.remaining=e,p(this.processAsync),this.saxParser):this.saxParser.write(e).close())}catch(t){if(i=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",i),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw i}},o.prototype.parseStringPromise=function(t){return new Promise((e=this,function(r,i){return e.parseString(t,(function(t,e){return t?i(t):r(e)}))}));var e},o}(o),e.parseString=function(t,r,i){var n,o;return null!=i?("function"==typeof i&&(n=i),"object"==typeof r&&(o=r)):("function"==typeof r&&(n=r),o={}),new e.Parser(o).parseString(t,n)},e.parseStringPromise=function(t,r){var i;return"object"==typeof r&&(i=r),new e.Parser(i).parseStringPromise(t)}}).call(this)},2114:function(t,e){(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),e.normalize=function(t){return t.toLowerCase()},e.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.stripPrefix=function(e){return e.replace(t,"")},e.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},e.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},8805:function(t,e,r){(function(){"use strict";var t,i,n,o,s={}.hasOwnProperty;i=r(6465),t=r(6712),n=r(1912),o=r(2114),e.defaults=i.defaults,e.processors=o,e.ValidationError=function(){function t(t){this.message=t}return function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(t,Error),t}(),e.Builder=t.Builder,e.Parser=n.Parser,e.parseString=n.parseString,e.parseStringPromise=n.parseStringPromise}).call(this)},4923:function(t){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},1737:function(t){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},9241:function(t){(function(){var e,r,i,n,o,s,a,u=[].slice,c={}.hasOwnProperty;e=function(){var t,e,r,i,n,s;if(s=arguments[0],n=2<=arguments.length?u.call(arguments,1):[],o(Object.assign))Object.assign.apply(null,arguments);else for(t=0,r=n.length;t<r;t++)if(null!=(i=n[t]))for(e in i)c.call(i,e)&&(s[e]=i[e]);return s},o=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},s=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},i=function(t){return o(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},n=function(t){var e;if(i(t))return!t.length;for(e in t)if(c.call(t,e))return!1;return!0},a=function(t){var e,r;return s(t)&&(r=Object.getPrototypeOf(t))&&(e=r.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},r=function(t){return o(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=o,t.exports.isObject=s,t.exports.isArray=i,t.exports.isEmpty=n,t.exports.isPlainObject=a,t.exports.getValue=r}).call(this)},8753:function(t){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},4238:function(t,e,r){(function(){var e;e=r(1737),r(468),t.exports=function(){function t(t,r,i){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==r)throw new Error("Missing attribute name. "+this.debugInfo(r));this.name=this.stringify.name(r),this.value=this.stringify.attValue(i),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},t.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},t.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&(t.prefix===this.prefix&&(t.localName===this.localName&&t.value===this.value))},t}()}).call(this)},2691:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;e=r(1737),i=r(7457),t.exports=function(t){function r(t,i){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(i)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},7457:function(t,e,r){(function(){var e,i={}.hasOwnProperty;e=r(468),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t),this.value=""}return function(t,e){for(var r in e)i.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceData=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(t){return!!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},e}(e)}).call(this)},2679:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;e=r(1737),i=r(7457),t.exports=function(t){function r(t,i){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(i)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},3074:function(t,e,r){(function(){var e,i;e=r(5660),i=r(2527),t.exports=function(){function t(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),t.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},t.prototype.canSetParameter=function(t,e){return!0},t.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},t}()}).call(this)},5660:function(t){(function(){t.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}).call(this)},7260:function(t){(function(){t.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,r){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,r){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},2527:function(t){(function(){t.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}).call(this)},4111:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;i=r(468),e=r(1737),t.exports=function(t){function r(t,i,n,o,s,a){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==n)throw new Error("Missing DTD attribute name. "+this.debugInfo(i));if(!o)throw new Error("Missing DTD attribute type. "+this.debugInfo(i));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(i));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(i));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(i));this.elementName=this.stringify.name(i),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(n),this.attributeType=this.stringify.dtdAttType(o),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},7696:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;i=r(468),e=r(1737),t.exports=function(t){function r(t,i,n){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());n||(n="(#PCDATA)"),Array.isArray(n)&&(n="("+n.join(",")+")"),this.name=this.stringify.name(i),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(n)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},5529:function(t,e,r){(function(){var e,i,n,o={}.hasOwnProperty;n=r(9241).isObject,i=r(468),e=r(1737),t.exports=function(t){function r(t,i,o,s){if(r.__super__.constructor.call(this,t),null==o)throw new Error("Missing DTD entity name. "+this.debugInfo(o));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(o));if(this.pe=!!i,this.name=this.stringify.name(o),this.type=e.EntityDeclaration,n(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(o));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(o));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(o))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},8012:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;i=r(468),e=r(1737),t.exports=function(t){function r(t,i,n){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing DTD notation name. "+this.debugInfo(i));if(!n.pubID&&!n.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(i));this.name=this.stringify.name(i),this.type=e.NotationDeclaration,null!=n.pubID&&(this.pubID=this.stringify.dtdPubID(n.pubID)),null!=n.sysID&&(this.sysID=this.stringify.dtdSysID(n.sysID))}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),r.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},4130:function(t,e,r){(function(){var e,i,n,o={}.hasOwnProperty;n=r(9241).isObject,i=r(468),e=r(1737),t.exports=function(t){function r(t,i,o,s){var a;r.__super__.constructor.call(this,t),n(i)&&(i=(a=i).version,o=a.encoding,s=a.standalone),i||(i="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(i),null!=o&&(this.encoding=this.stringify.xmlEncoding(o)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},6376:function(t,e,r){(function(){var e,i,n,o,s,a,u,c,p={}.hasOwnProperty;c=r(9241).isObject,u=r(468),e=r(1737),i=r(4111),o=r(5529),n=r(7696),s=r(8012),a=r(4797),t.exports=function(t){function r(t,i,n){var o,s,a,u,p,l;if(r.__super__.constructor.call(this,t),this.type=e.DocType,t.children)for(s=0,a=(u=t.children).length;s<a;s++)if((o=u[s]).type===e.Element){this.name=o.name;break}this.documentObject=t,c(i)&&(i=(p=i).pubID,n=p.sysID),null==n&&(n=(l=[i,n])[0],i=l[1]),null!=i&&(this.pubID=this.stringify.dtdPubID(i)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}return function(t,e){for(var r in e)p.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"entities",{get:function(){var t,r,i,n,o;for(n={},r=0,i=(o=this.children).length;r<i;r++)(t=o[r]).type!==e.EntityDeclaration||t.pe||(n[t.name]=t);return new a(n)}}),Object.defineProperty(r.prototype,"notations",{get:function(){var t,r,i,n,o;for(n={},r=0,i=(o=this.children).length;r<i;r++)(t=o[r]).type===e.NotationDeclaration&&(n[t.name]=t);return new a(n)}}),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),r.prototype.element=function(t,e){var r;return r=new n(this,t,e),this.children.push(r),this},r.prototype.attList=function(t,e,r,n,o){var s;return s=new i(this,t,e,r,n,o),this.children.push(s),this},r.prototype.entity=function(t,e){var r;return r=new o(this,!1,t,e),this.children.push(r),this},r.prototype.pEntity=function(t,e){var r;return r=new o(this,!0,t,e),this.children.push(r),this},r.prototype.notation=function(t,e){var r;return r=new s(this,t,e),this.children.push(r),this},r.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},r.prototype.ele=function(t,e){return this.element(t,e)},r.prototype.att=function(t,e,r,i,n){return this.attList(t,e,r,i,n)},r.prototype.ent=function(t,e){return this.entity(t,e)},r.prototype.pent=function(t,e){return this.pEntity(t,e)},r.prototype.not=function(t,e){return this.notation(t,e)},r.prototype.up=function(){return this.root()||this.documentObject},r.prototype.isEqualNode=function(t){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&(t.name===this.name&&(t.publicId===this.publicId&&t.systemId===this.systemId))},r}(u)}).call(this)},1933:function(t,e,r){(function(){var e,i,n,o,s,a,u,c={}.hasOwnProperty;u=r(9241).isPlainObject,n=r(7260),i=r(3074),o=r(468),e=r(1737),a=r(3976),s=r(382),t.exports=function(t){function r(t){r.__super__.constructor.call(this,null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new i,t||(t={}),t.writer||(t.writer=new s),this.options=t,this.stringify=new a(t)}return function(t,e){for(var r in e)c.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"implementation",{value:new n}),Object.defineProperty(r.prototype,"doctype",{get:function(){var t,r,i,n;for(r=0,i=(n=this.children).length;r<i;r++)if((t=n[r]).type===e.DocType)return t;return null}}),Object.defineProperty(r.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(r.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(r.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(r.prototype,"origin",{get:function(){return null}}),Object.defineProperty(r.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(r.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(r.prototype,"contentType",{get:function(){return null}}),r.prototype.end=function(t){var e;return e={},t?u(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},r.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},r.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.renameNode=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createNodeIterator=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTreeWalker=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(o)}).call(this)},400:function(t,e,r){(function(){var e,i,n,o,s,a,u,c,p,l,h,d,m,f,y,g,v,b,S,T,w,C,O,D={}.hasOwnProperty;O=r(9241),w=O.isObject,T=O.isFunction,C=O.isPlainObject,S=O.getValue,e=r(1737),d=r(1933),m=r(3906),o=r(2691),s=r(2679),y=r(1268),b=r(2535),f=r(5915),l=r(4130),h=r(6376),a=r(4111),c=r(5529),u=r(7696),p=r(8012),n=r(4238),v=r(3976),g=r(382),i=r(8753),t.exports=function(){function t(t,r,i){var n;this.name="?xml",this.type=e.Document,t||(t={}),n={},t.writer?C(t.writer)&&(n=t.writer,t.writer=new g):t.writer=new g,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(n),this.stringify=new v(t),this.onDataCallback=r||function(){},this.onEndCallback=i||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return t.prototype.createChildNode=function(t){var r,i,n,o,s,a,u,c;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(i in n={},u=t.attribs)D.call(u,i)&&(r=u[i],n[i]=r.value);this.node(t.name,n);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(s=0,a=(c=t.children).length;s<a;s++)o=c[s],this.createChildNode(o),o.type===e.Element&&this.up();return this},t.prototype.dummy=function(){return this},t.prototype.node=function(t,e,r){var i;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=S(t),null==e&&(e={}),e=S(e),w(e)||(r=(i=[e,r])[0],e=i[1]),this.currentNode=new m(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=r&&this.text(r),this},t.prototype.element=function(t,r,i){var n,o,s,a,u,c;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(t)||w(t)||T(t))for(a=this.options.noValidation,this.options.noValidation=!0,(c=new d(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=a,o=0,s=(u=c.children).length;o<s;o++)n=u[o],this.createChildNode(n),n.type===e.Element&&this.up();else this.node(t,r,i);return this},t.prototype.attribute=function(t,e){var r,i;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=S(t)),w(t))for(r in t)D.call(t,r)&&(i=t[r],this.attribute(r,i));else T(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new n(this,t,""):null!=e&&(this.currentNode.attribs[t]=new n(this,t,e));return this},t.prototype.text=function(t){var e;return this.openCurrent(),e=new b(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.cdata=function(t){var e;return this.openCurrent(),e=new o(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.comment=function(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.raw=function(t){var e;return this.openCurrent(),e=new y(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.instruction=function(t,e){var r,i,n,o,s;if(this.openCurrent(),null!=t&&(t=S(t)),null!=e&&(e=S(e)),Array.isArray(t))for(r=0,o=t.length;r<o;r++)i=t[r],this.instruction(i);else if(w(t))for(i in t)D.call(t,i)&&(n=t[i],this.instruction(i,n));else T(e)&&(e=e.apply()),s=new f(this,t,e),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},t.prototype.declaration=function(t,e,r){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new l(this,t,e,r),this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.doctype=function(t,e,r){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new h(this,e,r),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},t.prototype.dtdElement=function(t,e){var r;return this.openCurrent(),r=new u(this,t,e),this.onData(this.writer.dtdElement(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.attList=function(t,e,r,i,n){var o;return this.openCurrent(),o=new a(this,t,e,r,i,n),this.onData(this.writer.dtdAttList(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.entity=function(t,e){var r;return this.openCurrent(),r=new c(this,!1,t,e),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.pEntity=function(t,e){var r;return this.openCurrent(),r=new c(this,!0,t,e),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.notation=function(t,e){var r;return this.openCurrent(),r=new p(this,t,e),this.onData(this.writer.dtdNotation(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},t.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},t.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},t.prototype.openNode=function(t){var r,n,o,s;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),n="",t.type===e.Element){for(o in this.writerOptions.state=i.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,s=t.attribs)D.call(s,o)&&(r=s[o],n+=this.writer.attribute(r,this.writerOptions,this.currentLevel));n+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=i.InsideTag}else this.writerOptions.state=i.OpenTag,n=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.children?(n+=" [",this.writerOptions.state=i.InsideTag):(this.writerOptions.state=i.CloseTag,n+=">"),n+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(n,this.currentLevel),t.isOpen=!0}},t.prototype.closeNode=function(t){var r;if(!t.isClosed)return r="",this.writerOptions.state=i.CloseTag,r=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=i.None,this.onData(r,this.currentLevel),t.isClosed=!0},t.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},t.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},t.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},t.prototype.ele=function(){return this.element.apply(this,arguments)},t.prototype.nod=function(t,e,r){return this.node(t,e,r)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.dec=function(t,e,r){return this.declaration(t,e,r)},t.prototype.dtd=function(t,e,r){return this.doctype(t,e,r)},t.prototype.e=function(t,e,r){return this.element(t,e,r)},t.prototype.n=function(t,e,r){return this.node(t,e,r)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.att=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.a=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.ent=function(t,e){return this.entity(t,e)},t.prototype.pent=function(t,e){return this.pEntity(t,e)},t.prototype.not=function(t,e){return this.notation(t,e)},t}()}).call(this)},1218:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;i=r(468),e=r(1737),t.exports=function(t){function r(t){r.__super__.constructor.call(this,t),this.type=e.Dummy}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return""},r}(i)}).call(this)},3906:function(t,e,r){(function(){var e,i,n,o,s,a,u,c,p={}.hasOwnProperty;c=r(9241),u=c.isObject,a=c.isFunction,s=c.getValue,o=r(468),e=r(1737),i=r(4238),n=r(4797),t.exports=function(t){function r(t,i,n){var o,s,a,u;if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(i),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=n&&this.attribute(n),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,a=(u=t.children).length;s<a;s++)if((o=u[s]).type===e.DocType){o.name=this.name;break}}return function(t,e){for(var r in e)p.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(r.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(r.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new n(this.attribs)),this.attributeMap}}),r.prototype.clone=function(){var t,e,r,i;for(e in(r=Object.create(this)).isRoot&&(r.documentObject=null),r.attribs={},i=this.attribs)p.call(i,e)&&(t=i[e],r.attribs[e]=t.clone());return r.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=r,r.children.push(e)})),r},r.prototype.attribute=function(t,e){var r,n;if(null!=t&&(t=s(t)),u(t))for(r in t)p.call(t,r)&&(n=t[r],this.attribute(r,n));else a(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new i(this,t,""):null!=e&&(this.attribs[t]=new i(this,t,e));return this},r.prototype.removeAttribute=function(t){var e,r,i;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=s(t),Array.isArray(t))for(r=0,i=t.length;r<i;r++)e=t[r],delete this.attribs[e];else delete this.attribs[t];return this},r.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},r.prototype.att=function(t,e){return this.attribute(t,e)},r.prototype.a=function(t,e){return this.attribute(t,e)},r.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},r.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},r.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNS=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},r.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},r.prototype.setIdAttributeNS=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.isEqualNode=function(t){var e,i,n;if(!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=i=0,n=this.attribs.length-1;0<=n?i<=n:i>=n;e=0<=n?++i:--i)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},r}(o)}).call(this)},4797:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},468:function(t,e,r){(function(){var e,i,n,o,s,a,u,c,p,l,h,d,m,f,y,g,v,b={}.hasOwnProperty;v=r(9241),g=v.isObject,y=v.isFunction,f=v.isEmpty,m=v.getValue,c=null,n=null,o=null,s=null,a=null,h=null,d=null,l=null,u=null,i=null,p=null,e=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,c||(c=r(3906),n=r(2691),o=r(2679),s=r(4130),a=r(6376),h=r(1268),d=r(2535),l=r(5915),u=r(1218),i=r(1737),p=r(6684),r(4797),e=r(4923))}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new p(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,r,n,o;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){for(o="",e=0,r=(n=this.children).length;e<r;e++)(t=n[e]).textContent&&(o+=t.textContent);return o}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t.prototype.setParent=function(t){var e,r,i,n,o;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),o=[],r=0,i=(n=this.children).length;r<i;r++)e=n[r],o.push(e.setParent(this));return o},t.prototype.element=function(t,e,r){var i,n,o,s,a,u,c,p,l,h,d;if(u=null,null===e&&null==r&&(e=(l=[{},null])[0],r=l[1]),null==e&&(e={}),e=m(e),g(e)||(r=(h=[e,r])[0],e=h[1]),null!=t&&(t=m(t)),Array.isArray(t))for(o=0,c=t.length;o<c;o++)n=t[o],u=this.element(n);else if(y(t))u=this.element(t.apply());else if(g(t)){for(a in t)if(b.call(t,a))if(d=t[a],y(d)&&(d=d.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))u=this.attribute(a.substr(this.stringify.convertAttKey.length),d);else if(!this.options.separateArrayItems&&Array.isArray(d)&&f(d))u=this.dummy();else if(g(d)&&f(d))u=this.element(a);else if(this.options.keepNullNodes||null!=d)if(!this.options.separateArrayItems&&Array.isArray(d))for(s=0,p=d.length;s<p;s++)n=d[s],(i={})[a]=n,u=this.element(i);else g(d)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?u=this.element(d):(u=this.element(a)).element(d):u=this.element(a,d);else u=this.dummy()}else u=this.options.keepNullNodes||null!==r?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(r):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(r):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(r):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(r):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),r):this.node(t,e,r):this.dummy();if(null==u)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return u},t.prototype.insertBefore=function(t,e,r){var i,n,o,s,a;if(null!=t?t.type:void 0)return s=e,(o=t).setParent(this),s?(n=children.indexOf(s),a=children.splice(n),children.push(o),Array.prototype.push.apply(children,a)):children.push(o),o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),a=this.parent.children.splice(n),i=this.parent.element(t,e,r),Array.prototype.push.apply(this.parent.children,a),i},t.prototype.insertAfter=function(t,e,r){var i,n,o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return n=this.parent.children.indexOf(this),o=this.parent.children.splice(n+1),i=this.parent.element(t,e,r),Array.prototype.push.apply(this.parent.children,o),i},t.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},t.prototype.node=function(t,e,r){var i,n;return null!=t&&(t=m(t)),e||(e={}),e=m(e),g(e)||(r=(n=[e,r])[0],e=n[1]),i=new c(this,t,e),null!=r&&i.text(r),this.children.push(i),i},t.prototype.text=function(t){var e;return g(t)&&this.element(t),e=new d(this,t),this.children.push(e),this},t.prototype.cdata=function(t){var e;return e=new n(this,t),this.children.push(e),this},t.prototype.comment=function(t){var e;return e=new o(this,t),this.children.push(e),this},t.prototype.commentBefore=function(t){var e,r;return e=this.parent.children.indexOf(this),r=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.commentAfter=function(t){var e,r;return e=this.parent.children.indexOf(this),r=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,r),this},t.prototype.raw=function(t){var e;return e=new h(this,t),this.children.push(e),this},t.prototype.dummy=function(){return new u(this)},t.prototype.instruction=function(t,e){var r,i,n,o,s;if(null!=t&&(t=m(t)),null!=e&&(e=m(e)),Array.isArray(t))for(o=0,s=t.length;o<s;o++)r=t[o],this.instruction(r);else if(g(t))for(r in t)b.call(t,r)&&(i=t[r],this.instruction(r,i));else y(e)&&(e=e.apply()),n=new l(this,t,e),this.children.push(n);return this},t.prototype.instructionBefore=function(t,e){var r,i;return r=this.parent.children.indexOf(this),i=this.parent.children.splice(r),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.instructionAfter=function(t,e){var r,i;return r=this.parent.children.indexOf(this),i=this.parent.children.splice(r+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.declaration=function(t,e,r){var n,o;return n=this.document(),o=new s(n,t,e,r),0===n.children.length?n.children.unshift(o):n.children[0].type===i.Declaration?n.children[0]=o:n.children.unshift(o),n.root()||n},t.prototype.dtd=function(t,e){var r,n,o,s,u,c,p,l,h;for(r=this.document(),n=new a(r,t,e),o=s=0,c=(l=r.children).length;s<c;o=++s)if(l[o].type===i.DocType)return r.children[o]=n,n;for(o=u=0,p=(h=r.children).length;u<p;o=++u)if(h[o].isRoot)return r.children.splice(o,0,n),n;return r.children.push(n),n},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var t;for(t=this;t;){if(t.type===i.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},t.prototype.document=function(){var t;for(t=this;t;){if(t.type===i.Document)return t;t=t.parent}},t.prototype.end=function(t){return this.document().end(t)},t.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},t.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},t.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},t.prototype.debugInfo=function(t){var e,r;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(r=this.parent)?r.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},t.prototype.ele=function(t,e,r){return this.element(t,e,r)},t.prototype.nod=function(t,e,r){return this.node(t,e,r)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(t,e,r){return this.declaration(t,e,r)},t.prototype.e=function(t,e,r){return this.element(t,e,r)},t.prototype.n=function(t,e,r){return this.node(t,e,r)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(t){return this.importDocument(t)},t.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.hasChildNodes=function(){return 0!==this.children.length},t.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isSupported=function(t,e){return!0},t.prototype.hasAttributes=function(){return 0!==this.attribs.length},t.prototype.compareDocumentPosition=function(t){var r,i;return(r=this)===t?0:this.document()!==t.document()?(i=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?i|=e.Preceding:i|=e.Following,i):r.isAncestor(t)?e.Contains|e.Preceding:r.isDescendant(t)?e.Contains|e.Following:r.isPreceding(t)?e.Preceding:e.Following},t.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(t){var e,r,i;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=r=0,i=this.children.length-1;0<=i?r<=i:r>=i;e=0<=i?++r:--r)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.setUserData=function(t,e,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},t.prototype.isDescendant=function(t){var e,r,i,n;for(r=0,i=(n=this.children).length;r<i;r++){if(t===(e=n[r]))return!0;if(e.isDescendant(t))return!0}return!1},t.prototype.isAncestor=function(t){return t.isDescendant(this)},t.prototype.isPreceding=function(t){var e,r;return e=this.treePosition(t),r=this.treePosition(this),-1!==e&&-1!==r&&e<r},t.prototype.isFollowing=function(t){var e,r;return e=this.treePosition(t),r=this.treePosition(this),-1!==e&&-1!==r&&e>r},t.prototype.treePosition=function(t){var e,r;return r=0,e=!1,this.foreachTreeNode(this.document(),(function(i){if(r++,!e&&i===t)return e=!0})),e?r:-1},t.prototype.foreachTreeNode=function(t,e){var r,i,n,o,s;for(t||(t=this.document()),i=0,n=(o=t.children).length;i<n;i++){if(s=e(r=o[i]))return s;if(s=this.foreachTreeNode(r,e))return s}},t}()}).call(this)},6684:function(t){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}).call(this)},5915:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;e=r(1737),i=r(7457),t.exports=function(t){function r(t,i,n){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(i),this.name=this.target,n&&(this.value=this.stringify.insValue(n))}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},r.prototype.isEqualNode=function(t){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},r}(i)}).call(this)},1268:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;e=r(1737),i=r(468),t.exports=function(t){function r(t,i){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(i)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},r}(i)}).call(this)},6775:function(t,e,r){(function(){var e,i,n,o={}.hasOwnProperty;e=r(1737),n=r(6286),i=r(8753),t.exports=function(t){function r(t,e){this.stream=t,r.__super__.constructor.call(this,e)}return function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),r.prototype.endline=function(t,e,n){return t.isLastRootNode&&e.state===i.CloseTag?"":r.__super__.endline.call(this,t,e,n)},r.prototype.document=function(t,e){var r,i,n,o,s,a,u,c,p;for(i=n=0,s=(u=t.children).length;n<s;i=++n)(r=u[i]).isLastRootNode=i===t.children.length-1;for(e=this.filterOptions(e),p=[],o=0,a=(c=t.children).length;o<a;o++)r=c[o],p.push(this.writeChildNode(r,e,0));return p},r.prototype.attribute=function(t,e,i){return this.stream.write(r.__super__.attribute.call(this,t,e,i))},r.prototype.cdata=function(t,e,i){return this.stream.write(r.__super__.cdata.call(this,t,e,i))},r.prototype.comment=function(t,e,i){return this.stream.write(r.__super__.comment.call(this,t,e,i))},r.prototype.declaration=function(t,e,i){return this.stream.write(r.__super__.declaration.call(this,t,e,i))},r.prototype.docType=function(t,e,r){var n,o,s,a;if(r||(r=0),this.openNode(t,e,r),e.state=i.OpenTag,this.stream.write(this.indent(t,e,r)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,r)),e.state=i.InsideTag,o=0,s=(a=t.children).length;o<s;o++)n=a[o],this.writeChildNode(n,e,r+1);e.state=i.CloseTag,this.stream.write("]")}return e.state=i.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,r)),e.state=i.None,this.closeNode(t,e,r)},r.prototype.element=function(t,r,n){var s,a,u,c,p,l,h,d,m;for(h in n||(n=0),this.openNode(t,r,n),r.state=i.OpenTag,this.stream.write(this.indent(t,r,n)+"<"+t.name),d=t.attribs)o.call(d,h)&&(s=d[h],this.attribute(s,r,n));if(c=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))r.allowEmpty?(this.stream.write(">"),r.state=i.CloseTag,this.stream.write("</"+t.name+">")):(r.state=i.CloseTag,this.stream.write(r.spaceBeforeSlash+"/>"));else if(!r.pretty||1!==u||c.type!==e.Text&&c.type!==e.Raw||null==c.value){for(this.stream.write(">"+this.endline(t,r,n)),r.state=i.InsideTag,p=0,l=(m=t.children).length;p<l;p++)a=m[p],this.writeChildNode(a,r,n+1);r.state=i.CloseTag,this.stream.write(this.indent(t,r,n)+"</"+t.name+">")}else this.stream.write(">"),r.state=i.InsideTag,r.suppressPrettyCount++,this.writeChildNode(c,r,n+1),r.suppressPrettyCount--,r.state=i.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,r,n)),r.state=i.None,this.closeNode(t,r,n)},r.prototype.processingInstruction=function(t,e,i){return this.stream.write(r.__super__.processingInstruction.call(this,t,e,i))},r.prototype.raw=function(t,e,i){return this.stream.write(r.__super__.raw.call(this,t,e,i))},r.prototype.text=function(t,e,i){return this.stream.write(r.__super__.text.call(this,t,e,i))},r.prototype.dtdAttList=function(t,e,i){return this.stream.write(r.__super__.dtdAttList.call(this,t,e,i))},r.prototype.dtdElement=function(t,e,i){return this.stream.write(r.__super__.dtdElement.call(this,t,e,i))},r.prototype.dtdEntity=function(t,e,i){return this.stream.write(r.__super__.dtdEntity.call(this,t,e,i))},r.prototype.dtdNotation=function(t,e,i){return this.stream.write(r.__super__.dtdNotation.call(this,t,e,i))},r}(n)}).call(this)},382:function(t,e,r){(function(){var e,i={}.hasOwnProperty;e=r(6286),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t)}return function(t,e){for(var r in e)i.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e.prototype.document=function(t,e){var r,i,n,o,s;for(e=this.filterOptions(e),o="",i=0,n=(s=t.children).length;i<n;i++)r=s[i],o+=this.writeChildNode(r,e,0);return e.pretty&&o.slice(-e.newline.length)===e.newline&&(o=o.slice(0,-e.newline.length)),o},e}(e)}).call(this)},3976:function(t){(function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},r={}.hasOwnProperty;t.exports=function(){function t(t){var i,n,o;for(i in this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),n=t.stringify||{})r.call(n,i)&&(o=n[i],this[i]=o)}return t.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},t.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},t.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},t.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},t.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},t.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},t.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},t.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},t.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e,r;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+r.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+r.index);return t},t.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},t.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},t.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},t}()}).call(this)},2535:function(t,e,r){(function(){var e,i,n={}.hasOwnProperty;e=r(1737),i=r(7457),t.exports=function(t){function r(t,i){if(r.__super__.constructor.call(this,t),null==i)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(i)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,t),Object.defineProperty(r.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"wholeText",{get:function(){var t,e,r;for(r="",e=this.previousSibling;e;)r=e.data+r,e=e.previousSibling;for(r+=this.data,t=this.nextSibling;t;)r+=t.data,t=t.nextSibling;return r}}),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},r.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(i)}).call(this)},6286:function(t,e,r){(function(){var e,i,n,o={}.hasOwnProperty;n=r(9241).assign,e=r(1737),r(4130),r(6376),r(2691),r(2679),r(3906),r(1268),r(2535),r(5915),r(1218),r(4111),r(7696),r(5529),r(8012),i=r(8753),t.exports=function(){function t(t){var e,r,i;for(e in t||(t={}),this.options=t,r=t.writer||{})o.call(r,e)&&(i=r[e],this["_"+e]=this[e],this[e]=i)}return t.prototype.filterOptions=function(t){var e,r,o,s,a,u,c,p;return t||(t={}),t=n({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(r=t.indent)?r:"  ",e.newline=null!=(o=t.newline)?o:"\n",e.offset=null!=(s=t.offset)?s:0,e.dontPrettyTextNodes=null!=(a=null!=(u=t.dontPrettyTextNodes)?u:t.dontprettytextnodes)?a:0,e.spaceBeforeSlash=null!=(c=null!=(p=t.spaceBeforeSlash)?p:t.spacebeforeslash)?c:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=i.None,e},t.prototype.indent=function(t,e,r){var i;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(i=(r||0)+e.offset+1)>0?new Array(i).join(e.indent):""},t.prototype.endline=function(t,e,r){return!e.pretty||e.suppressPrettyCount?"":e.newline},t.prototype.attribute=function(t,e,r){var i;return this.openAttribute(t,e,r),i=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,r),i},t.prototype.cdata=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"<![CDATA[",e.state=i.InsideTag,n+=t.value,e.state=i.CloseTag,n+="]]>"+this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.comment=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"\x3c!-- ",e.state=i.InsideTag,n+=t.value,e.state=i.CloseTag,n+=" --\x3e"+this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.declaration=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"<?xml",e.state=i.InsideTag,n+=' version="'+t.version+'"',null!=t.encoding&&(n+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(n+=' standalone="'+t.standalone+'"'),e.state=i.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.docType=function(t,e,r){var n,o,s,a,u;if(r||(r=0),this.openNode(t,e,r),e.state=i.OpenTag,a=this.indent(t,e,r),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,e,r),e.state=i.InsideTag,o=0,s=(u=t.children).length;o<s;o++)n=u[o],a+=this.writeChildNode(n,e,r+1);e.state=i.CloseTag,a+="]"}return e.state=i.CloseTag,a+=e.spaceBeforeSlash+">",a+=this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),a},t.prototype.element=function(t,r,n){var s,a,u,c,p,l,h,d,m,f,y,g,v,b;for(m in n||(n=0),f=!1,y="",this.openNode(t,r,n),r.state=i.OpenTag,y+=this.indent(t,r,n)+"<"+t.name,g=t.attribs)o.call(g,m)&&(s=g[m],y+=this.attribute(s,r,n));if(c=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))r.allowEmpty?(y+=">",r.state=i.CloseTag,y+="</"+t.name+">"+this.endline(t,r,n)):(r.state=i.CloseTag,y+=r.spaceBeforeSlash+"/>"+this.endline(t,r,n));else if(!r.pretty||1!==u||c.type!==e.Text&&c.type!==e.Raw||null==c.value){if(r.dontPrettyTextNodes)for(p=0,h=(v=t.children).length;p<h;p++)if(((a=v[p]).type===e.Text||a.type===e.Raw)&&null!=a.value){r.suppressPrettyCount++,f=!0;break}for(y+=">"+this.endline(t,r,n),r.state=i.InsideTag,l=0,d=(b=t.children).length;l<d;l++)a=b[l],y+=this.writeChildNode(a,r,n+1);r.state=i.CloseTag,y+=this.indent(t,r,n)+"</"+t.name+">",f&&r.suppressPrettyCount--,y+=this.endline(t,r,n),r.state=i.None}else y+=">",r.state=i.InsideTag,r.suppressPrettyCount++,f=!0,y+=this.writeChildNode(c,r,n+1),r.suppressPrettyCount--,f=!1,r.state=i.CloseTag,y+="</"+t.name+">"+this.endline(t,r,n);return this.closeNode(t,r,n),y},t.prototype.writeChildNode=function(t,r,i){switch(t.type){case e.CData:return this.cdata(t,r,i);case e.Comment:return this.comment(t,r,i);case e.Element:return this.element(t,r,i);case e.Raw:return this.raw(t,r,i);case e.Text:return this.text(t,r,i);case e.ProcessingInstruction:return this.processingInstruction(t,r,i);case e.Dummy:return"";case e.Declaration:return this.declaration(t,r,i);case e.DocType:return this.docType(t,r,i);case e.AttributeDeclaration:return this.dtdAttList(t,r,i);case e.ElementDeclaration:return this.dtdElement(t,r,i);case e.EntityDeclaration:return this.dtdEntity(t,r,i);case e.NotationDeclaration:return this.dtdNotation(t,r,i);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},t.prototype.processingInstruction=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"<?",e.state=i.InsideTag,n+=t.target,t.value&&(n+=" "+t.value),e.state=i.CloseTag,n+=e.spaceBeforeSlash+"?>",n+=this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.raw=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r),e.state=i.InsideTag,n+=t.value,e.state=i.CloseTag,n+=this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.text=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r),e.state=i.InsideTag,n+=t.value,e.state=i.CloseTag,n+=this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.dtdAttList=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"<!ATTLIST",e.state=i.InsideTag,n+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(n+=" "+t.defaultValueType),t.defaultValue&&(n+=' "'+t.defaultValue+'"'),e.state=i.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.dtdElement=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"<!ELEMENT",e.state=i.InsideTag,n+=" "+t.name+" "+t.value,e.state=i.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.dtdEntity=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"<!ENTITY",e.state=i.InsideTag,t.pe&&(n+=" %"),n+=" "+t.name,t.value?n+=' "'+t.value+'"':(t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),t.nData&&(n+=" NDATA "+t.nData)),e.state=i.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.dtdNotation=function(t,e,r){var n;return this.openNode(t,e,r),e.state=i.OpenTag,n=this.indent(t,e,r)+"<!NOTATION",e.state=i.InsideTag,n+=" "+t.name,t.pubID&&t.sysID?n+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?n+=' PUBLIC "'+t.pubID+'"':t.sysID&&(n+=' SYSTEM "'+t.sysID+'"'),e.state=i.CloseTag,n+=e.spaceBeforeSlash+">"+this.endline(t,e,r),e.state=i.None,this.closeNode(t,e,r),n},t.prototype.openNode=function(t,e,r){},t.prototype.closeNode=function(t,e,r){},t.prototype.openAttribute=function(t,e,r){},t.prototype.closeAttribute=function(t,e,r){},t}()}).call(this)},9665:function(t,e,r){(function(){var e,i,n,o,s,a,u,c,p,l;l=r(9241),c=l.assign,p=l.isFunction,n=r(7260),o=r(1933),s=r(400),u=r(382),a=r(6775),e=r(1737),i=r(8753),t.exports.create=function(t,e,r,i){var n,s;if(null==t)throw new Error("Root element needs a name.");return i=c({},e,r,i),s=(n=new o(i)).element(t),i.headless||(n.declaration(i),null==i.pubID&&null==i.sysID||n.dtd(i)),s},t.exports.begin=function(t,e,r){var i;return p(t)&&(e=(i=[t,e])[0],r=i[1],t={}),e?new s(t,e,r):new o(t)},t.exports.stringWriter=function(t){return new u(t)},t.exports.streamWriter=function(t,e){return new a(t,e)},t.exports.implementation=new n,t.exports.nodeType=e,t.exports.writerState=i}).call(this)},5336:(t,e,r)=>{e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;e.splice(1,0,r,"color: inherit");let i=0,n=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(i++,"%c"===t&&(n=i))})),e.splice(n,0,r)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=r(5175)(e);const{formatters:i}=t.exports;i.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},5175:(t,e,r)=>{t.exports=function(t){function e(t){let r,n,o,s=null;function a(...t){if(!a.enabled)return;const i=a,n=Number(new Date),o=n-(r||n);i.diff=o,i.prev=r,i.curr=n,r=n,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((r,n)=>{if("%%"===r)return"%";s++;const o=e.formatters[n];if("function"==typeof o){const e=t[s];r=o.call(i,e),t.splice(s,1),s--}return r})),e.formatArgs.call(i,t);(i.log||e.log).apply(i,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=i,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(n!==e.namespaces&&(n=e.namespaces,o=e.enabled(t)),o),set:t=>{s=t}}),"function"==typeof e.init&&e.init(a),a}function i(t,r){const i=e(this.namespace+("undefined"==typeof r?":":r)+t);return i.log=this.log,i}function n(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},e.disable=function(){const t=[...e.names.map(n),...e.skips.map(n).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let r;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const i=("string"==typeof t?t:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(t=i[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let r,i;for(r=0,i=e.skips.length;r<i;r++)if(e.skips[r].test(t))return!1;for(r=0,i=e.names.length;r<i;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=r(2726),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((r=>{e[r]=t[r]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let r=0;for(let e=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;return e.colors[Math.abs(r)%e.colors.length]},e.enable(e.load()),e}},6556:(t,e,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?t.exports=r(5336):t.exports=r(3482)},3482:(t,e,r)=>{const i=r(2018),n=r(9023);e.init=function(t){t.inspectOpts={};const r=Object.keys(e.inspectOpts);for(let i=0;i<r.length;i++)t.inspectOpts[r[i]]=e.inspectOpts[r[i]]},e.log=function(...t){return process.stderr.write(n.format(...t)+"\n")},e.formatArgs=function(r){const{namespace:i,useColors:n}=this;if(n){const e=this.color,n="[3"+(e<8?e:"8;5;"+e),o=`  ${n};1m${i} [0m`;r[0]=o+r[0].split("\n").join("\n"+o),r.push(n+"m+"+t.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(e.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+i+" "+r[0]},e.save=function(t){t?process.env.DEBUG=t:delete process.env.DEBUG},e.load=function(){return process.env.DEBUG},e.useColors=function(){return"colors"in e.inspectOpts?Boolean(e.inspectOpts.colors):i.isatty(process.stderr.fd)},e.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),e.colors=[6,2,3,4,5,1];try{const t=r(Object(function(){var t=new Error("Cannot find module 'supports-color'");throw t.code="MODULE_NOT_FOUND",t}()));t&&(t.stderr||t).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(t){}e.inspectOpts=Object.keys(process.env).filter((t=>/^debug_/i.test(t))).reduce(((t,e)=>{const r=e.substring(6).toLowerCase().replace(/_([a-z])/g,((t,e)=>e.toUpperCase()));let i=process.env[e];return i=!!/^(yes|on|true|enabled)$/i.test(i)||!/^(no|off|false|disabled)$/i.test(i)&&("null"===i?null:Number(i)),t[r]=i,t}),{}),t.exports=r(5175)(e);const{formatters:o}=t.exports;o.o=function(t){return this.inspectOpts.colors=this.useColors,n.inspect(t,this.inspectOpts).split("\n").map((t=>t.trim())).join(" ")},o.O=function(t){return this.inspectOpts.colors=this.useColors,n.inspect(t,this.inspectOpts)}},4376:(t,e,r)=>{var i;t.exports=function(){if(!i){try{i=r(6556)("follow-redirects")}catch(t){}"function"!=typeof i&&(i=function(){})}i.apply(null,arguments)}},1783:(t,e,r)=>{var i,n,o,s=r(7016),a=s.URL,u=r(8611),c=r(5692),p=r(2203).Writable,l=r(2613),h=r(4376);i="undefined"!=typeof process,n="undefined"!=typeof window&&"undefined"!=typeof document,o=M(Error.captureStackTrace),i||!n&&o||console.warn("The follow-redirects package should be excluded from browser builds.");var d=!1;try{l(new a(""))}catch(t){d="ERR_INVALID_URL"===t.code}var m=["auth","host","hostname","href","path","pathname","port","protocol","query","search","hash"],f=["abort","aborted","connect","error","socket","timeout"],y=Object.create(null);f.forEach((function(t){y[t]=function(e,r,i){this._redirectable.emit(t,e,r,i)}}));var g=I("ERR_INVALID_URL","Invalid URL",TypeError),v=I("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),b=I("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded",v),S=I("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),T=I("ERR_STREAM_WRITE_AFTER_END","write after end"),w=p.prototype.destroy||D;function C(t,e){p.call(this),this._sanitizeOptions(t),this._options=t,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],e&&this.on("response",e);var r=this;this._onNativeResponse=function(t){try{r._processResponse(t)}catch(t){r.emit("error",t instanceof v?t:new v({cause:t}))}},this._performRequest()}function O(t){var e={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(t).forEach((function(i){var n=i+":",o=r[n]=t[i],s=e[i]=Object.create(o);Object.defineProperties(s,{request:{value:function(t,i,o){var s;return s=t,a&&s instanceof a?t=P(t):A(t)?t=P(x(t)):(o=i,i=_(t),t={protocol:n}),M(i)&&(o=i,i=null),(i=Object.assign({maxRedirects:e.maxRedirects,maxBodyLength:e.maxBodyLength},t,i)).nativeProtocols=r,A(i.host)||A(i.hostname)||(i.hostname="::1"),l.equal(i.protocol,n,"protocol mismatch"),h("options",i),new C(i,o)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(t,e,r){var i=s.request(t,e,r);return i.end(),i},configurable:!0,enumerable:!0,writable:!0}})})),e}function D(){}function x(t){var e;if(d)e=new a(t);else if(!A((e=_(s.parse(t))).protocol))throw new g({input:t});return e}function _(t){if(/^\[/.test(t.hostname)&&!/^\[[:0-9a-f]+\]$/i.test(t.hostname))throw new g({input:t.href||t});if(/^\[/.test(t.host)&&!/^\[[:0-9a-f]+\](:\d+)?$/i.test(t.host))throw new g({input:t.href||t});return t}function P(t,e){var r=e||{};for(var i of m)r[i]=t[i];return r.hostname.startsWith("[")&&(r.hostname=r.hostname.slice(1,-1)),""!==r.port&&(r.port=Number(r.port)),r.path=r.search?r.pathname+r.search:r.pathname,r}function E(t,e){var r;for(var i in e)t.test(i)&&(r=e[i],delete e[i]);return null===r||"undefined"==typeof r?void 0:String(r).trim()}function I(t,e,r){function i(r){M(Error.captureStackTrace)&&Error.captureStackTrace(this,this.constructor),Object.assign(this,r||{}),this.code=t,this.message=this.cause?e+": "+this.cause.message:e}return i.prototype=new(r||Error),Object.defineProperties(i.prototype,{constructor:{value:i,enumerable:!1},name:{value:"Error ["+t+"]",enumerable:!1}}),i}function N(t,e){for(var r of f)t.removeListener(r,y[r]);t.on("error",D),t.destroy(e)}function A(t){return"string"==typeof t||t instanceof String}function M(t){return"function"==typeof t}C.prototype=Object.create(p.prototype),C.prototype.abort=function(){N(this._currentRequest),this._currentRequest.abort(),this.emit("abort")},C.prototype.destroy=function(t){return N(this._currentRequest,t),w.call(this,t),this},C.prototype.write=function(t,e,r){if(this._ending)throw new T;if(!A(t)&&("object"!=typeof(i=t)||!("length"in i)))throw new TypeError("data should be a string, Buffer or Uint8Array");var i;M(e)&&(r=e,e=null),0!==t.length?this._requestBodyLength+t.length<=this._options.maxBodyLength?(this._requestBodyLength+=t.length,this._requestBodyBuffers.push({data:t,encoding:e}),this._currentRequest.write(t,e,r)):(this.emit("error",new S),this.abort()):r&&r()},C.prototype.end=function(t,e,r){if(M(t)?(r=t,t=e=null):M(e)&&(r=e,e=null),t){var i=this,n=this._currentRequest;this.write(t,e,(function(){i._ended=!0,n.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},C.prototype.setHeader=function(t,e){this._options.headers[t]=e,this._currentRequest.setHeader(t,e)},C.prototype.removeHeader=function(t){delete this._options.headers[t],this._currentRequest.removeHeader(t)},C.prototype.setTimeout=function(t,e){var r=this;function i(e){e.setTimeout(t),e.removeListener("timeout",e.destroy),e.addListener("timeout",e.destroy)}function n(e){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout((function(){r.emit("timeout"),o()}),t),i(e)}function o(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",o),r.removeListener("error",o),r.removeListener("response",o),r.removeListener("close",o),e&&r.removeListener("timeout",e),r.socket||r._currentRequest.removeListener("socket",n)}return e&&this.on("timeout",e),this.socket?n(this.socket):this._currentRequest.once("socket",n),this.on("socket",i),this.on("abort",o),this.on("error",o),this.on("response",o),this.on("close",o),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(t){C.prototype[t]=function(e,r){return this._currentRequest[t](e,r)}})),["aborted","connection","socket"].forEach((function(t){Object.defineProperty(C.prototype,t,{get:function(){return this._currentRequest[t]}})})),C.prototype._sanitizeOptions=function(t){if(t.headers||(t.headers={}),t.host&&(t.hostname||(t.hostname=t.host),delete t.host),!t.pathname&&t.path){var e=t.path.indexOf("?");e<0?t.pathname=t.path:(t.pathname=t.path.substring(0,e),t.search=t.path.substring(e))}},C.prototype._performRequest=function(){var t=this._options.protocol,e=this._options.nativeProtocols[t];if(!e)throw new TypeError("Unsupported protocol "+t);if(this._options.agents){var r=t.slice(0,-1);this._options.agent=this._options.agents[r]}var i=this._currentRequest=e.request(this._options,this._onNativeResponse);for(var n of(i._redirectable=this,f))i.on(n,y[n]);if(this._currentUrl=/^\//.test(this._options.path)?s.format(this._options):this._options.path,this._isRedirect){var o=0,a=this,u=this._requestBodyBuffers;!function t(e){if(i===a._currentRequest)if(e)a.emit("error",e);else if(o<u.length){var r=u[o++];i.finished||i.write(r.data,r.encoding,t)}else a._ended&&i.end()}()}},C.prototype._processResponse=function(t){var e=t.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:t.headers,statusCode:e});var r,i=t.headers.location;if(!i||!1===this._options.followRedirects||e<300||e>=400)return t.responseUrl=this._currentUrl,t.redirects=this._redirects,this.emit("response",t),void(this._requestBodyBuffers=[]);if(N(this._currentRequest),t.destroy(),++this._redirectCount>this._options.maxRedirects)throw new b;var n=this._options.beforeRedirect;n&&(r=Object.assign({Host:t.req.getHeader("host")},this._options.headers));var o=this._options.method;((301===e||302===e)&&"POST"===this._options.method||303===e&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],E(/^content-/i,this._options.headers));var u,c,p=E(/^host$/i,this._options.headers),m=x(this._currentUrl),f=p||m.host,y=/^\w+:/.test(i)?this._currentUrl:s.format(Object.assign(m,{host:f})),g=(u=i,c=y,d?new a(u,c):x(s.resolve(c,u)));if(h("redirecting to",g.href),this._isRedirect=!0,P(g,this._options),(g.protocol!==m.protocol&&"https:"!==g.protocol||g.host!==f&&!function(t,e){l(A(t)&&A(e));var r=t.length-e.length-1;return r>0&&"."===t[r]&&t.endsWith(e)}(g.host,f))&&E(/^(?:(?:proxy-)?authorization|cookie)$/i,this._options.headers),M(n)){var v={headers:t.headers,statusCode:e},S={url:y,method:o,headers:r};n(this._options,v,S),this._sanitizeOptions(this._options)}this._performRequest()},t.exports=O({http:u,https:c}),t.exports.wrap=O},2726:t=>{var e=1e3,r=60*e,i=60*r,n=24*i,o=7*n,s=365.25*n;function a(t,e,r,i){var n=e>=1.5*r;return Math.round(t/r)+" "+i+(n?"s":"")}t.exports=function(t,u){u=u||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!a)return;var u=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*o;case"days":case"day":case"d":return u*n;case"hours":case"hour":case"hrs":case"hr":case"h":return u*i;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(t);if("number"===c&&isFinite(t))return u.long?function(t){var o=Math.abs(t);if(o>=n)return a(t,o,n,"day");if(o>=i)return a(t,o,i,"hour");if(o>=r)return a(t,o,r,"minute");if(o>=e)return a(t,o,e,"second");return t+" ms"}(t):function(t){var o=Math.abs(t);if(o>=n)return Math.round(t/n)+"d";if(o>=i)return Math.round(t/i)+"h";if(o>=r)return Math.round(t/r)+"m";if(o>=e)return Math.round(t/e)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},2613:t=>{"use strict";t.exports=require("assert")},4434:t=>{"use strict";t.exports=require("events")},8611:t=>{"use strict";t.exports=require("http")},5692:t=>{"use strict";t.exports=require("https")},3339:t=>{"use strict";t.exports=require("module")},2203:t=>{"use strict";t.exports=require("stream")},3193:t=>{"use strict";t.exports=require("string_decoder")},3557:t=>{"use strict";t.exports=require("timers")},2018:t=>{"use strict";t.exports=require("tty")},7016:t=>{"use strict";t.exports=require("url")},9023:t=>{"use strict";t.exports=require("util")},841:(t,e,r)=>{"use strict";r.d(e,{BASIC:()=>m,DIGEST:()=>C,buildAuthorizationHeader:()=>E,parseWWWAuthenticateHeader:()=>P});const i=require("os");class n extends Error{code;params;wrappedErrors;constructor(t,e,...r){t instanceof Array||(r=("undefined"==typeof e?[]:[e]).concat(r),e=t,t=[]),super(e),this.code=e||"E_UNEXPECTED",this.params=r,this.wrappedErrors=t,this.name=this.toString(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}static wrap(t,e,...r){const i=s(t.message),o=("wrappedErrors"in t?t.wrappedErrors:[]).concat(t);return e||(e=i?t.message:"E_UNEXPECTED"),t.message&&!i&&r.push(t.message),new n(o,e,...r)}static cast(t,e,...r){return o(t)?t:n.wrap(t,e,...r)}static bump(t,e,...r){return o(t)?n.wrap(t,t.code,...t.params):n.wrap(t,e,...r)}toString(){return(this.wrappedErrors.length?this.wrappedErrors[this.wrappedErrors.length-1].stack+i.EOL:"")+this.constructor.name+": "+this.code+" ("+this.params.join(", ")+")"}}function o(t){return!!(t instanceof n)||!!(t.constructor&&t.constructor.name&&t.constructor.name.endsWith("Error")&&"code"in t&&"string"==typeof t.code&&s(t.code)&&"params"in t&&t.params&&t.params instanceof Array)}function s(t){return/^([A-Z0-9_]+)$/.test(t)}const a=/\w+=(".*?"|[^",]+)(?=,|$)/g;function u(t,e,r=[],i=[]){const o=t.trim().match(a);if(!o)throw new n("E_MALFORMED_QUOTEDKEYVALUE",t);const s=o.map(((t,e)=>{const[r,...i]=t.split("="),o=i.join("=");if(0===i.length)throw new n("E_MALFORMED_QUOTEDKEYVALUE",e,t);return[r,o]})).reduce((function(t,[r,o],s){const a=r.toLowerCase();if(-1===e.indexOf(a))throw new n("E_UNAUTHORIZED_KEY",s,a);const u=o.replace(/^"(.+(?="$))"$/,"$1");return t[a]=i.includes(a)?u.toLowerCase():u,t}),{});return p(r,s),s}function c(t,e,r=[]){return p(r,t),e.reduce((function(e,r){return t[r]?e+(e?", ":"")+r+'="'+t[r]+'"':e}),"")}function p(t,e){t.forEach((t=>{if("undefined"==typeof e[t])throw new n("E_REQUIRED_KEY",t)}))}const l=["realm"],h=l,d={type:"Basic",parseWWWAuthenticateRest:function(t){return u(t,h,l)},buildWWWAuthenticateRest:function(t){return c(t,h,l)},parseAuthorizationRest:function(t){if(!t)throw new n("E_EMPTY_AUTH");const{username:e,password:r}=d.decodeHash(t);return{hash:t,username:e,password:r}},buildAuthorizationRest:function({hash:t,username:e,password:r}){if(e&&r)return d.computeHash({username:e,password:r});if(!t)throw new n("E_NO_HASH");return t},computeHash:function({username:t,password:e}){return Buffer.from(t+":"+e).toString("base64")},decodeHash:function(t){const[e,...r]=Buffer.from(t,"base64").toString().split(":");return{username:e,password:r.join(":")}}},m=d,f=require("crypto"),y=["realm","nonce"],g=[...y,"domain","opaque","stale","algorithm","qop"],v=["stale"],b=["username","realm","nonce","uri","response"],S=[...b,"algorithm","cnonce","opaque","qop","nc"],T={type:"Digest",parseWWWAuthenticateRest:function(t){return u(t,g,y,v)},buildWWWAuthenticateRest:function(t){return c(t,g,y)},parseAuthorizationRest:function(t){return u(t,S,b)},buildAuthorizationRest:function(t){return c(t,S,b)},computeHash:function(t){const e=t.ha1||w(t.algorithm,[t.username,t.realm,t.password].join(":")),r=w(t.algorithm,[t.method,t.uri].join(":"));return w(t.algorithm,[e,t.nonce,t.nc,t.cnonce,t.qop,r].join(":"))}};function w(t,e){const r=f.createHash(t);return r.update(e),r.digest("hex")}const C=T,O=["invalid_request","invalid_token","insufficient_scope"],D=["realm","scope","error","error_description"],x={type:"Bearer",parseWWWAuthenticateRest:function(t){return u(t,D,[])},buildWWWAuthenticateRest:function(t){if(t.error&&-1===O.indexOf(t.error))throw new n("E_INVALID_ERROR",t.error,O);return c(t,D,[])},parseAuthorizationRest:function(t){if(!t)throw new n("E_EMPTY_AUTH");return{hash:t}},buildAuthorizationRest:function({hash:t}){if(!t)throw new n("E_NO_HASH");return t}},_=[m,T,x];function P(t,e=_,{strict:r=!0}={strict:!0}){let i=null;if(e.some((e=>(0===t.indexOf(e.type+" ")||!r&&0===t.indexOf(e.type.toLowerCase()+" "))&&(i={type:e.type,data:e.parseWWWAuthenticateRest(t.substr(e.type.length+1))},!0))),!i)throw new n("E_UNKNOWN_AUTH_MECHANISM",t);return i}function E(t,e){return`${t.type} ${t.buildAuthorizationRest(e)}`}}},e={};function r(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var i=r(7927),n=exports="undefined"==typeof exports?{}:exports;for(var o in i)n[o]=i[o];i.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();
//# sourceMappingURL=main.nodejs.js.map